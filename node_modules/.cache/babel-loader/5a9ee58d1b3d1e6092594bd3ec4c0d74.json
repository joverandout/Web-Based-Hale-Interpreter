{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { createStyleSheet } from '../../dom.js';\nimport { DomEmitter, stopEvent } from '../../event.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Gesture } from '../../touch.js';\nimport { alert } from '../aria/aria.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { binarySearch, firstOrDefault, range } from '../../../common/arrays.js';\nimport { timeout } from '../../../common/async.js';\nimport { Color } from '../../../common/color.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event, EventBufferer } from '../../../common/event.js';\nimport { matchesPrefix } from '../../../common/filters.js';\nimport { DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { mixin } from '../../../common/objects.js';\nimport * as platform from '../../../common/platform.js';\nimport { isNumber } from '../../../common/types.js';\nimport './list.css';\nimport { ListError } from './list.js';\nimport { ListView } from './listView.js';\n\nclass TraitRenderer {\n  constructor(trait) {\n    this.trait = trait;\n    this.renderedElements = [];\n  }\n\n  get templateId() {\n    return `template:${this.trait.trait}`;\n  }\n\n  renderTemplate(container) {\n    return container;\n  }\n\n  renderElement(element, index, templateData) {\n    const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\n\n    if (renderedElementIndex >= 0) {\n      const rendered = this.renderedElements[renderedElementIndex];\n      this.trait.unrender(templateData);\n      rendered.index = index;\n    } else {\n      const rendered = {\n        index,\n        templateData\n      };\n      this.renderedElements.push(rendered);\n    }\n\n    this.trait.renderIndex(index, templateData);\n  }\n\n  splice(start, deleteCount, insertCount) {\n    const rendered = [];\n\n    for (const renderedElement of this.renderedElements) {\n      if (renderedElement.index < start) {\n        rendered.push(renderedElement);\n      } else if (renderedElement.index >= start + deleteCount) {\n        rendered.push({\n          index: renderedElement.index + insertCount - deleteCount,\n          templateData: renderedElement.templateData\n        });\n      }\n    }\n\n    this.renderedElements = rendered;\n  }\n\n  renderIndexes(indexes) {\n    for (const {\n      index,\n      templateData\n    } of this.renderedElements) {\n      if (indexes.indexOf(index) > -1) {\n        this.trait.renderIndex(index, templateData);\n      }\n    }\n  }\n\n  disposeTemplate(templateData) {\n    const index = this.renderedElements.findIndex(el => el.templateData === templateData);\n\n    if (index < 0) {\n      return;\n    }\n\n    this.renderedElements.splice(index, 1);\n  }\n\n}\n\nclass Trait {\n  constructor(_trait) {\n    this._trait = _trait;\n    this.length = 0;\n    this.indexes = [];\n    this.sortedIndexes = [];\n    this._onChange = new Emitter();\n    this.onChange = this._onChange.event;\n  }\n\n  get trait() {\n    return this._trait;\n  }\n\n  get renderer() {\n    return new TraitRenderer(this);\n  }\n\n  splice(start, deleteCount, elements) {\n    var _a;\n\n    deleteCount = Math.max(0, Math.min(deleteCount, this.length - start));\n    const diff = elements.length - deleteCount;\n    const end = start + deleteCount;\n    const sortedIndexes = [...this.sortedIndexes.filter(i => i < start), ...elements.map((hasTrait, i) => hasTrait ? i + start : -1).filter(i => i !== -1), ...this.sortedIndexes.filter(i => i >= end).map(i => i + diff)];\n    const length = this.length + diff;\n\n    if (this.sortedIndexes.length > 0 && sortedIndexes.length === 0 && length > 0) {\n      const first = (_a = this.sortedIndexes.find(index => index >= start)) !== null && _a !== void 0 ? _a : length - 1;\n      sortedIndexes.push(Math.min(first, length - 1));\n    }\n\n    this.renderer.splice(start, deleteCount, elements.length);\n\n    this._set(sortedIndexes, sortedIndexes);\n\n    this.length = length;\n  }\n\n  renderIndex(index, container) {\n    container.classList.toggle(this._trait, this.contains(index));\n  }\n\n  unrender(container) {\n    container.classList.remove(this._trait);\n  }\n  /**\n   * Sets the indexes which should have this trait.\n   *\n   * @param indexes Indexes which should have this trait.\n   * @return The old indexes which had this trait.\n   */\n\n\n  set(indexes, browserEvent) {\n    return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n  }\n\n  _set(indexes, sortedIndexes, browserEvent) {\n    const result = this.indexes;\n    const sortedResult = this.sortedIndexes;\n    this.indexes = indexes;\n    this.sortedIndexes = sortedIndexes;\n    const toRender = disjunction(sortedResult, indexes);\n    this.renderer.renderIndexes(toRender);\n\n    this._onChange.fire({\n      indexes,\n      browserEvent\n    });\n\n    return result;\n  }\n\n  get() {\n    return this.indexes;\n  }\n\n  contains(index) {\n    return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n  }\n\n  dispose() {\n    dispose(this._onChange);\n  }\n\n}\n\n__decorate([memoize], Trait.prototype, \"renderer\", null);\n\nclass SelectionTrait extends Trait {\n  constructor(setAriaSelected) {\n    super('selected');\n    this.setAriaSelected = setAriaSelected;\n  }\n\n  renderIndex(index, container) {\n    super.renderIndex(index, container);\n\n    if (this.setAriaSelected) {\n      if (this.contains(index)) {\n        container.setAttribute('aria-selected', 'true');\n      } else {\n        container.setAttribute('aria-selected', 'false');\n      }\n    }\n  }\n\n}\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\n\n\nclass TraitSpliceable {\n  constructor(trait, view, identityProvider) {\n    this.trait = trait;\n    this.view = view;\n    this.identityProvider = identityProvider;\n  }\n\n  splice(start, deleteCount, elements) {\n    if (!this.identityProvider) {\n      return this.trait.splice(start, deleteCount, elements.map(() => false));\n    }\n\n    const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\n    const elementsWithTrait = elements.map(e => pastElementsWithTrait.indexOf(this.identityProvider.getId(e).toString()) > -1);\n    this.trait.splice(start, deleteCount, elementsWithTrait);\n  }\n\n}\n\nexport function isInputElement(e) {\n  return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nexport function isMonacoEditor(e) {\n  if (e.classList.contains('monaco-editor')) {\n    return true;\n  }\n\n  if (e.classList.contains('monaco-list')) {\n    return false;\n  }\n\n  if (!e.parentElement) {\n    return false;\n  }\n\n  return isMonacoEditor(e.parentElement);\n}\n\nclass KeyboardController {\n  constructor(list, view, options) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    this.multipleSelectionDisposables = new DisposableStore();\n    this.onKeyDown.filter(e => e.keyCode === 3\n    /* Enter */\n    ).on(this.onEnter, this, this.disposables);\n    this.onKeyDown.filter(e => e.keyCode === 16\n    /* UpArrow */\n    ).on(this.onUpArrow, this, this.disposables);\n    this.onKeyDown.filter(e => e.keyCode === 18\n    /* DownArrow */\n    ).on(this.onDownArrow, this, this.disposables);\n    this.onKeyDown.filter(e => e.keyCode === 11\n    /* PageUp */\n    ).on(this.onPageUpArrow, this, this.disposables);\n    this.onKeyDown.filter(e => e.keyCode === 12\n    /* PageDown */\n    ).on(this.onPageDownArrow, this, this.disposables);\n    this.onKeyDown.filter(e => e.keyCode === 9\n    /* Escape */\n    ).on(this.onEscape, this, this.disposables);\n\n    if (options.multipleSelectionSupport !== false) {\n      this.onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31\n      /* KeyA */\n      ).on(this.onCtrlA, this, this.multipleSelectionDisposables);\n    }\n  }\n\n  get onKeyDown() {\n    return Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event).filter(e => !isInputElement(e.target)).map(e => new StandardKeyboardEvent(e));\n  }\n\n  updateOptions(optionsUpdate) {\n    if (optionsUpdate.multipleSelectionSupport !== undefined) {\n      this.multipleSelectionDisposables.clear();\n\n      if (optionsUpdate.multipleSelectionSupport) {\n        this.onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31\n        /* KeyA */\n        ).on(this.onCtrlA, this, this.multipleSelectionDisposables);\n      }\n    }\n  }\n\n  onEnter(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(this.list.getFocus(), e.browserEvent);\n  }\n\n  onUpArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPrevious(1, false, e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n\n  onDownArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNext(1, false, e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n\n  onPageUpArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPreviousPage(e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n\n  onPageDownArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNextPage(e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n\n  onCtrlA(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(range(this.list.length), e.browserEvent);\n    this.list.setAnchor(undefined);\n    this.view.domNode.focus();\n  }\n\n  onEscape(e) {\n    if (this.list.getSelection().length) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.list.setSelection([], e.browserEvent);\n      this.list.setAnchor(undefined);\n      this.view.domNode.focus();\n    }\n  }\n\n  dispose() {\n    this.disposables.dispose();\n    this.multipleSelectionDisposables.dispose();\n  }\n\n}\n\n__decorate([memoize], KeyboardController.prototype, \"onKeyDown\", null);\n\nvar TypeLabelControllerState;\n\n(function (TypeLabelControllerState) {\n  TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\n  TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\n\nexport const DefaultKeyboardNavigationDelegate = new class {\n  mightProducePrintableCharacter(event) {\n    if (event.ctrlKey || event.metaKey || event.altKey) {\n      return false;\n    }\n\n    return event.keyCode >= 31\n    /* KeyA */\n    && event.keyCode <= 56\n    /* KeyZ */\n    || event.keyCode >= 21\n    /* Digit0 */\n    && event.keyCode <= 30\n    /* Digit9 */\n    || event.keyCode >= 93\n    /* Numpad0 */\n    && event.keyCode <= 102\n    /* Numpad9 */\n    || event.keyCode >= 80\n    /* Semicolon */\n    && event.keyCode <= 90\n    /* Quote */\n    ;\n  }\n\n}();\n\nclass TypeLabelController {\n  constructor(list, view, keyboardNavigationLabelProvider, delegate) {\n    this.list = list;\n    this.view = view;\n    this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n    this.delegate = delegate;\n    this.enabled = false;\n    this.state = TypeLabelControllerState.Idle;\n    this.automaticKeyboardNavigation = true;\n    this.triggered = false;\n    this.previouslyFocused = -1;\n    this.enabledDisposables = new DisposableStore();\n    this.disposables = new DisposableStore();\n    this.updateOptions(list.options);\n  }\n\n  updateOptions(options) {\n    const enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\n\n    if (enableKeyboardNavigation) {\n      this.enable();\n    } else {\n      this.disable();\n    }\n\n    if (typeof options.automaticKeyboardNavigation !== 'undefined') {\n      this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\n    }\n  }\n\n  enable() {\n    if (this.enabled) {\n      return;\n    }\n\n    const onChar = Event.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode, 'keydown')).event).filter(e => !isInputElement(e.target)).filter(() => this.automaticKeyboardNavigation || this.triggered).map(event => new StandardKeyboardEvent(event)).filter(e => this.delegate.mightProducePrintableCharacter(e)).forEach(e => e.preventDefault()).map(event => event.browserEvent.key).event;\n    const onClear = Event.debounce(onChar, () => null, 800);\n    const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : (r || '') + i);\n    onInput(this.onInput, this, this.enabledDisposables);\n    onClear(this.onClear, this, this.enabledDisposables);\n    this.enabled = true;\n    this.triggered = false;\n  }\n\n  disable() {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.enabledDisposables.clear();\n    this.enabled = false;\n    this.triggered = false;\n  }\n\n  onClear() {\n    var _a;\n\n    const focus = this.list.getFocus();\n\n    if (focus.length > 0 && focus[0] === this.previouslyFocused) {\n      // List: re-announce element on typing end since typed keys will interrupt aria label of focused element\n      // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\n      const ariaLabel = (_a = this.list.options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getAriaLabel(this.list.element(focus[0]));\n\n      if (ariaLabel) {\n        alert(ariaLabel);\n      }\n    }\n\n    this.previouslyFocused = -1;\n  }\n\n  onInput(word) {\n    if (!word) {\n      this.state = TypeLabelControllerState.Idle;\n      this.triggered = false;\n      return;\n    }\n\n    const focus = this.list.getFocus();\n    const start = focus.length > 0 ? focus[0] : 0;\n    const delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\n    this.state = TypeLabelControllerState.Typing;\n\n    for (let i = 0; i < this.list.length; i++) {\n      const index = (start + i + delta) % this.list.length;\n      const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n      const labelStr = label && label.toString();\n\n      if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n        this.previouslyFocused = start;\n        this.list.setFocus([index]);\n        this.list.reveal(index);\n        return;\n      }\n    }\n  }\n\n  dispose() {\n    this.disable();\n    this.enabledDisposables.dispose();\n    this.disposables.dispose();\n  }\n\n}\n\nclass DOMFocusController {\n  constructor(list, view) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    const onKeyDown = Event.chain(this.disposables.add(new DomEmitter(view.domNode, 'keydown')).event).filter(e => !isInputElement(e.target)).map(e => new StandardKeyboardEvent(e));\n    onKeyDown.filter(e => e.keyCode === 2\n    /* Tab */\n    && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey).on(this.onTab, this, this.disposables);\n  }\n\n  onTab(e) {\n    if (e.target !== this.view.domNode) {\n      return;\n    }\n\n    const focus = this.list.getFocus();\n\n    if (focus.length === 0) {\n      return;\n    }\n\n    const focusedDomElement = this.view.domElement(focus[0]);\n\n    if (!focusedDomElement) {\n      return;\n    }\n\n    const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n\n    if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n      return;\n    }\n\n    const style = window.getComputedStyle(tabIndexElement);\n\n    if (style.visibility === 'hidden' || style.display === 'none') {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    tabIndexElement.focus();\n  }\n\n  dispose() {\n    this.disposables.dispose();\n  }\n\n}\n\nexport function isSelectionSingleChangeEvent(event) {\n  return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n  return event.browserEvent.shiftKey;\n}\n\nfunction isMouseRightClick(event) {\n  return event instanceof MouseEvent && event.button === 2;\n}\n\nconst DefaultMultipleSelectionController = {\n  isSelectionSingleChangeEvent,\n  isSelectionRangeChangeEvent\n};\nexport class MouseController {\n  constructor(list) {\n    this.list = list;\n    this.disposables = new DisposableStore();\n    this._onPointer = new Emitter();\n    this.onPointer = this._onPointer.event;\n\n    if (list.options.multipleSelectionSupport !== false) {\n      this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n    }\n\n    this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n\n    if (this.mouseSupport) {\n      list.onMouseDown(this.onMouseDown, this, this.disposables);\n      list.onContextMenu(this.onContextMenu, this, this.disposables);\n      list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n      list.onTouchStart(this.onMouseDown, this, this.disposables);\n      this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n    }\n\n    Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\n  }\n\n  updateOptions(optionsUpdate) {\n    if (optionsUpdate.multipleSelectionSupport !== undefined) {\n      this.multipleSelectionController = undefined;\n\n      if (optionsUpdate.multipleSelectionSupport) {\n        this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n      }\n    }\n  }\n\n  isSelectionSingleChangeEvent(event) {\n    if (!this.multipleSelectionController) {\n      return false;\n    }\n\n    return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n  }\n\n  isSelectionRangeChangeEvent(event) {\n    if (!this.multipleSelectionController) {\n      return false;\n    }\n\n    return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n  }\n\n  isSelectionChangeEvent(event) {\n    return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n  }\n\n  onMouseDown(e) {\n    if (isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n\n    if (document.activeElement !== e.browserEvent.target) {\n      this.list.domFocus();\n    }\n  }\n\n  onContextMenu(e) {\n    if (isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n\n    const focus = typeof e.index === 'undefined' ? [] : [e.index];\n    this.list.setFocus(focus, e.browserEvent);\n  }\n\n  onViewPointer(e) {\n    if (!this.mouseSupport) {\n      return;\n    }\n\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n\n    const focus = e.index;\n\n    if (typeof focus === 'undefined') {\n      this.list.setFocus([], e.browserEvent);\n      this.list.setSelection([], e.browserEvent);\n      this.list.setAnchor(undefined);\n      return;\n    }\n\n    if (this.isSelectionRangeChangeEvent(e)) {\n      return this.changeSelection(e);\n    }\n\n    if (this.isSelectionChangeEvent(e)) {\n      return this.changeSelection(e);\n    }\n\n    this.list.setFocus([focus], e.browserEvent);\n    this.list.setAnchor(focus);\n\n    if (!isMouseRightClick(e.browserEvent)) {\n      this.list.setSelection([focus], e.browserEvent);\n    }\n\n    this._onPointer.fire(e);\n  }\n\n  onDoubleClick(e) {\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n\n    if (this.isSelectionChangeEvent(e)) {\n      return;\n    }\n\n    const focus = this.list.getFocus();\n    this.list.setSelection(focus, e.browserEvent);\n  }\n\n  changeSelection(e) {\n    const focus = e.index;\n    let anchor = this.list.getAnchor();\n\n    if (this.isSelectionRangeChangeEvent(e)) {\n      if (typeof anchor === 'undefined') {\n        const currentFocus = this.list.getFocus()[0];\n        anchor = currentFocus !== null && currentFocus !== void 0 ? currentFocus : focus;\n        this.list.setAnchor(anchor);\n      }\n\n      const min = Math.min(anchor, focus);\n      const max = Math.max(anchor, focus);\n      const rangeSelection = range(min, max + 1);\n      const selection = this.list.getSelection();\n      const contiguousRange = getContiguousRangeContaining(disjunction(selection, [anchor]), anchor);\n\n      if (contiguousRange.length === 0) {\n        return;\n      }\n\n      const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n      this.list.setSelection(newSelection, e.browserEvent);\n      this.list.setFocus([focus], e.browserEvent);\n    } else if (this.isSelectionSingleChangeEvent(e)) {\n      const selection = this.list.getSelection();\n      const newSelection = selection.filter(i => i !== focus);\n      this.list.setFocus([focus]);\n      this.list.setAnchor(focus);\n\n      if (selection.length === newSelection.length) {\n        this.list.setSelection([...newSelection, focus], e.browserEvent);\n      } else {\n        this.list.setSelection(newSelection, e.browserEvent);\n      }\n    }\n  }\n\n  dispose() {\n    this.disposables.dispose();\n  }\n\n}\nexport class DefaultStyleController {\n  constructor(styleElement, selectorSuffix) {\n    this.styleElement = styleElement;\n    this.selectorSuffix = selectorSuffix;\n  }\n\n  style(styles) {\n    const suffix = this.selectorSuffix && `.${this.selectorSuffix}`;\n    const content = [];\n\n    if (styles.listBackground) {\n      if (styles.listBackground.isOpaque()) {\n        content.push(`.monaco-list${suffix} .monaco-list-rows { background: ${styles.listBackground}; }`);\n      } else if (!platform.isMacintosh) {\n        // subpixel AA doesn't exist in macOS\n        console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`);\n      }\n    }\n\n    if (styles.listFocusBackground) {\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n    }\n\n    if (styles.listFocusForeground) {\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n    }\n\n    if (styles.listActiveSelectionBackground) {\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n    }\n\n    if (styles.listActiveSelectionForeground) {\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n    }\n\n    if (styles.listActiveSelectionIconForeground) {\n      content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected .codicon { color: ${styles.listActiveSelectionIconForeground}; }`);\n    }\n\n    if (styles.listFocusAndSelectionBackground) {\n      content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n    }\n\n    if (styles.listFocusAndSelectionForeground) {\n      content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n    }\n\n    if (styles.listInactiveFocusForeground) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.focused { color:  ${styles.listInactiveFocusForeground}; }`);\n      content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { color:  ${styles.listInactiveFocusForeground}; }`); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionIconForeground) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.focused .codicon { color:  ${styles.listInactiveSelectionIconForeground}; }`);\n    }\n\n    if (styles.listInactiveFocusBackground) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n      content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionBackground) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n      content.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionForeground) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n    }\n\n    if (styles.listHoverBackground) {\n      content.push(`.monaco-list${suffix}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${styles.listHoverBackground}; }`);\n    }\n\n    if (styles.listHoverForeground) {\n      content.push(`.monaco-list${suffix} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n    }\n\n    if (styles.listSelectionOutline) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n    }\n\n    if (styles.listFocusOutline) {\n      content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${suffix}.last-focused .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n    }\n\n    if (styles.listInactiveFocusOutline) {\n      content.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n    }\n\n    if (styles.listHoverOutline) {\n      content.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n    }\n\n    if (styles.listDropBackground) {\n      content.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\n    }\n\n    if (styles.listFilterWidgetBackground) {\n      content.push(`.monaco-list-type-filter { background-color: ${styles.listFilterWidgetBackground} }`);\n    }\n\n    if (styles.listFilterWidgetOutline) {\n      content.push(`.monaco-list-type-filter { border: 1px solid ${styles.listFilterWidgetOutline}; }`);\n    }\n\n    if (styles.listFilterWidgetNoMatchesOutline) {\n      content.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${styles.listFilterWidgetNoMatchesOutline}; }`);\n    }\n\n    if (styles.listMatchesShadow) {\n      content.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${styles.listMatchesShadow}; }`);\n    }\n\n    if (styles.tableColumnsBorder) {\n      content.push(`\n\t\t\t\t.monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${styles.tableColumnsBorder};\n\t\t\t}`);\n    }\n\n    if (styles.tableOddRowsBackgroundColor) {\n      content.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${styles.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`);\n    }\n\n    this.styleElement.textContent = content.join('\\n');\n  }\n\n}\nconst defaultStyles = {\n  listFocusBackground: Color.fromHex('#7FB0D0'),\n  listActiveSelectionBackground: Color.fromHex('#0E639C'),\n  listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\n  listActiveSelectionIconForeground: Color.fromHex('#FFFFFF'),\n  listFocusAndSelectionBackground: Color.fromHex('#094771'),\n  listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\n  listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\n  listInactiveSelectionIconForeground: Color.fromHex('#FFFFFF'),\n  listHoverBackground: Color.fromHex('#2A2D2E'),\n  listDropBackground: Color.fromHex('#383B3D'),\n  treeIndentGuidesStroke: Color.fromHex('#a9a9a9'),\n  tableColumnsBorder: Color.fromHex('#cccccc').transparent(0.2),\n  tableOddRowsBackgroundColor: Color.fromHex('#cccccc').transparent(0.04)\n};\nconst DefaultOptions = {\n  keyboardSupport: true,\n  mouseSupport: true,\n  multipleSelectionSupport: true,\n  dnd: {\n    getDragURI() {\n      return null;\n    },\n\n    onDragStart() {},\n\n    onDragOver() {\n      return false;\n    },\n\n    drop() {}\n\n  }\n}; // TODO@Joao: move these utils into a SortedArray class\n\nfunction getContiguousRangeContaining(range, value) {\n  const index = range.indexOf(value);\n\n  if (index === -1) {\n    return [];\n  }\n\n  const result = [];\n  let i = index - 1;\n\n  while (i >= 0 && range[i] === value - (index - i)) {\n    result.push(range[i--]);\n  }\n\n  result.reverse();\n  i = index;\n\n  while (i < range.length && range[i] === value + (i - index)) {\n    result.push(range[i++]);\n  }\n\n  return result;\n}\n/**\n * Given two sorted collections of numbers, returns the intersection\n * between them (OR).\n */\n\n\nfunction disjunction(one, other) {\n  const result = [];\n  let i = 0,\n      j = 0;\n\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      result.push(one[i]);\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      result.push(other[j++]);\n    }\n  }\n\n  return result;\n}\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\n\n\nfunction relativeComplement(one, other) {\n  const result = [];\n  let i = 0,\n      j = 0;\n\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      j++;\n    }\n  }\n\n  return result;\n}\n\nconst numericSort = (a, b) => a - b;\n\nclass PipelineRenderer {\n  constructor(_templateId, renderers) {\n    this._templateId = _templateId;\n    this.renderers = renderers;\n  }\n\n  get templateId() {\n    return this._templateId;\n  }\n\n  renderTemplate(container) {\n    return this.renderers.map(r => r.renderTemplate(container));\n  }\n\n  renderElement(element, index, templateData, height) {\n    let i = 0;\n\n    for (const renderer of this.renderers) {\n      renderer.renderElement(element, index, templateData[i++], height);\n    }\n  }\n\n  disposeElement(element, index, templateData, height) {\n    let i = 0;\n\n    for (const renderer of this.renderers) {\n      if (renderer.disposeElement) {\n        renderer.disposeElement(element, index, templateData[i], height);\n      }\n\n      i += 1;\n    }\n  }\n\n  disposeTemplate(templateData) {\n    let i = 0;\n\n    for (const renderer of this.renderers) {\n      renderer.disposeTemplate(templateData[i++]);\n    }\n  }\n\n}\n\nclass AccessibiltyRenderer {\n  constructor(accessibilityProvider) {\n    this.accessibilityProvider = accessibilityProvider;\n    this.templateId = 'a18n';\n  }\n\n  renderTemplate(container) {\n    return container;\n  }\n\n  renderElement(element, index, container) {\n    const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n\n    if (ariaLabel) {\n      container.setAttribute('aria-label', ariaLabel);\n    } else {\n      container.removeAttribute('aria-label');\n    }\n\n    const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n\n    if (typeof ariaLevel === 'number') {\n      container.setAttribute('aria-level', `${ariaLevel}`);\n    } else {\n      container.removeAttribute('aria-level');\n    }\n  }\n\n  disposeTemplate(templateData) {// noop\n  }\n\n}\n\nclass ListViewDragAndDrop {\n  constructor(list, dnd) {\n    this.list = list;\n    this.dnd = dnd;\n  }\n\n  getDragElements(element) {\n    const selection = this.list.getSelectedElements();\n    const elements = selection.indexOf(element) > -1 ? selection : [element];\n    return elements;\n  }\n\n  getDragURI(element) {\n    return this.dnd.getDragURI(element);\n  }\n\n  getDragLabel(elements, originalEvent) {\n    if (this.dnd.getDragLabel) {\n      return this.dnd.getDragLabel(elements, originalEvent);\n    }\n\n    return undefined;\n  }\n\n  onDragStart(data, originalEvent) {\n    if (this.dnd.onDragStart) {\n      this.dnd.onDragStart(data, originalEvent);\n    }\n  }\n\n  onDragOver(data, targetElement, targetIndex, originalEvent) {\n    return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n  }\n\n  onDragLeave(data, targetElement, targetIndex, originalEvent) {\n    var _a, _b;\n\n    (_b = (_a = this.dnd).onDragLeave) === null || _b === void 0 ? void 0 : _b.call(_a, data, targetElement, targetIndex, originalEvent);\n  }\n\n  onDragEnd(originalEvent) {\n    if (this.dnd.onDragEnd) {\n      this.dnd.onDragEnd(originalEvent);\n    }\n  }\n\n  drop(data, targetElement, targetIndex, originalEvent) {\n    this.dnd.drop(data, targetElement, targetIndex, originalEvent);\n  }\n\n}\n/**\n * The {@link List} is a virtual scrolling widget, built on top of the {@link ListView}\n * widget.\n *\n * Features:\n * - Customizable keyboard and mouse support\n * - Element traits: focus, selection, achor\n * - Accessibility support\n * - Touch support\n * - Performant template-based rendering\n * - Horizontal scrolling\n * - Variable element height support\n * - Dynamic element height support\n * - Drag-and-drop support\n */\n\n\nexport class List {\n  constructor(user, container, virtualDelegate, renderers, _options = DefaultOptions) {\n    var _a;\n\n    this.user = user;\n    this._options = _options;\n    this.focus = new Trait('focused');\n    this.anchor = new Trait('anchor');\n    this.eventBufferer = new EventBufferer();\n    this._ariaLabel = '';\n    this.disposables = new DisposableStore();\n    this._onDidDispose = new Emitter();\n    this.onDidDispose = this._onDidDispose.event;\n    const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? (_a = this._options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getWidgetRole() : 'list';\n    this.selection = new SelectionTrait(role !== 'listbox');\n    mixin(_options, defaultStyles, false);\n    const baseRenderers = [this.focus.renderer, this.selection.renderer];\n    this.accessibilityProvider = _options.accessibilityProvider;\n\n    if (this.accessibilityProvider) {\n      baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n\n      if (this.accessibilityProvider.onDidChangeActiveDescendant) {\n        this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant, this, this.disposables);\n      }\n    }\n\n    renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n    const viewOptions = Object.assign(Object.assign({}, _options), {\n      dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd)\n    });\n    this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\n    this.view.domNode.setAttribute('role', role);\n\n    if (_options.styleController) {\n      this.styleController = _options.styleController(this.view.domId);\n    } else {\n      const styleElement = createStyleSheet(this.view.domNode);\n      this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n    }\n\n    this.spliceable = new CombinedSpliceable([new TraitSpliceable(this.focus, this.view, _options.identityProvider), new TraitSpliceable(this.selection, this.view, _options.identityProvider), new TraitSpliceable(this.anchor, this.view, _options.identityProvider), this.view]);\n    this.disposables.add(this.focus);\n    this.disposables.add(this.selection);\n    this.disposables.add(this.anchor);\n    this.disposables.add(this.view);\n    this.disposables.add(this._onDidDispose);\n    this.disposables.add(new DOMFocusController(this, this.view));\n\n    if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n      this.keyboardController = new KeyboardController(this, this.view, _options);\n      this.disposables.add(this.keyboardController);\n    }\n\n    if (_options.keyboardNavigationLabelProvider) {\n      const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n      this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider, delegate);\n      this.disposables.add(this.typeLabelController);\n    }\n\n    this.mouseController = this.createMouseController(_options);\n    this.disposables.add(this.mouseController);\n    this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\n    this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\n\n    if (this.accessibilityProvider) {\n      this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\n    }\n\n    if (this._options.multipleSelectionSupport !== false) {\n      this.view.domNode.setAttribute('aria-multiselectable', 'true');\n    }\n  }\n\n  get onDidChangeFocus() {\n    return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e));\n  }\n\n  get onDidChangeSelection() {\n    return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e));\n  }\n\n  get domId() {\n    return this.view.domId;\n  }\n\n  get onMouseClick() {\n    return this.view.onMouseClick;\n  }\n\n  get onMouseDblClick() {\n    return this.view.onMouseDblClick;\n  }\n\n  get onMouseMiddleClick() {\n    return this.view.onMouseMiddleClick;\n  }\n\n  get onPointer() {\n    return this.mouseController.onPointer;\n  }\n\n  get onMouseDown() {\n    return this.view.onMouseDown;\n  }\n\n  get onTouchStart() {\n    return this.view.onTouchStart;\n  }\n\n  get onTap() {\n    return this.view.onTap;\n  }\n  /**\n   * Possible context menu trigger events:\n   * - ContextMenu key\n   * - Shift F10\n   * - Ctrl Option Shift M (macOS with VoiceOver)\n   * - Mouse right click\n   */\n\n\n  get onContextMenu() {\n    let didJustPressContextMenuKey = false;\n    const fromKeyDown = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event).map(e => new StandardKeyboardEvent(e)).filter(e => didJustPressContextMenuKey = e.keyCode === 58\n    /* ContextMenu */\n    || e.shiftKey && e.keyCode === 68\n    /* F10 */\n    ).map(stopEvent).filter(() => false).event;\n    const fromKeyUp = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keyup')).event).forEach(() => didJustPressContextMenuKey = false).map(e => new StandardKeyboardEvent(e)).filter(e => e.keyCode === 58\n    /* ContextMenu */\n    || e.shiftKey && e.keyCode === 68\n    /* F10 */\n    ).map(stopEvent).map(({\n      browserEvent\n    }) => {\n      const focus = this.getFocus();\n      const index = focus.length ? focus[0] : undefined;\n      const element = typeof index !== 'undefined' ? this.view.element(index) : undefined;\n      const anchor = typeof index !== 'undefined' ? this.view.domElement(index) : this.view.domNode;\n      return {\n        index,\n        element,\n        anchor,\n        browserEvent\n      };\n    }).event;\n    const fromMouse = Event.chain(this.view.onContextMenu).filter(_ => !didJustPressContextMenuKey).map(({\n      element,\n      index,\n      browserEvent\n    }) => ({\n      element,\n      index,\n      anchor: {\n        x: browserEvent.pageX + 1,\n        y: browserEvent.pageY\n      },\n      browserEvent\n    })).event;\n    return Event.any(fromKeyDown, fromKeyUp, fromMouse);\n  }\n\n  get onKeyDown() {\n    return this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event;\n  }\n\n  get onDidFocus() {\n    return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'focus', true)).event);\n  }\n\n  createMouseController(options) {\n    return new MouseController(this);\n  }\n\n  updateOptions(optionsUpdate = {}) {\n    var _a;\n\n    this._options = Object.assign(Object.assign({}, this._options), optionsUpdate);\n\n    if (this.typeLabelController) {\n      this.typeLabelController.updateOptions(this._options);\n    }\n\n    if (this._options.multipleSelectionController !== undefined) {\n      if (this._options.multipleSelectionSupport) {\n        this.view.domNode.setAttribute('aria-multiselectable', 'true');\n      } else {\n        this.view.domNode.removeAttribute('aria-multiselectable');\n      }\n    }\n\n    this.mouseController.updateOptions(optionsUpdate);\n    (_a = this.keyboardController) === null || _a === void 0 ? void 0 : _a.updateOptions(optionsUpdate);\n    this.view.updateOptions(optionsUpdate);\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  splice(start, deleteCount, elements = []) {\n    if (start < 0 || start > this.view.length) {\n      throw new ListError(this.user, `Invalid start index: ${start}`);\n    }\n\n    if (deleteCount < 0) {\n      throw new ListError(this.user, `Invalid delete count: ${deleteCount}`);\n    }\n\n    if (deleteCount === 0 && elements.length === 0) {\n      return;\n    }\n\n    this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n  }\n\n  rerender() {\n    this.view.rerender();\n  }\n\n  element(index) {\n    return this.view.element(index);\n  }\n\n  get length() {\n    return this.view.length;\n  }\n\n  get contentHeight() {\n    return this.view.contentHeight;\n  }\n\n  get scrollTop() {\n    return this.view.getScrollTop();\n  }\n\n  set scrollTop(scrollTop) {\n    this.view.setScrollTop(scrollTop);\n  }\n\n  get ariaLabel() {\n    return this._ariaLabel;\n  }\n\n  set ariaLabel(value) {\n    this._ariaLabel = value;\n    this.view.domNode.setAttribute('aria-label', value);\n  }\n\n  domFocus() {\n    this.view.domNode.focus({\n      preventScroll: true\n    });\n  }\n\n  layout(height, width) {\n    this.view.layout(height, width);\n  }\n\n  setSelection(indexes, browserEvent) {\n    for (const index of indexes) {\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, `Invalid index ${index}`);\n      }\n    }\n\n    this.selection.set(indexes, browserEvent);\n  }\n\n  getSelection() {\n    return this.selection.get();\n  }\n\n  getSelectedElements() {\n    return this.getSelection().map(i => this.view.element(i));\n  }\n\n  setAnchor(index) {\n    if (typeof index === 'undefined') {\n      this.anchor.set([]);\n      return;\n    }\n\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, `Invalid index ${index}`);\n    }\n\n    this.anchor.set([index]);\n  }\n\n  getAnchor() {\n    return firstOrDefault(this.anchor.get(), undefined);\n  }\n\n  getAnchorElement() {\n    const anchor = this.getAnchor();\n    return typeof anchor === 'undefined' ? undefined : this.element(anchor);\n  }\n\n  setFocus(indexes, browserEvent) {\n    for (const index of indexes) {\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, `Invalid index ${index}`);\n      }\n    }\n\n    this.focus.set(indexes, browserEvent);\n  }\n\n  focusNext(n = 1, loop = false, browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n\n    const focus = this.focus.get();\n    const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n\n  focusPrevious(n = 1, loop = false, browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n\n    const focus = this.focus.get();\n    const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n\n  focusNextPage(browserEvent, filter) {\n    return __awaiter(this, void 0, void 0, function* () {\n      let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n      lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n      const lastPageElement = this.view.element(lastPageIndex);\n      const currentlyFocusedElement = this.getFocusedElements()[0];\n\n      if (currentlyFocusedElement !== lastPageElement) {\n        const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n\n        if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\n          this.setFocus([lastGoodPageIndex], browserEvent);\n        } else {\n          this.setFocus([lastPageIndex], browserEvent);\n        }\n      } else {\n        const previousScrollTop = this.view.getScrollTop();\n        this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\n\n        if (this.view.getScrollTop() !== previousScrollTop) {\n          this.setFocus([]); // Let the scroll event listener run\n\n          yield timeout(0);\n          yield this.focusNextPage(browserEvent, filter);\n        }\n      }\n    });\n  }\n\n  focusPreviousPage(browserEvent, filter) {\n    return __awaiter(this, void 0, void 0, function* () {\n      let firstPageIndex;\n      const scrollTop = this.view.getScrollTop();\n\n      if (scrollTop === 0) {\n        firstPageIndex = this.view.indexAt(scrollTop);\n      } else {\n        firstPageIndex = this.view.indexAfter(scrollTop - 1);\n      }\n\n      const firstPageElement = this.view.element(firstPageIndex);\n      const currentlyFocusedElement = this.getFocusedElements()[0];\n\n      if (currentlyFocusedElement !== firstPageElement) {\n        const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n\n        if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\n          this.setFocus([firstGoodPageIndex], browserEvent);\n        } else {\n          this.setFocus([firstPageIndex], browserEvent);\n        }\n      } else {\n        const previousScrollTop = scrollTop;\n        this.view.setScrollTop(scrollTop - this.view.renderHeight);\n\n        if (this.view.getScrollTop() !== previousScrollTop) {\n          this.setFocus([]); // Let the scroll event listener run\n\n          yield timeout(0);\n          yield this.focusPreviousPage(browserEvent, filter);\n        }\n      }\n    });\n  }\n\n  focusLast(browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n\n    const index = this.findPreviousIndex(this.length - 1, false, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n\n  focusFirst(browserEvent, filter) {\n    this.focusNth(0, browserEvent, filter);\n  }\n\n  focusNth(n, browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n\n    const index = this.findNextIndex(n, false, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n\n  findNextIndex(index, loop = false, filter) {\n    for (let i = 0; i < this.length; i++) {\n      if (index >= this.length && !loop) {\n        return -1;\n      }\n\n      index = index % this.length;\n\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n\n      index++;\n    }\n\n    return -1;\n  }\n\n  findPreviousIndex(index, loop = false, filter) {\n    for (let i = 0; i < this.length; i++) {\n      if (index < 0 && !loop) {\n        return -1;\n      }\n\n      index = (this.length + index % this.length) % this.length;\n\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n\n      index--;\n    }\n\n    return -1;\n  }\n\n  getFocus() {\n    return this.focus.get();\n  }\n\n  getFocusedElements() {\n    return this.getFocus().map(i => this.view.element(i));\n  }\n\n  reveal(index, relativeTop) {\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, `Invalid index ${index}`);\n    }\n\n    const scrollTop = this.view.getScrollTop();\n    const elementTop = this.view.elementTop(index);\n    const elementHeight = this.view.elementHeight(index);\n\n    if (isNumber(relativeTop)) {\n      // y = mx + b\n      const m = elementHeight - this.view.renderHeight;\n      this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\n    } else {\n      const viewItemBottom = elementTop + elementHeight;\n      const scrollBottom = scrollTop + this.view.renderHeight;\n\n      if (elementTop < scrollTop && viewItemBottom >= scrollBottom) {// The element is already overflowing the viewport, no-op\n      } else if (elementTop < scrollTop || viewItemBottom >= scrollBottom && elementHeight >= this.view.renderHeight) {\n        this.view.setScrollTop(elementTop);\n      } else if (viewItemBottom >= scrollBottom) {\n        this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n      }\n    }\n  }\n  /**\n   * Returns the relative position of an element rendered in the list.\n   * Returns `null` if the element isn't *entirely* in the visible viewport.\n   */\n\n\n  getRelativeTop(index) {\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, `Invalid index ${index}`);\n    }\n\n    const scrollTop = this.view.getScrollTop();\n    const elementTop = this.view.elementTop(index);\n    const elementHeight = this.view.elementHeight(index);\n\n    if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n      return null;\n    } // y = mx + b\n\n\n    const m = elementHeight - this.view.renderHeight;\n    return Math.abs((scrollTop - elementTop) / m);\n  }\n\n  getHTMLElement() {\n    return this.view.domNode;\n  }\n\n  style(styles) {\n    this.styleController.style(styles);\n  }\n\n  toListEvent({\n    indexes,\n    browserEvent\n  }) {\n    return {\n      indexes,\n      elements: indexes.map(i => this.view.element(i)),\n      browserEvent\n    };\n  }\n\n  _onFocusChange() {\n    const focus = this.focus.get();\n    this.view.domNode.classList.toggle('element-focused', focus.length > 0);\n    this.onDidChangeActiveDescendant();\n  }\n\n  onDidChangeActiveDescendant() {\n    var _a;\n\n    const focus = this.focus.get();\n\n    if (focus.length > 0) {\n      let id;\n\n      if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\n        id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n      }\n\n      this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n    } else {\n      this.view.domNode.removeAttribute('aria-activedescendant');\n    }\n  }\n\n  _onSelectionChange() {\n    const selection = this.selection.get();\n    this.view.domNode.classList.toggle('selection-none', selection.length === 0);\n    this.view.domNode.classList.toggle('selection-single', selection.length === 1);\n    this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\n  }\n\n  dispose() {\n    this._onDidDispose.fire();\n\n    this.disposables.dispose();\n\n    this._onDidDispose.dispose();\n  }\n\n}\n\n__decorate([memoize], List.prototype, \"onDidChangeFocus\", null);\n\n__decorate([memoize], List.prototype, \"onDidChangeSelection\", null);\n\n__decorate([memoize], List.prototype, \"onContextMenu\", null);\n\n__decorate([memoize], List.prototype, \"onKeyDown\", null);\n\n__decorate([memoize], List.prototype, \"onDidFocus\", null);","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","createStyleSheet","DomEmitter","stopEvent","StandardKeyboardEvent","Gesture","alert","CombinedSpliceable","binarySearch","firstOrDefault","range","timeout","Color","memoize","Emitter","Event","EventBufferer","matchesPrefix","DisposableStore","dispose","clamp","mixin","platform","isNumber","ListError","ListView","TraitRenderer","constructor","trait","renderedElements","templateId","renderTemplate","container","renderElement","element","index","templateData","renderedElementIndex","findIndex","el","rendered","unrender","push","renderIndex","splice","start","deleteCount","insertCount","renderedElement","renderIndexes","indexes","indexOf","disposeTemplate","Trait","_trait","sortedIndexes","_onChange","onChange","event","renderer","elements","_a","Math","max","min","diff","end","filter","map","hasTrait","first","find","_set","classList","toggle","contains","remove","set","browserEvent","sort","numericSort","sortedResult","toRender","disjunction","fire","get","prototype","SelectionTrait","setAriaSelected","setAttribute","TraitSpliceable","view","identityProvider","pastElementsWithTrait","getId","toString","elementsWithTrait","isInputElement","tagName","isMonacoEditor","parentElement","KeyboardController","list","options","disposables","multipleSelectionDisposables","onKeyDown","keyCode","on","onEnter","onUpArrow","onDownArrow","onPageUpArrow","onPageDownArrow","onEscape","multipleSelectionSupport","isMacintosh","metaKey","ctrlKey","onCtrlA","chain","add","domNode","updateOptions","optionsUpdate","undefined","clear","preventDefault","stopPropagation","setSelection","getFocus","focusPrevious","setAnchor","reveal","focus","focusNext","focusPreviousPage","focusNextPage","getSelection","TypeLabelControllerState","DefaultKeyboardNavigationDelegate","mightProducePrintableCharacter","altKey","TypeLabelController","keyboardNavigationLabelProvider","delegate","enabled","state","Idle","automaticKeyboardNavigation","triggered","previouslyFocused","enabledDisposables","enableKeyboardNavigation","enable","disable","onChar","forEach","onClear","debounce","onInput","reduce","any","ariaLabel","accessibilityProvider","getAriaLabel","word","delta","Typing","label","getKeyboardNavigationLabel","labelStr","setFocus","DOMFocusController","shiftKey","onTab","focusedDomElement","domElement","tabIndexElement","querySelector","HTMLElement","tabIndex","style","window","getComputedStyle","visibility","display","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","isMouseRightClick","MouseEvent","button","DefaultMultipleSelectionController","MouseController","_onPointer","onPointer","multipleSelectionController","mouseSupport","onMouseDown","onContextMenu","onMouseDblClick","onDoubleClick","onTouchStart","addTarget","getHTMLElement","onMouseClick","onMouseMiddleClick","onTap","onViewPointer","isSelectionChangeEvent","document","activeElement","domFocus","changeSelection","anchor","getAnchor","currentFocus","rangeSelection","selection","contiguousRange","getContiguousRangeContaining","newSelection","relativeComplement","DefaultStyleController","styleElement","selectorSuffix","styles","suffix","content","listBackground","isOpaque","console","warn","listFocusBackground","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listActiveSelectionIconForeground","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveFocusForeground","listInactiveSelectionIconForeground","listInactiveFocusBackground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","listSelectionOutline","listFocusOutline","listInactiveFocusOutline","listHoverOutline","listDropBackground","listFilterWidgetBackground","listFilterWidgetOutline","listFilterWidgetNoMatchesOutline","listMatchesShadow","tableColumnsBorder","tableOddRowsBackgroundColor","textContent","join","defaultStyles","fromHex","treeIndentGuidesStroke","transparent","DefaultOptions","keyboardSupport","dnd","getDragURI","onDragStart","onDragOver","drop","reverse","one","other","j","a","b","PipelineRenderer","_templateId","renderers","height","disposeElement","AccessibiltyRenderer","removeAttribute","ariaLevel","getAriaLevel","ListViewDragAndDrop","getDragElements","getSelectedElements","getDragLabel","originalEvent","data","targetElement","targetIndex","onDragLeave","_b","call","onDragEnd","List","user","virtualDelegate","_options","eventBufferer","_ariaLabel","_onDidDispose","onDidDispose","role","getWidgetRole","baseRenderers","onDidChangeActiveDescendant","viewOptions","assign","styleController","domId","spliceable","keyboardController","keyboardNavigationDelegate","typeLabelController","mouseController","createMouseController","onDidChangeFocus","_onFocusChange","onDidChangeSelection","_onSelectionChange","getWidgetAriaLabel","wrapEvent","toListEvent","didJustPressContextMenuKey","fromKeyDown","fromKeyUp","fromMouse","_","x","pageX","y","pageY","onDidFocus","signal","bufferEvents","rerender","contentHeight","scrollTop","getScrollTop","setScrollTop","preventScroll","layout","width","getAnchorElement","n","loop","findNextIndex","findPreviousIndex","lastPageIndex","indexAt","renderHeight","lastPageElement","currentlyFocusedElement","getFocusedElements","lastGoodPageIndex","previousScrollTop","elementHeight","firstPageIndex","indexAfter","firstPageElement","firstGoodPageIndex","focusLast","focusFirst","focusNth","relativeTop","elementTop","m","viewItemBottom","scrollBottom","getRelativeTop","abs","id","getActiveDescendantId","getElementDomId"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createStyleSheet } from '../../dom.js';\nimport { DomEmitter, stopEvent } from '../../event.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Gesture } from '../../touch.js';\nimport { alert } from '../aria/aria.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { binarySearch, firstOrDefault, range } from '../../../common/arrays.js';\nimport { timeout } from '../../../common/async.js';\nimport { Color } from '../../../common/color.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event, EventBufferer } from '../../../common/event.js';\nimport { matchesPrefix } from '../../../common/filters.js';\nimport { DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { mixin } from '../../../common/objects.js';\nimport * as platform from '../../../common/platform.js';\nimport { isNumber } from '../../../common/types.js';\nimport './list.css';\nimport { ListError } from './list.js';\nimport { ListView } from './listView.js';\nclass TraitRenderer {\n    constructor(trait) {\n        this.trait = trait;\n        this.renderedElements = [];\n    }\n    get templateId() {\n        return `template:${this.trait.trait}`;\n    }\n    renderTemplate(container) {\n        return container;\n    }\n    renderElement(element, index, templateData) {\n        const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\n        if (renderedElementIndex >= 0) {\n            const rendered = this.renderedElements[renderedElementIndex];\n            this.trait.unrender(templateData);\n            rendered.index = index;\n        }\n        else {\n            const rendered = { index, templateData };\n            this.renderedElements.push(rendered);\n        }\n        this.trait.renderIndex(index, templateData);\n    }\n    splice(start, deleteCount, insertCount) {\n        const rendered = [];\n        for (const renderedElement of this.renderedElements) {\n            if (renderedElement.index < start) {\n                rendered.push(renderedElement);\n            }\n            else if (renderedElement.index >= start + deleteCount) {\n                rendered.push({\n                    index: renderedElement.index + insertCount - deleteCount,\n                    templateData: renderedElement.templateData\n                });\n            }\n        }\n        this.renderedElements = rendered;\n    }\n    renderIndexes(indexes) {\n        for (const { index, templateData } of this.renderedElements) {\n            if (indexes.indexOf(index) > -1) {\n                this.trait.renderIndex(index, templateData);\n            }\n        }\n    }\n    disposeTemplate(templateData) {\n        const index = this.renderedElements.findIndex(el => el.templateData === templateData);\n        if (index < 0) {\n            return;\n        }\n        this.renderedElements.splice(index, 1);\n    }\n}\nclass Trait {\n    constructor(_trait) {\n        this._trait = _trait;\n        this.length = 0;\n        this.indexes = [];\n        this.sortedIndexes = [];\n        this._onChange = new Emitter();\n        this.onChange = this._onChange.event;\n    }\n    get trait() { return this._trait; }\n    get renderer() {\n        return new TraitRenderer(this);\n    }\n    splice(start, deleteCount, elements) {\n        var _a;\n        deleteCount = Math.max(0, Math.min(deleteCount, this.length - start));\n        const diff = elements.length - deleteCount;\n        const end = start + deleteCount;\n        const sortedIndexes = [\n            ...this.sortedIndexes.filter(i => i < start),\n            ...elements.map((hasTrait, i) => hasTrait ? i + start : -1).filter(i => i !== -1),\n            ...this.sortedIndexes.filter(i => i >= end).map(i => i + diff)\n        ];\n        const length = this.length + diff;\n        if (this.sortedIndexes.length > 0 && sortedIndexes.length === 0 && length > 0) {\n            const first = (_a = this.sortedIndexes.find(index => index >= start)) !== null && _a !== void 0 ? _a : length - 1;\n            sortedIndexes.push(Math.min(first, length - 1));\n        }\n        this.renderer.splice(start, deleteCount, elements.length);\n        this._set(sortedIndexes, sortedIndexes);\n        this.length = length;\n    }\n    renderIndex(index, container) {\n        container.classList.toggle(this._trait, this.contains(index));\n    }\n    unrender(container) {\n        container.classList.remove(this._trait);\n    }\n    /**\n     * Sets the indexes which should have this trait.\n     *\n     * @param indexes Indexes which should have this trait.\n     * @return The old indexes which had this trait.\n     */\n    set(indexes, browserEvent) {\n        return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n    }\n    _set(indexes, sortedIndexes, browserEvent) {\n        const result = this.indexes;\n        const sortedResult = this.sortedIndexes;\n        this.indexes = indexes;\n        this.sortedIndexes = sortedIndexes;\n        const toRender = disjunction(sortedResult, indexes);\n        this.renderer.renderIndexes(toRender);\n        this._onChange.fire({ indexes, browserEvent });\n        return result;\n    }\n    get() {\n        return this.indexes;\n    }\n    contains(index) {\n        return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n    }\n    dispose() {\n        dispose(this._onChange);\n    }\n}\n__decorate([\n    memoize\n], Trait.prototype, \"renderer\", null);\nclass SelectionTrait extends Trait {\n    constructor(setAriaSelected) {\n        super('selected');\n        this.setAriaSelected = setAriaSelected;\n    }\n    renderIndex(index, container) {\n        super.renderIndex(index, container);\n        if (this.setAriaSelected) {\n            if (this.contains(index)) {\n                container.setAttribute('aria-selected', 'true');\n            }\n            else {\n                container.setAttribute('aria-selected', 'false');\n            }\n        }\n    }\n}\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\nclass TraitSpliceable {\n    constructor(trait, view, identityProvider) {\n        this.trait = trait;\n        this.view = view;\n        this.identityProvider = identityProvider;\n    }\n    splice(start, deleteCount, elements) {\n        if (!this.identityProvider) {\n            return this.trait.splice(start, deleteCount, elements.map(() => false));\n        }\n        const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\n        const elementsWithTrait = elements.map(e => pastElementsWithTrait.indexOf(this.identityProvider.getId(e).toString()) > -1);\n        this.trait.splice(start, deleteCount, elementsWithTrait);\n    }\n}\nexport function isInputElement(e) {\n    return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nexport function isMonacoEditor(e) {\n    if (e.classList.contains('monaco-editor')) {\n        return true;\n    }\n    if (e.classList.contains('monaco-list')) {\n        return false;\n    }\n    if (!e.parentElement) {\n        return false;\n    }\n    return isMonacoEditor(e.parentElement);\n}\nclass KeyboardController {\n    constructor(list, view, options) {\n        this.list = list;\n        this.view = view;\n        this.disposables = new DisposableStore();\n        this.multipleSelectionDisposables = new DisposableStore();\n        this.onKeyDown.filter(e => e.keyCode === 3 /* Enter */).on(this.onEnter, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 16 /* UpArrow */).on(this.onUpArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 18 /* DownArrow */).on(this.onDownArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 11 /* PageUp */).on(this.onPageUpArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 12 /* PageDown */).on(this.onPageDownArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 9 /* Escape */).on(this.onEscape, this, this.disposables);\n        if (options.multipleSelectionSupport !== false) {\n            this.onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KeyA */).on(this.onCtrlA, this, this.multipleSelectionDisposables);\n        }\n    }\n    get onKeyDown() {\n        return Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event)\n            .filter(e => !isInputElement(e.target))\n            .map(e => new StandardKeyboardEvent(e));\n    }\n    updateOptions(optionsUpdate) {\n        if (optionsUpdate.multipleSelectionSupport !== undefined) {\n            this.multipleSelectionDisposables.clear();\n            if (optionsUpdate.multipleSelectionSupport) {\n                this.onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KeyA */).on(this.onCtrlA, this, this.multipleSelectionDisposables);\n            }\n        }\n    }\n    onEnter(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(this.list.getFocus(), e.browserEvent);\n    }\n    onUpArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPrevious(1, false, e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onDownArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNext(1, false, e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onPageUpArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPreviousPage(e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onPageDownArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNextPage(e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onCtrlA(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(range(this.list.length), e.browserEvent);\n        this.list.setAnchor(undefined);\n        this.view.domNode.focus();\n    }\n    onEscape(e) {\n        if (this.list.getSelection().length) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.list.setSelection([], e.browserEvent);\n            this.list.setAnchor(undefined);\n            this.view.domNode.focus();\n        }\n    }\n    dispose() {\n        this.disposables.dispose();\n        this.multipleSelectionDisposables.dispose();\n    }\n}\n__decorate([\n    memoize\n], KeyboardController.prototype, \"onKeyDown\", null);\nvar TypeLabelControllerState;\n(function (TypeLabelControllerState) {\n    TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\n    TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\nexport const DefaultKeyboardNavigationDelegate = new class {\n    mightProducePrintableCharacter(event) {\n        if (event.ctrlKey || event.metaKey || event.altKey) {\n            return false;\n        }\n        return (event.keyCode >= 31 /* KeyA */ && event.keyCode <= 56 /* KeyZ */)\n            || (event.keyCode >= 21 /* Digit0 */ && event.keyCode <= 30 /* Digit9 */)\n            || (event.keyCode >= 93 /* Numpad0 */ && event.keyCode <= 102 /* Numpad9 */)\n            || (event.keyCode >= 80 /* Semicolon */ && event.keyCode <= 90 /* Quote */);\n    }\n};\nclass TypeLabelController {\n    constructor(list, view, keyboardNavigationLabelProvider, delegate) {\n        this.list = list;\n        this.view = view;\n        this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n        this.delegate = delegate;\n        this.enabled = false;\n        this.state = TypeLabelControllerState.Idle;\n        this.automaticKeyboardNavigation = true;\n        this.triggered = false;\n        this.previouslyFocused = -1;\n        this.enabledDisposables = new DisposableStore();\n        this.disposables = new DisposableStore();\n        this.updateOptions(list.options);\n    }\n    updateOptions(options) {\n        const enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\n        if (enableKeyboardNavigation) {\n            this.enable();\n        }\n        else {\n            this.disable();\n        }\n        if (typeof options.automaticKeyboardNavigation !== 'undefined') {\n            this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\n        }\n    }\n    enable() {\n        if (this.enabled) {\n            return;\n        }\n        const onChar = Event.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode, 'keydown')).event)\n            .filter(e => !isInputElement(e.target))\n            .filter(() => this.automaticKeyboardNavigation || this.triggered)\n            .map(event => new StandardKeyboardEvent(event))\n            .filter(e => this.delegate.mightProducePrintableCharacter(e))\n            .forEach(e => e.preventDefault())\n            .map(event => event.browserEvent.key)\n            .event;\n        const onClear = Event.debounce(onChar, () => null, 800);\n        const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : ((r || '') + i));\n        onInput(this.onInput, this, this.enabledDisposables);\n        onClear(this.onClear, this, this.enabledDisposables);\n        this.enabled = true;\n        this.triggered = false;\n    }\n    disable() {\n        if (!this.enabled) {\n            return;\n        }\n        this.enabledDisposables.clear();\n        this.enabled = false;\n        this.triggered = false;\n    }\n    onClear() {\n        var _a;\n        const focus = this.list.getFocus();\n        if (focus.length > 0 && focus[0] === this.previouslyFocused) {\n            // List: re-announce element on typing end since typed keys will interrupt aria label of focused element\n            // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\n            const ariaLabel = (_a = this.list.options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getAriaLabel(this.list.element(focus[0]));\n            if (ariaLabel) {\n                alert(ariaLabel);\n            }\n        }\n        this.previouslyFocused = -1;\n    }\n    onInput(word) {\n        if (!word) {\n            this.state = TypeLabelControllerState.Idle;\n            this.triggered = false;\n            return;\n        }\n        const focus = this.list.getFocus();\n        const start = focus.length > 0 ? focus[0] : 0;\n        const delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\n        this.state = TypeLabelControllerState.Typing;\n        for (let i = 0; i < this.list.length; i++) {\n            const index = (start + i + delta) % this.list.length;\n            const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n            const labelStr = label && label.toString();\n            if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n                this.previouslyFocused = start;\n                this.list.setFocus([index]);\n                this.list.reveal(index);\n                return;\n            }\n        }\n    }\n    dispose() {\n        this.disable();\n        this.enabledDisposables.dispose();\n        this.disposables.dispose();\n    }\n}\nclass DOMFocusController {\n    constructor(list, view) {\n        this.list = list;\n        this.view = view;\n        this.disposables = new DisposableStore();\n        const onKeyDown = Event.chain(this.disposables.add(new DomEmitter(view.domNode, 'keydown')).event)\n            .filter(e => !isInputElement(e.target))\n            .map(e => new StandardKeyboardEvent(e));\n        onKeyDown.filter(e => e.keyCode === 2 /* Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey)\n            .on(this.onTab, this, this.disposables);\n    }\n    onTab(e) {\n        if (e.target !== this.view.domNode) {\n            return;\n        }\n        const focus = this.list.getFocus();\n        if (focus.length === 0) {\n            return;\n        }\n        const focusedDomElement = this.view.domElement(focus[0]);\n        if (!focusedDomElement) {\n            return;\n        }\n        const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n        if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n            return;\n        }\n        const style = window.getComputedStyle(tabIndexElement);\n        if (style.visibility === 'hidden' || style.display === 'none') {\n            return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        tabIndexElement.focus();\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nexport function isSelectionSingleChangeEvent(event) {\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n    return event.browserEvent.shiftKey;\n}\nfunction isMouseRightClick(event) {\n    return event instanceof MouseEvent && event.button === 2;\n}\nconst DefaultMultipleSelectionController = {\n    isSelectionSingleChangeEvent,\n    isSelectionRangeChangeEvent\n};\nexport class MouseController {\n    constructor(list) {\n        this.list = list;\n        this.disposables = new DisposableStore();\n        this._onPointer = new Emitter();\n        this.onPointer = this._onPointer.event;\n        if (list.options.multipleSelectionSupport !== false) {\n            this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n        }\n        this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n        if (this.mouseSupport) {\n            list.onMouseDown(this.onMouseDown, this, this.disposables);\n            list.onContextMenu(this.onContextMenu, this, this.disposables);\n            list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n            list.onTouchStart(this.onMouseDown, this, this.disposables);\n            this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n        }\n        Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\n    }\n    updateOptions(optionsUpdate) {\n        if (optionsUpdate.multipleSelectionSupport !== undefined) {\n            this.multipleSelectionController = undefined;\n            if (optionsUpdate.multipleSelectionSupport) {\n                this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n            }\n        }\n    }\n    isSelectionSingleChangeEvent(event) {\n        if (!this.multipleSelectionController) {\n            return false;\n        }\n        return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n    }\n    isSelectionRangeChangeEvent(event) {\n        if (!this.multipleSelectionController) {\n            return false;\n        }\n        return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n    }\n    isSelectionChangeEvent(event) {\n        return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n    }\n    onMouseDown(e) {\n        if (isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (document.activeElement !== e.browserEvent.target) {\n            this.list.domFocus();\n        }\n    }\n    onContextMenu(e) {\n        if (isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        const focus = typeof e.index === 'undefined' ? [] : [e.index];\n        this.list.setFocus(focus, e.browserEvent);\n    }\n    onViewPointer(e) {\n        if (!this.mouseSupport) {\n            return;\n        }\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        const focus = e.index;\n        if (typeof focus === 'undefined') {\n            this.list.setFocus([], e.browserEvent);\n            this.list.setSelection([], e.browserEvent);\n            this.list.setAnchor(undefined);\n            return;\n        }\n        if (this.isSelectionRangeChangeEvent(e)) {\n            return this.changeSelection(e);\n        }\n        if (this.isSelectionChangeEvent(e)) {\n            return this.changeSelection(e);\n        }\n        this.list.setFocus([focus], e.browserEvent);\n        this.list.setAnchor(focus);\n        if (!isMouseRightClick(e.browserEvent)) {\n            this.list.setSelection([focus], e.browserEvent);\n        }\n        this._onPointer.fire(e);\n    }\n    onDoubleClick(e) {\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (this.isSelectionChangeEvent(e)) {\n            return;\n        }\n        const focus = this.list.getFocus();\n        this.list.setSelection(focus, e.browserEvent);\n    }\n    changeSelection(e) {\n        const focus = e.index;\n        let anchor = this.list.getAnchor();\n        if (this.isSelectionRangeChangeEvent(e)) {\n            if (typeof anchor === 'undefined') {\n                const currentFocus = this.list.getFocus()[0];\n                anchor = currentFocus !== null && currentFocus !== void 0 ? currentFocus : focus;\n                this.list.setAnchor(anchor);\n            }\n            const min = Math.min(anchor, focus);\n            const max = Math.max(anchor, focus);\n            const rangeSelection = range(min, max + 1);\n            const selection = this.list.getSelection();\n            const contiguousRange = getContiguousRangeContaining(disjunction(selection, [anchor]), anchor);\n            if (contiguousRange.length === 0) {\n                return;\n            }\n            const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n            this.list.setSelection(newSelection, e.browserEvent);\n            this.list.setFocus([focus], e.browserEvent);\n        }\n        else if (this.isSelectionSingleChangeEvent(e)) {\n            const selection = this.list.getSelection();\n            const newSelection = selection.filter(i => i !== focus);\n            this.list.setFocus([focus]);\n            this.list.setAnchor(focus);\n            if (selection.length === newSelection.length) {\n                this.list.setSelection([...newSelection, focus], e.browserEvent);\n            }\n            else {\n                this.list.setSelection(newSelection, e.browserEvent);\n            }\n        }\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nexport class DefaultStyleController {\n    constructor(styleElement, selectorSuffix) {\n        this.styleElement = styleElement;\n        this.selectorSuffix = selectorSuffix;\n    }\n    style(styles) {\n        const suffix = this.selectorSuffix && `.${this.selectorSuffix}`;\n        const content = [];\n        if (styles.listBackground) {\n            if (styles.listBackground.isOpaque()) {\n                content.push(`.monaco-list${suffix} .monaco-list-rows { background: ${styles.listBackground}; }`);\n            }\n            else if (!platform.isMacintosh) { // subpixel AA doesn't exist in macOS\n                console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`);\n            }\n        }\n        if (styles.listFocusBackground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listFocusForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n        }\n        if (styles.listActiveSelectionBackground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listActiveSelectionForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n        }\n        if (styles.listActiveSelectionIconForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected .codicon { color: ${styles.listActiveSelectionIconForeground}; }`);\n        }\n        if (styles.listFocusAndSelectionBackground) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n        }\n        if (styles.listFocusAndSelectionForeground) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n        }\n        if (styles.listInactiveFocusForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { color:  ${styles.listInactiveFocusForeground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { color:  ${styles.listInactiveFocusForeground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionIconForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused .codicon { color:  ${styles.listInactiveSelectionIconForeground}; }`);\n        }\n        if (styles.listInactiveFocusBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n        }\n        if (styles.listHoverBackground) {\n            content.push(`.monaco-list${suffix}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${styles.listHoverBackground}; }`);\n        }\n        if (styles.listHoverForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n        }\n        if (styles.listSelectionOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listFocusOutline) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${suffix}.last-focused .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n        }\n        if (styles.listInactiveFocusOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listHoverOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listDropBackground) {\n            content.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\n        }\n        if (styles.listFilterWidgetBackground) {\n            content.push(`.monaco-list-type-filter { background-color: ${styles.listFilterWidgetBackground} }`);\n        }\n        if (styles.listFilterWidgetOutline) {\n            content.push(`.monaco-list-type-filter { border: 1px solid ${styles.listFilterWidgetOutline}; }`);\n        }\n        if (styles.listFilterWidgetNoMatchesOutline) {\n            content.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${styles.listFilterWidgetNoMatchesOutline}; }`);\n        }\n        if (styles.listMatchesShadow) {\n            content.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${styles.listMatchesShadow}; }`);\n        }\n        if (styles.tableColumnsBorder) {\n            content.push(`\n\t\t\t\t.monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${styles.tableColumnsBorder};\n\t\t\t}`);\n        }\n        if (styles.tableOddRowsBackgroundColor) {\n            content.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${styles.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`);\n        }\n        this.styleElement.textContent = content.join('\\n');\n    }\n}\nconst defaultStyles = {\n    listFocusBackground: Color.fromHex('#7FB0D0'),\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\n    listActiveSelectionIconForeground: Color.fromHex('#FFFFFF'),\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\n    listInactiveSelectionIconForeground: Color.fromHex('#FFFFFF'),\n    listHoverBackground: Color.fromHex('#2A2D2E'),\n    listDropBackground: Color.fromHex('#383B3D'),\n    treeIndentGuidesStroke: Color.fromHex('#a9a9a9'),\n    tableColumnsBorder: Color.fromHex('#cccccc').transparent(0.2),\n    tableOddRowsBackgroundColor: Color.fromHex('#cccccc').transparent(0.04)\n};\nconst DefaultOptions = {\n    keyboardSupport: true,\n    mouseSupport: true,\n    multipleSelectionSupport: true,\n    dnd: {\n        getDragURI() { return null; },\n        onDragStart() { },\n        onDragOver() { return false; },\n        drop() { }\n    }\n};\n// TODO@Joao: move these utils into a SortedArray class\nfunction getContiguousRangeContaining(range, value) {\n    const index = range.indexOf(value);\n    if (index === -1) {\n        return [];\n    }\n    const result = [];\n    let i = index - 1;\n    while (i >= 0 && range[i] === value - (index - i)) {\n        result.push(range[i--]);\n    }\n    result.reverse();\n    i = index;\n    while (i < range.length && range[i] === value + (i - index)) {\n        result.push(range[i++]);\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the intersection\n * between them (OR).\n */\nfunction disjunction(one, other) {\n    const result = [];\n    let i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            result.push(one[i]);\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            result.push(other[j++]);\n        }\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\nfunction relativeComplement(one, other) {\n    const result = [];\n    let i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            j++;\n        }\n    }\n    return result;\n}\nconst numericSort = (a, b) => a - b;\nclass PipelineRenderer {\n    constructor(_templateId, renderers) {\n        this._templateId = _templateId;\n        this.renderers = renderers;\n    }\n    get templateId() {\n        return this._templateId;\n    }\n    renderTemplate(container) {\n        return this.renderers.map(r => r.renderTemplate(container));\n    }\n    renderElement(element, index, templateData, height) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.renderElement(element, index, templateData[i++], height);\n        }\n    }\n    disposeElement(element, index, templateData, height) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            if (renderer.disposeElement) {\n                renderer.disposeElement(element, index, templateData[i], height);\n            }\n            i += 1;\n        }\n    }\n    disposeTemplate(templateData) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.disposeTemplate(templateData[i++]);\n        }\n    }\n}\nclass AccessibiltyRenderer {\n    constructor(accessibilityProvider) {\n        this.accessibilityProvider = accessibilityProvider;\n        this.templateId = 'a18n';\n    }\n    renderTemplate(container) {\n        return container;\n    }\n    renderElement(element, index, container) {\n        const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n        if (ariaLabel) {\n            container.setAttribute('aria-label', ariaLabel);\n        }\n        else {\n            container.removeAttribute('aria-label');\n        }\n        const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n        if (typeof ariaLevel === 'number') {\n            container.setAttribute('aria-level', `${ariaLevel}`);\n        }\n        else {\n            container.removeAttribute('aria-level');\n        }\n    }\n    disposeTemplate(templateData) {\n        // noop\n    }\n}\nclass ListViewDragAndDrop {\n    constructor(list, dnd) {\n        this.list = list;\n        this.dnd = dnd;\n    }\n    getDragElements(element) {\n        const selection = this.list.getSelectedElements();\n        const elements = selection.indexOf(element) > -1 ? selection : [element];\n        return elements;\n    }\n    getDragURI(element) {\n        return this.dnd.getDragURI(element);\n    }\n    getDragLabel(elements, originalEvent) {\n        if (this.dnd.getDragLabel) {\n            return this.dnd.getDragLabel(elements, originalEvent);\n        }\n        return undefined;\n    }\n    onDragStart(data, originalEvent) {\n        if (this.dnd.onDragStart) {\n            this.dnd.onDragStart(data, originalEvent);\n        }\n    }\n    onDragOver(data, targetElement, targetIndex, originalEvent) {\n        return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n    }\n    onDragLeave(data, targetElement, targetIndex, originalEvent) {\n        var _a, _b;\n        (_b = (_a = this.dnd).onDragLeave) === null || _b === void 0 ? void 0 : _b.call(_a, data, targetElement, targetIndex, originalEvent);\n    }\n    onDragEnd(originalEvent) {\n        if (this.dnd.onDragEnd) {\n            this.dnd.onDragEnd(originalEvent);\n        }\n    }\n    drop(data, targetElement, targetIndex, originalEvent) {\n        this.dnd.drop(data, targetElement, targetIndex, originalEvent);\n    }\n}\n/**\n * The {@link List} is a virtual scrolling widget, built on top of the {@link ListView}\n * widget.\n *\n * Features:\n * - Customizable keyboard and mouse support\n * - Element traits: focus, selection, achor\n * - Accessibility support\n * - Touch support\n * - Performant template-based rendering\n * - Horizontal scrolling\n * - Variable element height support\n * - Dynamic element height support\n * - Drag-and-drop support\n */\nexport class List {\n    constructor(user, container, virtualDelegate, renderers, _options = DefaultOptions) {\n        var _a;\n        this.user = user;\n        this._options = _options;\n        this.focus = new Trait('focused');\n        this.anchor = new Trait('anchor');\n        this.eventBufferer = new EventBufferer();\n        this._ariaLabel = '';\n        this.disposables = new DisposableStore();\n        this._onDidDispose = new Emitter();\n        this.onDidDispose = this._onDidDispose.event;\n        const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? (_a = this._options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getWidgetRole() : 'list';\n        this.selection = new SelectionTrait(role !== 'listbox');\n        mixin(_options, defaultStyles, false);\n        const baseRenderers = [this.focus.renderer, this.selection.renderer];\n        this.accessibilityProvider = _options.accessibilityProvider;\n        if (this.accessibilityProvider) {\n            baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n            if (this.accessibilityProvider.onDidChangeActiveDescendant) {\n                this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant, this, this.disposables);\n            }\n        }\n        renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n        const viewOptions = Object.assign(Object.assign({}, _options), { dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd) });\n        this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\n        this.view.domNode.setAttribute('role', role);\n        if (_options.styleController) {\n            this.styleController = _options.styleController(this.view.domId);\n        }\n        else {\n            const styleElement = createStyleSheet(this.view.domNode);\n            this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n        }\n        this.spliceable = new CombinedSpliceable([\n            new TraitSpliceable(this.focus, this.view, _options.identityProvider),\n            new TraitSpliceable(this.selection, this.view, _options.identityProvider),\n            new TraitSpliceable(this.anchor, this.view, _options.identityProvider),\n            this.view\n        ]);\n        this.disposables.add(this.focus);\n        this.disposables.add(this.selection);\n        this.disposables.add(this.anchor);\n        this.disposables.add(this.view);\n        this.disposables.add(this._onDidDispose);\n        this.disposables.add(new DOMFocusController(this, this.view));\n        if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n            this.keyboardController = new KeyboardController(this, this.view, _options);\n            this.disposables.add(this.keyboardController);\n        }\n        if (_options.keyboardNavigationLabelProvider) {\n            const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n            this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider, delegate);\n            this.disposables.add(this.typeLabelController);\n        }\n        this.mouseController = this.createMouseController(_options);\n        this.disposables.add(this.mouseController);\n        this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\n        this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\n        if (this.accessibilityProvider) {\n            this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\n        }\n        if (this._options.multipleSelectionSupport !== false) {\n            this.view.domNode.setAttribute('aria-multiselectable', 'true');\n        }\n    }\n    get onDidChangeFocus() {\n        return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e));\n    }\n    get onDidChangeSelection() {\n        return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e));\n    }\n    get domId() { return this.view.domId; }\n    get onMouseClick() { return this.view.onMouseClick; }\n    get onMouseDblClick() { return this.view.onMouseDblClick; }\n    get onMouseMiddleClick() { return this.view.onMouseMiddleClick; }\n    get onPointer() { return this.mouseController.onPointer; }\n    get onMouseDown() { return this.view.onMouseDown; }\n    get onTouchStart() { return this.view.onTouchStart; }\n    get onTap() { return this.view.onTap; }\n    /**\n     * Possible context menu trigger events:\n     * - ContextMenu key\n     * - Shift F10\n     * - Ctrl Option Shift M (macOS with VoiceOver)\n     * - Mouse right click\n     */\n    get onContextMenu() {\n        let didJustPressContextMenuKey = false;\n        const fromKeyDown = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event)\n            .map(e => new StandardKeyboardEvent(e))\n            .filter(e => didJustPressContextMenuKey = e.keyCode === 58 /* ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* F10 */))\n            .map(stopEvent)\n            .filter(() => false)\n            .event;\n        const fromKeyUp = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keyup')).event)\n            .forEach(() => didJustPressContextMenuKey = false)\n            .map(e => new StandardKeyboardEvent(e))\n            .filter(e => e.keyCode === 58 /* ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* F10 */))\n            .map(stopEvent)\n            .map(({ browserEvent }) => {\n            const focus = this.getFocus();\n            const index = focus.length ? focus[0] : undefined;\n            const element = typeof index !== 'undefined' ? this.view.element(index) : undefined;\n            const anchor = typeof index !== 'undefined' ? this.view.domElement(index) : this.view.domNode;\n            return { index, element, anchor, browserEvent };\n        })\n            .event;\n        const fromMouse = Event.chain(this.view.onContextMenu)\n            .filter(_ => !didJustPressContextMenuKey)\n            .map(({ element, index, browserEvent }) => ({ element, index, anchor: { x: browserEvent.pageX + 1, y: browserEvent.pageY }, browserEvent }))\n            .event;\n        return Event.any(fromKeyDown, fromKeyUp, fromMouse);\n    }\n    get onKeyDown() { return this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event; }\n    get onDidFocus() { return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'focus', true)).event); }\n    createMouseController(options) {\n        return new MouseController(this);\n    }\n    updateOptions(optionsUpdate = {}) {\n        var _a;\n        this._options = Object.assign(Object.assign({}, this._options), optionsUpdate);\n        if (this.typeLabelController) {\n            this.typeLabelController.updateOptions(this._options);\n        }\n        if (this._options.multipleSelectionController !== undefined) {\n            if (this._options.multipleSelectionSupport) {\n                this.view.domNode.setAttribute('aria-multiselectable', 'true');\n            }\n            else {\n                this.view.domNode.removeAttribute('aria-multiselectable');\n            }\n        }\n        this.mouseController.updateOptions(optionsUpdate);\n        (_a = this.keyboardController) === null || _a === void 0 ? void 0 : _a.updateOptions(optionsUpdate);\n        this.view.updateOptions(optionsUpdate);\n    }\n    get options() {\n        return this._options;\n    }\n    splice(start, deleteCount, elements = []) {\n        if (start < 0 || start > this.view.length) {\n            throw new ListError(this.user, `Invalid start index: ${start}`);\n        }\n        if (deleteCount < 0) {\n            throw new ListError(this.user, `Invalid delete count: ${deleteCount}`);\n        }\n        if (deleteCount === 0 && elements.length === 0) {\n            return;\n        }\n        this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n    }\n    rerender() {\n        this.view.rerender();\n    }\n    element(index) {\n        return this.view.element(index);\n    }\n    get length() {\n        return this.view.length;\n    }\n    get contentHeight() {\n        return this.view.contentHeight;\n    }\n    get scrollTop() {\n        return this.view.getScrollTop();\n    }\n    set scrollTop(scrollTop) {\n        this.view.setScrollTop(scrollTop);\n    }\n    get ariaLabel() {\n        return this._ariaLabel;\n    }\n    set ariaLabel(value) {\n        this._ariaLabel = value;\n        this.view.domNode.setAttribute('aria-label', value);\n    }\n    domFocus() {\n        this.view.domNode.focus({ preventScroll: true });\n    }\n    layout(height, width) {\n        this.view.layout(height, width);\n    }\n    setSelection(indexes, browserEvent) {\n        for (const index of indexes) {\n            if (index < 0 || index >= this.length) {\n                throw new ListError(this.user, `Invalid index ${index}`);\n            }\n        }\n        this.selection.set(indexes, browserEvent);\n    }\n    getSelection() {\n        return this.selection.get();\n    }\n    getSelectedElements() {\n        return this.getSelection().map(i => this.view.element(i));\n    }\n    setAnchor(index) {\n        if (typeof index === 'undefined') {\n            this.anchor.set([]);\n            return;\n        }\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        this.anchor.set([index]);\n    }\n    getAnchor() {\n        return firstOrDefault(this.anchor.get(), undefined);\n    }\n    getAnchorElement() {\n        const anchor = this.getAnchor();\n        return typeof anchor === 'undefined' ? undefined : this.element(anchor);\n    }\n    setFocus(indexes, browserEvent) {\n        for (const index of indexes) {\n            if (index < 0 || index >= this.length) {\n                throw new ListError(this.user, `Invalid index ${index}`);\n            }\n        }\n        this.focus.set(indexes, browserEvent);\n    }\n    focusNext(n = 1, loop = false, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const focus = this.focus.get();\n        const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusPrevious(n = 1, loop = false, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const focus = this.focus.get();\n        const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusNextPage(browserEvent, filter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n            lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n            const lastPageElement = this.view.element(lastPageIndex);\n            const currentlyFocusedElement = this.getFocusedElements()[0];\n            if (currentlyFocusedElement !== lastPageElement) {\n                const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n                if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\n                    this.setFocus([lastGoodPageIndex], browserEvent);\n                }\n                else {\n                    this.setFocus([lastPageIndex], browserEvent);\n                }\n            }\n            else {\n                const previousScrollTop = this.view.getScrollTop();\n                this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\n                if (this.view.getScrollTop() !== previousScrollTop) {\n                    this.setFocus([]);\n                    // Let the scroll event listener run\n                    yield timeout(0);\n                    yield this.focusNextPage(browserEvent, filter);\n                }\n            }\n        });\n    }\n    focusPreviousPage(browserEvent, filter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let firstPageIndex;\n            const scrollTop = this.view.getScrollTop();\n            if (scrollTop === 0) {\n                firstPageIndex = this.view.indexAt(scrollTop);\n            }\n            else {\n                firstPageIndex = this.view.indexAfter(scrollTop - 1);\n            }\n            const firstPageElement = this.view.element(firstPageIndex);\n            const currentlyFocusedElement = this.getFocusedElements()[0];\n            if (currentlyFocusedElement !== firstPageElement) {\n                const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n                if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\n                    this.setFocus([firstGoodPageIndex], browserEvent);\n                }\n                else {\n                    this.setFocus([firstPageIndex], browserEvent);\n                }\n            }\n            else {\n                const previousScrollTop = scrollTop;\n                this.view.setScrollTop(scrollTop - this.view.renderHeight);\n                if (this.view.getScrollTop() !== previousScrollTop) {\n                    this.setFocus([]);\n                    // Let the scroll event listener run\n                    yield timeout(0);\n                    yield this.focusPreviousPage(browserEvent, filter);\n                }\n            }\n        });\n    }\n    focusLast(browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const index = this.findPreviousIndex(this.length - 1, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusFirst(browserEvent, filter) {\n        this.focusNth(0, browserEvent, filter);\n    }\n    focusNth(n, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const index = this.findNextIndex(n, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    findNextIndex(index, loop = false, filter) {\n        for (let i = 0; i < this.length; i++) {\n            if (index >= this.length && !loop) {\n                return -1;\n            }\n            index = index % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index++;\n        }\n        return -1;\n    }\n    findPreviousIndex(index, loop = false, filter) {\n        for (let i = 0; i < this.length; i++) {\n            if (index < 0 && !loop) {\n                return -1;\n            }\n            index = (this.length + (index % this.length)) % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index--;\n        }\n        return -1;\n    }\n    getFocus() {\n        return this.focus.get();\n    }\n    getFocusedElements() {\n        return this.getFocus().map(i => this.view.element(i));\n    }\n    reveal(index, relativeTop) {\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        const scrollTop = this.view.getScrollTop();\n        const elementTop = this.view.elementTop(index);\n        const elementHeight = this.view.elementHeight(index);\n        if (isNumber(relativeTop)) {\n            // y = mx + b\n            const m = elementHeight - this.view.renderHeight;\n            this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\n        }\n        else {\n            const viewItemBottom = elementTop + elementHeight;\n            const scrollBottom = scrollTop + this.view.renderHeight;\n            if (elementTop < scrollTop && viewItemBottom >= scrollBottom) {\n                // The element is already overflowing the viewport, no-op\n            }\n            else if (elementTop < scrollTop || (viewItemBottom >= scrollBottom && elementHeight >= this.view.renderHeight)) {\n                this.view.setScrollTop(elementTop);\n            }\n            else if (viewItemBottom >= scrollBottom) {\n                this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n            }\n        }\n    }\n    /**\n     * Returns the relative position of an element rendered in the list.\n     * Returns `null` if the element isn't *entirely* in the visible viewport.\n     */\n    getRelativeTop(index) {\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        const scrollTop = this.view.getScrollTop();\n        const elementTop = this.view.elementTop(index);\n        const elementHeight = this.view.elementHeight(index);\n        if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n            return null;\n        }\n        // y = mx + b\n        const m = elementHeight - this.view.renderHeight;\n        return Math.abs((scrollTop - elementTop) / m);\n    }\n    getHTMLElement() {\n        return this.view.domNode;\n    }\n    style(styles) {\n        this.styleController.style(styles);\n    }\n    toListEvent({ indexes, browserEvent }) {\n        return { indexes, elements: indexes.map(i => this.view.element(i)), browserEvent };\n    }\n    _onFocusChange() {\n        const focus = this.focus.get();\n        this.view.domNode.classList.toggle('element-focused', focus.length > 0);\n        this.onDidChangeActiveDescendant();\n    }\n    onDidChangeActiveDescendant() {\n        var _a;\n        const focus = this.focus.get();\n        if (focus.length > 0) {\n            let id;\n            if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\n                id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n            }\n            this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n        }\n        else {\n            this.view.domNode.removeAttribute('aria-activedescendant');\n        }\n    }\n    _onSelectionChange() {\n        const selection = this.selection.get();\n        this.view.domNode.classList.toggle('selection-none', selection.length === 0);\n        this.view.domNode.classList.toggle('selection-single', selection.length === 1);\n        this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\n    }\n    dispose() {\n        this._onDidDispose.fire();\n        this.disposables.dispose();\n        this._onDidDispose.dispose();\n    }\n}\n__decorate([\n    memoize\n], List.prototype, \"onDidChangeFocus\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidChangeSelection\", null);\n__decorate([\n    memoize\n], List.prototype, \"onContextMenu\", null);\n__decorate([\n    memoize\n], List.prototype, \"onKeyDown\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidFocus\", null);\n"]},"metadata":{},"sourceType":"module"}