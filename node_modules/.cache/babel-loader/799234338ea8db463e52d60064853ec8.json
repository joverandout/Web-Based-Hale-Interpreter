{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { InlineCompletionsModel, SynchronizedInlineCompletionsCache } from './inlineCompletionsModel.js';\nimport { SuggestWidgetPreviewModel } from './suggestWidgetPreviewModel.js';\nimport { createDisposableRef } from './utils.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nexport class DelegatingModel extends Disposable {\n  constructor() {\n    super(...arguments);\n    this.onDidChangeEmitter = new Emitter();\n    this.onDidChange = this.onDidChangeEmitter.event;\n    this.hasCachedGhostText = false;\n    this.currentModelRef = this._register(new MutableDisposable());\n  }\n\n  get targetModel() {\n    var _a;\n\n    return (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object;\n  }\n\n  setTargetModel(model) {\n    var _a;\n\n    if (((_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === model) {\n      return;\n    }\n\n    this.currentModelRef.clear();\n    this.currentModelRef.value = model ? createDisposableRef(model, model.onDidChange(() => {\n      this.hasCachedGhostText = false;\n      this.onDidChangeEmitter.fire();\n    })) : undefined;\n    this.hasCachedGhostText = false;\n    this.onDidChangeEmitter.fire();\n  }\n\n  get ghostText() {\n    var _a, _b;\n\n    if (!this.hasCachedGhostText) {\n      this.cachedGhostText = (_b = (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === null || _b === void 0 ? void 0 : _b.ghostText;\n      this.hasCachedGhostText = true;\n    }\n\n    return this.cachedGhostText;\n  }\n\n  setExpanded(expanded) {\n    var _a;\n\n    (_a = this.targetModel) === null || _a === void 0 ? void 0 : _a.setExpanded(expanded);\n  }\n\n  get minReservedLineCount() {\n    return this.targetModel ? this.targetModel.minReservedLineCount : 0;\n  }\n\n}\n/**\n * A ghost text model that is both driven by inline completions and the suggest widget.\n*/\n\nlet GhostTextModel = class GhostTextModel extends DelegatingModel {\n  constructor(editor, commandService, languageConfigurationService) {\n    super();\n    this.editor = editor;\n    this.commandService = commandService;\n    this.languageConfigurationService = languageConfigurationService;\n    this.sharedCache = this._register(new SharedInlineCompletionCache());\n    this.suggestWidgetAdapterModel = this._register(new SuggestWidgetPreviewModel(this.editor, this.sharedCache));\n    this.inlineCompletionsModel = this._register(new InlineCompletionsModel(this.editor, this.sharedCache, this.commandService, this.languageConfigurationService));\n\n    this._register(this.suggestWidgetAdapterModel.onDidChange(() => {\n      this.updateModel();\n    }));\n\n    this.updateModel();\n  }\n\n  get activeInlineCompletionsModel() {\n    if (this.targetModel === this.inlineCompletionsModel) {\n      return this.inlineCompletionsModel;\n    }\n\n    return undefined;\n  }\n\n  updateModel() {\n    this.setTargetModel(this.suggestWidgetAdapterModel.isActive ? this.suggestWidgetAdapterModel : this.inlineCompletionsModel);\n    this.inlineCompletionsModel.setActive(this.targetModel === this.inlineCompletionsModel);\n  }\n\n  shouldShowHoverAt(hoverRange) {\n    var _a;\n\n    const ghostText = (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.ghostText;\n\n    if (ghostText) {\n      return ghostText.parts.some(p => hoverRange.containsPosition(new Position(ghostText.lineNumber, p.column)));\n    }\n\n    return false;\n  }\n\n  triggerInlineCompletion() {\n    var _a;\n\n    (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.trigger(InlineCompletionTriggerKind.Explicit);\n  }\n\n  commitInlineCompletion() {\n    var _a;\n\n    (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.commitCurrentSuggestion();\n  }\n\n  hideInlineCompletion() {\n    var _a;\n\n    (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hide();\n  }\n\n  showNextInlineCompletion() {\n    var _a;\n\n    (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showNext();\n  }\n\n  showPreviousInlineCompletion() {\n    var _a;\n\n    (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showPrevious();\n  }\n\n  hasMultipleInlineCompletions() {\n    var _a;\n\n    return __awaiter(this, void 0, void 0, function* () {\n      const result = yield (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions();\n      return result !== undefined ? result : false;\n    });\n  }\n\n};\nGhostTextModel = __decorate([__param(1, ICommandService), __param(2, ILanguageConfigurationService)], GhostTextModel);\nexport { GhostTextModel };\nexport class SharedInlineCompletionCache extends Disposable {\n  constructor() {\n    super(...arguments);\n    this.onDidChangeEmitter = new Emitter();\n    this.onDidChange = this.onDidChangeEmitter.event;\n    this.cache = this._register(new MutableDisposable());\n  }\n\n  get value() {\n    return this.cache.value;\n  }\n\n  setValue(editor, completionsSource, triggerKind) {\n    this.cache.value = new SynchronizedInlineCompletionsCache(editor, completionsSource, () => this.onDidChangeEmitter.fire(), triggerKind);\n  }\n\n  clearAndLeak() {\n    return this.cache.clearAndLeak();\n  }\n\n  clear() {\n    this.cache.clear();\n  }\n\n}","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostTextModel.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Emitter","Disposable","MutableDisposable","Position","InlineCompletionTriggerKind","ILanguageConfigurationService","InlineCompletionsModel","SynchronizedInlineCompletionsCache","SuggestWidgetPreviewModel","createDisposableRef","ICommandService","DelegatingModel","constructor","onDidChangeEmitter","onDidChange","event","hasCachedGhostText","currentModelRef","_register","targetModel","_a","object","setTargetModel","model","clear","fire","undefined","ghostText","_b","cachedGhostText","setExpanded","expanded","minReservedLineCount","GhostTextModel","editor","commandService","languageConfigurationService","sharedCache","SharedInlineCompletionCache","suggestWidgetAdapterModel","inlineCompletionsModel","updateModel","activeInlineCompletionsModel","isActive","setActive","shouldShowHoverAt","hoverRange","parts","some","p","containsPosition","lineNumber","column","triggerInlineCompletion","trigger","Explicit","commitInlineCompletion","commitCurrentSuggestion","hideInlineCompletion","hide","showNextInlineCompletion","showNext","showPreviousInlineCompletion","showPrevious","hasMultipleInlineCompletions","cache","setValue","completionsSource","triggerKind","clearAndLeak"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { InlineCompletionsModel, SynchronizedInlineCompletionsCache } from './inlineCompletionsModel.js';\nimport { SuggestWidgetPreviewModel } from './suggestWidgetPreviewModel.js';\nimport { createDisposableRef } from './utils.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nexport class DelegatingModel extends Disposable {\n    constructor() {\n        super(...arguments);\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        this.hasCachedGhostText = false;\n        this.currentModelRef = this._register(new MutableDisposable());\n    }\n    get targetModel() {\n        var _a;\n        return (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object;\n    }\n    setTargetModel(model) {\n        var _a;\n        if (((_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === model) {\n            return;\n        }\n        this.currentModelRef.clear();\n        this.currentModelRef.value = model ? createDisposableRef(model, model.onDidChange(() => {\n            this.hasCachedGhostText = false;\n            this.onDidChangeEmitter.fire();\n        })) : undefined;\n        this.hasCachedGhostText = false;\n        this.onDidChangeEmitter.fire();\n    }\n    get ghostText() {\n        var _a, _b;\n        if (!this.hasCachedGhostText) {\n            this.cachedGhostText = (_b = (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === null || _b === void 0 ? void 0 : _b.ghostText;\n            this.hasCachedGhostText = true;\n        }\n        return this.cachedGhostText;\n    }\n    setExpanded(expanded) {\n        var _a;\n        (_a = this.targetModel) === null || _a === void 0 ? void 0 : _a.setExpanded(expanded);\n    }\n    get minReservedLineCount() {\n        return this.targetModel ? this.targetModel.minReservedLineCount : 0;\n    }\n}\n/**\n * A ghost text model that is both driven by inline completions and the suggest widget.\n*/\nlet GhostTextModel = class GhostTextModel extends DelegatingModel {\n    constructor(editor, commandService, languageConfigurationService) {\n        super();\n        this.editor = editor;\n        this.commandService = commandService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.sharedCache = this._register(new SharedInlineCompletionCache());\n        this.suggestWidgetAdapterModel = this._register(new SuggestWidgetPreviewModel(this.editor, this.sharedCache));\n        this.inlineCompletionsModel = this._register(new InlineCompletionsModel(this.editor, this.sharedCache, this.commandService, this.languageConfigurationService));\n        this._register(this.suggestWidgetAdapterModel.onDidChange(() => {\n            this.updateModel();\n        }));\n        this.updateModel();\n    }\n    get activeInlineCompletionsModel() {\n        if (this.targetModel === this.inlineCompletionsModel) {\n            return this.inlineCompletionsModel;\n        }\n        return undefined;\n    }\n    updateModel() {\n        this.setTargetModel(this.suggestWidgetAdapterModel.isActive\n            ? this.suggestWidgetAdapterModel\n            : this.inlineCompletionsModel);\n        this.inlineCompletionsModel.setActive(this.targetModel === this.inlineCompletionsModel);\n    }\n    shouldShowHoverAt(hoverRange) {\n        var _a;\n        const ghostText = (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.ghostText;\n        if (ghostText) {\n            return ghostText.parts.some(p => hoverRange.containsPosition(new Position(ghostText.lineNumber, p.column)));\n        }\n        return false;\n    }\n    triggerInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.trigger(InlineCompletionTriggerKind.Explicit);\n    }\n    commitInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.commitCurrentSuggestion();\n    }\n    hideInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hide();\n    }\n    showNextInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showNext();\n    }\n    showPreviousInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showPrevious();\n    }\n    hasMultipleInlineCompletions() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield ((_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\n            return result !== undefined ? result : false;\n        });\n    }\n};\nGhostTextModel = __decorate([\n    __param(1, ICommandService),\n    __param(2, ILanguageConfigurationService)\n], GhostTextModel);\nexport { GhostTextModel };\nexport class SharedInlineCompletionCache extends Disposable {\n    constructor() {\n        super(...arguments);\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        this.cache = this._register(new MutableDisposable());\n    }\n    get value() {\n        return this.cache.value;\n    }\n    setValue(editor, completionsSource, triggerKind) {\n        this.cache.value = new SynchronizedInlineCompletionsCache(editor, completionsSource, () => this.onDidChangeEmitter.fire(), triggerKind);\n    }\n    clearAndLeak() {\n        return this.cache.clearAndLeak();\n    }\n    clear() {\n        this.cache.clear();\n    }\n}\n"]},"metadata":{},"sourceType":"module"}