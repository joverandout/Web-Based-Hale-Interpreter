{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n  constructor(marker, index, total) {\n    this.marker = marker;\n    this.index = index;\n    this.total = total;\n  }\n\n}\nlet MarkerList = class MarkerList {\n  constructor(resourceFilter, _markerService, _configService) {\n    this._markerService = _markerService;\n    this._configService = _configService;\n    this._onDidChange = new Emitter();\n    this.onDidChange = this._onDidChange.event;\n    this._dispoables = new DisposableStore();\n    this._markers = [];\n    this._nextIdx = -1;\n\n    if (URI.isUri(resourceFilter)) {\n      this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n    } else if (resourceFilter) {\n      this._resourceFilter = resourceFilter;\n    }\n\n    const compareOrder = this._configService.getValue('problems.sortOrder');\n\n    const compareMarker = (a, b) => {\n      let res = compare(a.resource.toString(), b.resource.toString());\n\n      if (compareOrder === 'position') {\n        res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n      } else {\n        res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n      }\n\n      return res;\n    };\n\n    const updateMarker = () => {\n      this._markers = this._markerService.read({\n        resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n        severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n      });\n\n      if (typeof resourceFilter === 'function') {\n        this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n      }\n\n      this._markers.sort(compareMarker);\n    };\n\n    updateMarker();\n\n    this._dispoables.add(_markerService.onMarkerChanged(uris => {\n      if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n        updateMarker();\n        this._nextIdx = -1;\n\n        this._onDidChange.fire();\n      }\n    }));\n  }\n\n  dispose() {\n    this._dispoables.dispose();\n\n    this._onDidChange.dispose();\n  }\n\n  matches(uri) {\n    if (!this._resourceFilter && !uri) {\n      return true;\n    }\n\n    if (!this._resourceFilter || !uri) {\n      return false;\n    }\n\n    return this._resourceFilter(uri);\n  }\n\n  get selected() {\n    const marker = this._markers[this._nextIdx];\n    return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n  }\n\n  _initIdx(model, position, fwd) {\n    let found = false;\n\n    let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n\n    if (idx < 0) {\n      idx = binarySearch(this._markers, {\n        resource: model.uri\n      }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n\n      if (idx < 0) {\n        idx = ~idx;\n      }\n    }\n\n    for (let i = idx; i < this._markers.length; i++) {\n      let range = Range.lift(this._markers[i]);\n\n      if (range.isEmpty()) {\n        const word = model.getWordAtPosition(range.getStartPosition());\n\n        if (word) {\n          range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n        }\n      }\n\n      if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n        this._nextIdx = i;\n        found = true;\n        break;\n      }\n\n      if (this._markers[i].resource.toString() !== model.uri.toString()) {\n        break;\n      }\n    }\n\n    if (!found) {\n      // after the last change\n      this._nextIdx = fwd ? 0 : this._markers.length - 1;\n    }\n\n    if (this._nextIdx < 0) {\n      this._nextIdx = this._markers.length - 1;\n    }\n  }\n\n  resetIndex() {\n    this._nextIdx = -1;\n  }\n\n  move(fwd, model, position) {\n    if (this._markers.length === 0) {\n      return false;\n    }\n\n    let oldIdx = this._nextIdx;\n\n    if (this._nextIdx === -1) {\n      this._initIdx(model, position, fwd);\n    } else if (fwd) {\n      this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n    } else if (!fwd) {\n      this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n    }\n\n    if (oldIdx !== this._nextIdx) {\n      return true;\n    }\n\n    return false;\n  }\n\n  find(uri, position) {\n    let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n\n    if (idx < 0) {\n      return undefined;\n    }\n\n    for (; idx < this._markers.length; idx++) {\n      if (Range.containsPosition(this._markers[idx], position)) {\n        return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n      }\n    }\n\n    return undefined;\n  }\n\n};\nMarkerList = __decorate([__param(1, IMarkerService), __param(2, IConfigurationService)], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n  constructor(_markerService, _configService) {\n    this._markerService = _markerService;\n    this._configService = _configService;\n    this._provider = new LinkedList();\n  }\n\n  getMarkerList(resource) {\n    for (let provider of this._provider) {\n      const result = provider.getMarkerList(resource);\n\n      if (result) {\n        return result;\n      }\n    } // default\n\n\n    return new MarkerList(resource, this._markerService, this._configService);\n  }\n\n};\nMarkerNavigationService = __decorate([__param(0, IMarkerService), __param(1, IConfigurationService)], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","binarySearch","Emitter","DisposableStore","LinkedList","compare","URI","Range","registerSingleton","createDecorator","IMarkerService","MarkerSeverity","IConfigurationService","MarkerCoordinate","constructor","marker","index","total","MarkerList","resourceFilter","_markerService","_configService","_onDidChange","onDidChange","event","_dispoables","_markers","_nextIdx","isUri","_resourceFilter","uri","toString","compareOrder","getValue","compareMarker","a","b","res","resource","compareRangesUsingStarts","severity","updateMarker","read","undefined","severities","Error","Warning","Info","filter","m","sort","add","onMarkerChanged","uris","some","fire","dispose","matches","selected","_initIdx","model","position","fwd","found","idx","findIndex","range","lift","isEmpty","word","getWordAtPosition","getStartPosition","startLineNumber","startColumn","endColumn","containsPosition","isBeforeOrEqual","resetIndex","move","oldIdx","find","IMarkerNavigationService","MarkerNavigationService","_provider","getMarkerList","provider","result"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (compareOrder === 'position') {\n                res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n            }\n            else {\n                res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        let oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (let provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);\n"]},"metadata":{},"sourceType":"module"}