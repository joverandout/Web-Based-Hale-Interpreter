{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n  constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n    this._editorService = _editorService;\n    this._notificationService = _notificationService;\n    this._keybindingService = _keybindingService;\n    this._currentModel = undefined;\n    this._currentIdx = -1;\n    this._ignoreEditorChange = false;\n    this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n  }\n\n  reset() {\n    var _a, _b;\n\n    this._ctxHasSymbols.reset();\n\n    (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n    (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n    this._currentModel = undefined;\n    this._currentIdx = -1;\n  }\n\n  put(anchor) {\n    const refModel = anchor.parent.parent;\n\n    if (refModel.references.length <= 1) {\n      this.reset();\n      return;\n    }\n\n    this._currentModel = refModel;\n    this._currentIdx = refModel.references.indexOf(anchor);\n\n    this._ctxHasSymbols.set(true);\n\n    this._showMessage();\n\n    const editorState = new EditorState(this._editorService);\n    const listener = editorState.onDidChange(_ => {\n      if (this._ignoreEditorChange) {\n        return;\n      }\n\n      const editor = this._editorService.getActiveCodeEditor();\n\n      if (!editor) {\n        return;\n      }\n\n      const model = editor.getModel();\n      const position = editor.getPosition();\n\n      if (!model || !position) {\n        return;\n      }\n\n      let seenUri = false;\n      let seenPosition = false;\n\n      for (const reference of refModel.references) {\n        if (isEqual(reference.uri, model.uri)) {\n          seenUri = true;\n          seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n        } else if (seenUri) {\n          break;\n        }\n      }\n\n      if (!seenUri || !seenPosition) {\n        this.reset();\n      }\n    });\n    this._currentState = combinedDisposable(editorState, listener);\n  }\n\n  revealNext(source) {\n    if (!this._currentModel) {\n      return Promise.resolve();\n    } // get next result and advance\n\n\n    this._currentIdx += 1;\n    this._currentIdx %= this._currentModel.references.length;\n    const reference = this._currentModel.references[this._currentIdx]; // status\n\n    this._showMessage(); // open editor, ignore events while that happens\n\n\n    this._ignoreEditorChange = true;\n    return this._editorService.openCodeEditor({\n      resource: reference.uri,\n      options: {\n        selection: Range.collapseToStart(reference.range),\n        selectionRevealType: 3\n        /* NearTopIfOutsideViewport */\n\n      }\n    }, source).finally(() => {\n      this._ignoreEditorChange = false;\n    });\n  }\n\n  _showMessage() {\n    var _a;\n\n    (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n\n    const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n\n    const message = kb ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel()) : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n    this._currentMessage = this._notificationService.status(message);\n  }\n\n};\nSymbolNavigationService = __decorate([__param(0, IContextKeyService), __param(1, ICodeEditorService), __param(2, INotificationService), __param(3, IKeybindingService)], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\nregisterEditorCommand(new class extends EditorCommand {\n  constructor() {\n    super({\n      id: 'editor.gotoNextSymbolFromResult',\n      precondition: ctxHasSymbols,\n      kbOpts: {\n        weight: 100\n        /* EditorContrib */\n        ,\n        primary: 70\n        /* F12 */\n\n      }\n    });\n  }\n\n  runEditorCommand(accessor, editor) {\n    return accessor.get(ISymbolNavigationService).revealNext(editor);\n  }\n\n}());\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n  id: 'editor.gotoNextSymbolFromResult.cancel',\n  weight: 100\n  /* EditorContrib */\n  ,\n  when: ctxHasSymbols,\n  primary: 9\n  /* Escape */\n  ,\n\n  handler(accessor) {\n    accessor.get(ISymbolNavigationService).reset();\n  }\n\n}); //\n\nlet EditorState = class EditorState {\n  constructor(editorService) {\n    this._listener = new Map();\n    this._disposables = new DisposableStore();\n    this._onDidChange = new Emitter();\n    this.onDidChange = this._onDidChange.event;\n\n    this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n\n    this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n\n    editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n  }\n\n  dispose() {\n    this._disposables.dispose();\n\n    this._onDidChange.dispose();\n\n    dispose(this._listener.values());\n  }\n\n  _onDidAddEditor(editor) {\n    this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({\n      editor\n    })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({\n      editor\n    }))));\n  }\n\n  _onDidRemoveEditor(editor) {\n    var _a;\n\n    (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n\n    this._listener.delete(editor);\n  }\n\n};\nEditorState = __decorate([__param(0, ICodeEditorService)], EditorState);","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","Emitter","combinedDisposable","DisposableStore","dispose","isEqual","EditorCommand","registerEditorCommand","ICodeEditorService","Range","localize","IContextKeyService","RawContextKey","registerSingleton","createDecorator","IKeybindingService","KeybindingsRegistry","INotificationService","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","constructor","contextKeyService","_editorService","_notificationService","_keybindingService","_currentModel","undefined","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","bindTo","reset","_a","_b","_currentState","_currentMessage","put","anchor","refModel","parent","references","indexOf","set","_showMessage","editorState","EditorState","listener","onDidChange","_","editor","getActiveCodeEditor","model","getModel","position","getPosition","seenUri","seenPosition","reference","uri","containsPosition","range","revealNext","source","Promise","resolve","openCodeEditor","resource","options","selection","collapseToStart","selectionRevealType","finally","kb","lookupKeybinding","message","getLabel","status","id","precondition","kbOpts","weight","primary","runEditorCommand","accessor","get","registerCommandAndKeybindingRule","when","handler","editorService","_listener","Map","_disposables","_onDidChange","event","add","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","onDidChangeCursorPosition","fire","onDidChangeModelContent","delete"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* EditorContrib */,\n                primary: 70 /* F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n"]},"metadata":{},"sourceType":"module"}