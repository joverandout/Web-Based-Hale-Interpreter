{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\n\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\n\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { attachListStyler } from '../../../../platform/theme/common/styler.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from './resizable.js';\nimport { Context as SuggestContext } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\n/**\n * Suggest widget colors\n */\n\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', {\n  dark: editorWidgetBackground,\n  light: editorWidgetBackground,\n  hc: editorWidgetBackground\n}, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', {\n  dark: editorWidgetBorder,\n  light: editorWidgetBorder,\n  hc: editorWidgetBorder\n}, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', {\n  dark: editorForeground,\n  light: editorForeground,\n  hc: editorForeground\n}, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexport const editorSuggestWidgetSelectedForeground = registerColor('editorSuggestWidget.selectedForeground', {\n  dark: quickInputListFocusForeground,\n  light: quickInputListFocusForeground,\n  hc: quickInputListFocusForeground\n}, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedIconForeground = registerColor('editorSuggestWidget.selectedIconForeground', {\n  dark: quickInputListFocusIconForeground,\n  light: quickInputListFocusIconForeground,\n  hc: quickInputListFocusIconForeground\n}, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', {\n  dark: quickInputListFocusBackground,\n  light: quickInputListFocusBackground,\n  hc: quickInputListFocusBackground\n}, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', {\n  dark: listHighlightForeground,\n  light: listHighlightForeground,\n  hc: listHighlightForeground\n}, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nexport const editorSuggestWidgetHighlightFocusForeground = registerColor('editorSuggestWidget.focusHighlightForeground', {\n  dark: listFocusHighlightForeground,\n  light: listFocusHighlightForeground,\n  hc: listFocusHighlightForeground\n}, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nexport const editorSuggestWidgetStatusForeground = registerColor('editorSuggestWidgetStatus.foreground', {\n  dark: transparent(editorSuggestWidgetForeground, .5),\n  light: transparent(editorSuggestWidgetForeground, .5),\n  hc: transparent(editorSuggestWidgetForeground, .5)\n}, nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\n\nclass PersistedWidgetSize {\n  constructor(_service, editor) {\n    this._service = _service;\n    this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n  }\n\n  restore() {\n    var _a;\n\n    const raw = (_a = this._service.get(this._key, 0\n    /* GLOBAL */\n    )) !== null && _a !== void 0 ? _a : '';\n\n    try {\n      const obj = JSON.parse(raw);\n\n      if (dom.Dimension.is(obj)) {\n        return dom.Dimension.lift(obj);\n      }\n    } catch (_b) {// ignore\n    }\n\n    return undefined;\n  }\n\n  store(size) {\n    this._service.store(this._key, JSON.stringify(size), 0\n    /* GLOBAL */\n    , 1\n    /* MACHINE */\n    );\n  }\n\n  reset() {\n    this._service.remove(this._key, 0\n    /* GLOBAL */\n    );\n  }\n\n}\n\nlet SuggestWidget = class SuggestWidget {\n  constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n    this.editor = editor;\n    this._storageService = _storageService;\n    this._state = 0\n    /* Hidden */\n    ;\n    this._isAuto = false;\n    this._ignoreFocusEvents = false;\n    this._forceRenderingAbove = false;\n    this._explainMode = false;\n    this._showTimeout = new TimeoutTimer();\n    this._disposables = new DisposableStore();\n    this._onDidSelect = new Emitter();\n    this._onDidFocus = new Emitter();\n    this._onDidHide = new Emitter();\n    this._onDidShow = new Emitter();\n    this.onDidSelect = this._onDidSelect.event;\n    this.onDidFocus = this._onDidFocus.event;\n    this.onDidHide = this._onDidHide.event;\n    this.onDidShow = this._onDidShow.event;\n    this._onDetailsKeydown = new Emitter();\n    this.onDetailsKeyDown = this._onDetailsKeydown.event;\n    this.element = new ResizableHTMLElement();\n    this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n    this._contentWidget = new SuggestContentWidget(this, editor);\n    this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n\n    class ResizeState {\n      constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n        this.persistedSize = persistedSize;\n        this.currentSize = currentSize;\n        this.persistHeight = persistHeight;\n        this.persistWidth = persistWidth;\n      }\n\n    }\n\n    let state;\n\n    this._disposables.add(this.element.onDidWillResize(() => {\n      this._contentWidget.lockPreference();\n\n      state = new ResizeState(this._persistedSize.restore(), this.element.size);\n    }));\n\n    this._disposables.add(this.element.onDidResize(e => {\n      var _a, _b, _c, _d;\n\n      this._resize(e.dimension.width, e.dimension.height);\n\n      if (state) {\n        state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n        state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n      }\n\n      if (!e.done) {\n        return;\n      }\n\n      if (state) {\n        // only store width or height value that have changed and also\n        // only store changes that are above a certain threshold\n        const {\n          itemHeight,\n          defaultSize\n        } = this.getLayoutInfo();\n        const threshold = Math.round(itemHeight / 2);\n        let {\n          width,\n          height\n        } = this.element.size;\n\n        if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n          height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n        }\n\n        if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n          width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n        }\n\n        this._persistedSize.store(new dom.Dimension(width, height));\n      } // reset working state\n\n\n      this._contentWidget.unlockPreference();\n\n      state = undefined;\n    }));\n\n    this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n    this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n    const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\n    details.onDidClose(this.toggleDetails, this, this._disposables);\n    this._details = new SuggestDetailsOverlay(details, this.editor);\n\n    const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(106\n    /* suggest */\n    ).showIcons);\n\n    applyIconStyle();\n    const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n\n    this._disposables.add(renderer);\n\n    this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n\n    this._list = new List('SuggestWidget', this._listElement, {\n      getHeight: _element => this.getLayoutInfo().itemHeight,\n      getTemplateId: _element => 'suggestion'\n    }, [renderer], {\n      alwaysConsumeMouseWheel: true,\n      useShadows: false,\n      mouseSupport: false,\n      accessibilityProvider: {\n        getRole: () => 'option',\n        getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n        getWidgetRole: () => 'listbox',\n        getAriaLabel: item => {\n          let label = item.textLabel;\n\n          if (typeof item.completion.label !== 'string') {\n            const {\n              detail,\n              description\n            } = item.completion.label;\n\n            if (detail && description) {\n              label = nls.localize('label.full', '{0}{1}, {2}', label, detail, description);\n            } else if (detail) {\n              label = nls.localize('label.detail', '{0}{1}', label, detail);\n            } else if (description) {\n              label = nls.localize('label.desc', '{0}, {1}', label, description);\n            }\n          }\n\n          if (!item.isResolved || !this._isDetailsVisible()) {\n            return label;\n          }\n\n          const {\n            documentation,\n            detail\n          } = item.completion;\n          const docs = strings.format('{0}{1}', detail || '', documentation ? typeof documentation === 'string' ? documentation : documentation.value : '');\n          return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n        }\n      }\n    });\n    this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\n\n    const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(106\n    /* suggest */\n    ).showStatusBar);\n\n    applyStatusBarStyle();\n\n    this._disposables.add(attachListStyler(this._list, _themeService, {\n      listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n      listInactiveFocusOutline: activeContrastBorder\n    }));\n\n    this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n\n    this._onThemeChange(_themeService.getColorTheme());\n\n    this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n\n    this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n\n    this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n\n    this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n\n    this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n\n    this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(106\n      /* suggest */\n      )) {\n        applyStatusBarStyle();\n        applyIconStyle();\n      }\n    }));\n\n    this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n    this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n    this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n\n    this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n      this._onDetailsKeydown.fire(e);\n    }));\n\n    this._disposables.add(this.editor.onMouseDown(e => this._onEditorMouseDown(e)));\n  }\n\n  dispose() {\n    var _a;\n\n    this._details.widget.dispose();\n\n    this._details.dispose();\n\n    this._list.dispose();\n\n    this._status.dispose();\n\n    this._disposables.dispose();\n\n    (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n\n    this._showTimeout.dispose();\n\n    this._contentWidget.dispose();\n\n    this.element.dispose();\n  }\n\n  _onEditorMouseDown(mouseEvent) {\n    if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n      // Clicking inside details\n      this._details.widget.domNode.focus();\n    } else {\n      // Clicking outside details and inside suggest\n      if (this.element.domNode.contains(mouseEvent.target.element)) {\n        this.editor.focus();\n      }\n    }\n  }\n\n  _onCursorSelectionChanged() {\n    if (this._state !== 0\n    /* Hidden */\n    ) {\n      this._contentWidget.layout();\n    }\n  }\n\n  _onListMouseDownOrTap(e) {\n    if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n      return;\n    } // prevent stealing browser focus from the editor\n\n\n    e.browserEvent.preventDefault();\n    e.browserEvent.stopPropagation();\n\n    this._select(e.element, e.index);\n  }\n\n  _onListSelection(e) {\n    if (e.elements.length) {\n      this._select(e.elements[0], e.indexes[0]);\n    }\n  }\n\n  _select(item, index) {\n    const completionModel = this._completionModel;\n\n    if (completionModel) {\n      this._onDidSelect.fire({\n        item,\n        index,\n        model: completionModel\n      });\n\n      this.editor.focus();\n    }\n  }\n\n  _onThemeChange(theme) {\n    this._details.widget.borderWidth = theme.type === 'hc' ? 2 : 1;\n  }\n\n  _onListFocus(e) {\n    var _a;\n\n    if (this._ignoreFocusEvents) {\n      return;\n    }\n\n    if (!e.elements.length) {\n      if (this._currentSuggestionDetails) {\n        this._currentSuggestionDetails.cancel();\n\n        this._currentSuggestionDetails = undefined;\n        this._focusedItem = undefined;\n      }\n\n      this.editor.setAriaOptions({\n        activeDescendant: undefined\n      });\n      return;\n    }\n\n    if (!this._completionModel) {\n      return;\n    }\n\n    const item = e.elements[0];\n    const index = e.indexes[0];\n\n    if (item !== this._focusedItem) {\n      (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n      this._currentSuggestionDetails = undefined;\n      this._focusedItem = item;\n\n      this._list.reveal(index);\n\n      this._currentSuggestionDetails = createCancelablePromise(token => __awaiter(this, void 0, void 0, function* () {\n        const loading = disposableTimeout(() => {\n          if (this._isDetailsVisible()) {\n            this.showDetails(true);\n          }\n        }, 250);\n        token.onCancellationRequested(() => loading.dispose());\n        const result = yield item.resolve(token);\n        loading.dispose();\n        return result;\n      }));\n\n      this._currentSuggestionDetails.then(() => {\n        if (index >= this._list.length || item !== this._list.element(index)) {\n          return;\n        } // item can have extra information, so re-render\n\n\n        this._ignoreFocusEvents = true;\n\n        this._list.splice(index, 1, [item]);\n\n        this._list.setFocus([index]);\n\n        this._ignoreFocusEvents = false;\n\n        if (this._isDetailsVisible()) {\n          this.showDetails(false);\n        } else {\n          this.element.domNode.classList.remove('docs-side');\n        }\n\n        this.editor.setAriaOptions({\n          activeDescendant: getAriaId(index)\n        });\n      }).catch(onUnexpectedError);\n    } // emit an event\n\n\n    this._onDidFocus.fire({\n      item,\n      index,\n      model: this._completionModel\n    });\n  }\n\n  _setState(state) {\n    if (this._state === state) {\n      return;\n    }\n\n    this._state = state;\n    this.element.domNode.classList.toggle('frozen', state === 4\n    /* Frozen */\n    );\n    this.element.domNode.classList.remove('message');\n\n    switch (state) {\n      case 0\n      /* Hidden */\n      :\n        dom.hide(this._messageElement, this._listElement, this._status.element);\n\n        this._details.hide(true);\n\n        this._status.hide();\n\n        this._contentWidget.hide();\n\n        this._ctxSuggestWidgetVisible.reset();\n\n        this._ctxSuggestWidgetMultipleSuggestions.reset();\n\n        this._showTimeout.cancel();\n\n        this.element.domNode.classList.remove('visible');\n\n        this._list.splice(0, this._list.length);\n\n        this._focusedItem = undefined;\n        this._cappedHeight = undefined;\n        this._explainMode = false;\n        break;\n\n      case 1\n      /* Loading */\n      :\n        this.element.domNode.classList.add('message');\n        this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n        dom.hide(this._listElement, this._status.element);\n        dom.show(this._messageElement);\n\n        this._details.hide();\n\n        this._show();\n\n        this._focusedItem = undefined;\n        break;\n\n      case 2\n      /* Empty */\n      :\n        this.element.domNode.classList.add('message');\n        this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n        dom.hide(this._listElement, this._status.element);\n        dom.show(this._messageElement);\n\n        this._details.hide();\n\n        this._show();\n\n        this._focusedItem = undefined;\n        break;\n\n      case 3\n      /* Open */\n      :\n        dom.hide(this._messageElement);\n        dom.show(this._listElement, this._status.element);\n\n        this._show();\n\n        break;\n\n      case 4\n      /* Frozen */\n      :\n        dom.hide(this._messageElement);\n        dom.show(this._listElement, this._status.element);\n\n        this._show();\n\n        break;\n\n      case 5\n      /* Details */\n      :\n        dom.hide(this._messageElement);\n        dom.show(this._listElement, this._status.element);\n\n        this._details.show();\n\n        this._show();\n\n        break;\n    }\n  }\n\n  _show() {\n    this._status.show();\n\n    this._contentWidget.show();\n\n    this._layout(this._persistedSize.restore());\n\n    this._ctxSuggestWidgetVisible.set(true);\n\n    this._showTimeout.cancelAndSet(() => {\n      this.element.domNode.classList.add('visible');\n\n      this._onDidShow.fire(this);\n    }, 100);\n  }\n\n  showTriggered(auto, delay) {\n    if (this._state !== 0\n    /* Hidden */\n    ) {\n      return;\n    }\n\n    this._contentWidget.setPosition(this.editor.getPosition());\n\n    this._isAuto = !!auto;\n\n    if (!this._isAuto) {\n      this._loadingTimeout = disposableTimeout(() => this._setState(1\n      /* Loading */\n      ), delay);\n    }\n  }\n\n  showSuggestions(completionModel, selectionIndex, isFrozen, isAuto) {\n    var _a, _b;\n\n    this._contentWidget.setPosition(this.editor.getPosition());\n\n    (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n    (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n    this._currentSuggestionDetails = undefined;\n\n    if (this._completionModel !== completionModel) {\n      this._completionModel = completionModel;\n    }\n\n    if (isFrozen && this._state !== 2\n    /* Empty */\n    && this._state !== 0\n    /* Hidden */\n    ) {\n      this._setState(4\n      /* Frozen */\n      );\n\n      return;\n    }\n\n    const visibleCount = this._completionModel.items.length;\n    const isEmpty = visibleCount === 0;\n\n    this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n\n    if (isEmpty) {\n      this._setState(isAuto ? 0\n      /* Hidden */\n      : 2\n      /* Empty */\n      );\n\n      this._completionModel = undefined;\n      return;\n    }\n\n    this._focusedItem = undefined;\n\n    this._list.splice(0, this._list.length, this._completionModel.items);\n\n    this._setState(isFrozen ? 4\n    /* Frozen */\n    : 3\n    /* Open */\n    );\n\n    this._list.reveal(selectionIndex, 0);\n\n    this._list.setFocus([selectionIndex]);\n\n    this._layout(this.element.size); // Reset focus border\n\n\n    this._details.widget.domNode.classList.remove('focused');\n  }\n\n  selectNextPage() {\n    switch (this._state) {\n      case 0\n      /* Hidden */\n      :\n        return false;\n\n      case 5\n      /* Details */\n      :\n        this._details.widget.pageDown();\n\n        return true;\n\n      case 1\n      /* Loading */\n      :\n        return !this._isAuto;\n\n      default:\n        this._list.focusNextPage();\n\n        return true;\n    }\n  }\n\n  selectNext() {\n    switch (this._state) {\n      case 0\n      /* Hidden */\n      :\n        return false;\n\n      case 1\n      /* Loading */\n      :\n        return !this._isAuto;\n\n      default:\n        this._list.focusNext(1, true);\n\n        return true;\n    }\n  }\n\n  selectLast() {\n    switch (this._state) {\n      case 0\n      /* Hidden */\n      :\n        return false;\n\n      case 5\n      /* Details */\n      :\n        this._details.widget.scrollBottom();\n\n        return true;\n\n      case 1\n      /* Loading */\n      :\n        return !this._isAuto;\n\n      default:\n        this._list.focusLast();\n\n        return true;\n    }\n  }\n\n  selectPreviousPage() {\n    switch (this._state) {\n      case 0\n      /* Hidden */\n      :\n        return false;\n\n      case 5\n      /* Details */\n      :\n        this._details.widget.pageUp();\n\n        return true;\n\n      case 1\n      /* Loading */\n      :\n        return !this._isAuto;\n\n      default:\n        this._list.focusPreviousPage();\n\n        return true;\n    }\n  }\n\n  selectPrevious() {\n    switch (this._state) {\n      case 0\n      /* Hidden */\n      :\n        return false;\n\n      case 1\n      /* Loading */\n      :\n        return !this._isAuto;\n\n      default:\n        this._list.focusPrevious(1, true);\n\n        return false;\n    }\n  }\n\n  selectFirst() {\n    switch (this._state) {\n      case 0\n      /* Hidden */\n      :\n        return false;\n\n      case 5\n      /* Details */\n      :\n        this._details.widget.scrollTop();\n\n        return true;\n\n      case 1\n      /* Loading */\n      :\n        return !this._isAuto;\n\n      default:\n        this._list.focusFirst();\n\n        return true;\n    }\n  }\n\n  getFocusedItem() {\n    if (this._state !== 0\n    /* Hidden */\n    && this._state !== 2\n    /* Empty */\n    && this._state !== 1\n    /* Loading */\n    && this._completionModel) {\n      return {\n        item: this._list.getFocusedElements()[0],\n        index: this._list.getFocus()[0],\n        model: this._completionModel\n      };\n    }\n\n    return undefined;\n  }\n\n  toggleDetailsFocus() {\n    if (this._state === 5\n    /* Details */\n    ) {\n      this._setState(3\n      /* Open */\n      );\n\n      this._details.widget.domNode.classList.remove('focused');\n    } else if (this._state === 3\n    /* Open */\n    && this._isDetailsVisible()) {\n      this._setState(5\n      /* Details */\n      );\n\n      this._details.widget.domNode.classList.add('focused');\n    }\n  }\n\n  toggleDetails() {\n    if (this._isDetailsVisible()) {\n      // hide details widget\n      this._ctxSuggestWidgetDetailsVisible.set(false);\n\n      this._setDetailsVisible(false);\n\n      this._details.hide();\n\n      this.element.domNode.classList.remove('shows-details');\n    } else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3\n    /* Open */\n    || this._state === 5\n    /* Details */\n    || this._state === 4\n    /* Frozen */\n    )) {\n      // show details widget (iff possible)\n      this._ctxSuggestWidgetDetailsVisible.set(true);\n\n      this._setDetailsVisible(true);\n\n      this.showDetails(false);\n    }\n  }\n\n  showDetails(loading) {\n    this._details.show();\n\n    if (loading) {\n      this._details.widget.renderLoading();\n    } else {\n      this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n    }\n\n    this._positionDetails();\n\n    this.editor.focus();\n    this.element.domNode.classList.add('shows-details');\n  }\n\n  toggleExplainMode() {\n    if (this._list.getFocusedElements()[0]) {\n      this._explainMode = !this._explainMode;\n\n      if (!this._isDetailsVisible()) {\n        this.toggleDetails();\n      } else {\n        this.showDetails(false);\n      }\n    }\n  }\n\n  resetPersistedSize() {\n    this._persistedSize.reset();\n  }\n\n  hideWidget() {\n    var _a;\n\n    (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n\n    this._setState(0\n    /* Hidden */\n    );\n\n    this._onDidHide.fire(this);\n\n    this.element.clearSashHoverState(); // ensure that a reasonable widget height is persisted so that\n    // accidential \"resize-to-single-items\" cases aren't happening\n\n    const dim = this._persistedSize.restore();\n\n    const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n\n    if (dim && dim.height < minPersistedHeight) {\n      this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n    }\n  }\n\n  isFrozen() {\n    return this._state === 4\n    /* Frozen */\n    ;\n  }\n\n  _afterRender(position) {\n    if (position === null) {\n      if (this._isDetailsVisible()) {\n        this._details.hide(); //todo@jrieken soft-hide\n\n      }\n\n      return;\n    }\n\n    if (this._state === 2\n    /* Empty */\n    || this._state === 1\n    /* Loading */\n    ) {\n      // no special positioning when widget isn't showing list\n      return;\n    }\n\n    if (this._isDetailsVisible()) {\n      this._details.show();\n    }\n\n    this._positionDetails();\n  }\n\n  _layout(size) {\n    var _a, _b, _c;\n\n    if (!this.editor.hasModel()) {\n      return;\n    }\n\n    if (!this.editor.getDomNode()) {\n      // happens when running tests\n      return;\n    }\n\n    const bodyBox = dom.getClientArea(document.body);\n    const info = this.getLayoutInfo();\n\n    if (!size) {\n      size = info.defaultSize;\n    }\n\n    let height = size.height;\n    let width = size.width; // status bar\n\n    this._status.element.style.lineHeight = `${info.itemHeight}px`;\n\n    if (this._state === 2\n    /* Empty */\n    || this._state === 1\n    /* Loading */\n    ) {\n      // showing a message only\n      height = info.itemHeight + info.borderHeight;\n      width = info.defaultSize.width / 2;\n      this.element.enableSashes(false, false, false, false);\n      this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n\n      this._contentWidget.setPreference(2\n      /* BELOW */\n      );\n    } else {\n      // showing items\n      // width math\n      const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n\n      if (width > maxWidth) {\n        width = maxWidth;\n      }\n\n      const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width; // height math\n\n      const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n      const minHeight = info.itemHeight + info.statusBarHeight;\n      const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n      const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n      const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n      const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n      const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n      const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n      let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n\n      if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n        // Restore the old (wanted) height when the current\n        // height is capped to fit\n        height = this._cappedHeight.wanted;\n      }\n\n      if (height < minHeight) {\n        height = minHeight;\n      }\n\n      if (height > maxHeight) {\n        height = maxHeight;\n      }\n\n      const forceRenderingAboveRequiredSpace = 150;\n\n      if (height > maxHeightBelow || this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace) {\n        this._contentWidget.setPreference(1\n        /* ABOVE */\n        );\n\n        this.element.enableSashes(true, true, false, false);\n        maxHeight = maxHeightAbove;\n      } else {\n        this._contentWidget.setPreference(2\n        /* BELOW */\n        );\n\n        this.element.enableSashes(false, true, true, false);\n        maxHeight = maxHeightBelow;\n      }\n\n      this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n      this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n      this.element.minSize = new dom.Dimension(220, minHeight); // Know when the height was capped to fit and remember\n      // the wanted height for later. This is required when going\n      // left to widen suggestions.\n\n      this._cappedHeight = height === fullHeight ? {\n        wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height,\n        capped: height\n      } : undefined;\n    }\n\n    this._resize(width, height);\n  }\n\n  _resize(width, height) {\n    const {\n      width: maxWidth,\n      height: maxHeight\n    } = this.element.maxSize;\n    width = Math.min(maxWidth, width);\n    height = Math.min(maxHeight, height);\n    const {\n      statusBarHeight\n    } = this.getLayoutInfo();\n\n    this._list.layout(height - statusBarHeight, width);\n\n    this._listElement.style.height = `${height - statusBarHeight}px`;\n    this.element.layout(height, width);\n\n    this._contentWidget.layout();\n\n    this._positionDetails();\n  }\n\n  _positionDetails() {\n    var _a;\n\n    if (this._isDetailsVisible()) {\n      this._details.placeAtAnchor(this.element.domNode, ((_a = this._contentWidget.getPosition()) === null || _a === void 0 ? void 0 : _a.preference[0]) === 2\n      /* BELOW */\n      );\n    }\n  }\n\n  getLayoutInfo() {\n    const fontInfo = this.editor.getOption(44\n    /* fontInfo */\n    );\n    const itemHeight = clamp(this.editor.getOption(108\n    /* suggestLineHeight */\n    ) || fontInfo.lineHeight, 8, 1000);\n    const statusBarHeight = !this.editor.getOption(106\n    /* suggest */\n    ).showStatusBar || this._state === 2\n    /* Empty */\n    || this._state === 1\n    /* Loading */\n    ? 0 : itemHeight;\n    const borderWidth = this._details.widget.borderWidth;\n    const borderHeight = 2 * borderWidth;\n    return {\n      itemHeight,\n      statusBarHeight,\n      borderWidth,\n      borderHeight,\n      typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n      verticalPadding: 22,\n      horizontalPadding: 14,\n      defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n    };\n  }\n\n  _isDetailsVisible() {\n    return this._storageService.getBoolean('expandSuggestionDocs', 0\n    /* GLOBAL */\n    , false);\n  }\n\n  _setDetailsVisible(value) {\n    this._storageService.store('expandSuggestionDocs', value, 0\n    /* GLOBAL */\n    , 0\n    /* USER */\n    );\n  }\n\n  forceRenderingAbove() {\n    if (!this._forceRenderingAbove) {\n      this._forceRenderingAbove = true;\n\n      this._layout(this._persistedSize.restore());\n    }\n  }\n\n  stopForceRenderingAbove() {\n    this._forceRenderingAbove = false;\n  }\n\n};\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = __decorate([__param(1, IStorageService), __param(2, IContextKeyService), __param(3, IThemeService), __param(4, IInstantiationService)], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n  constructor(_widget, _editor) {\n    this._widget = _widget;\n    this._editor = _editor;\n    this.allowEditorOverflow = true;\n    this.suppressMouseDown = false;\n    this._preferenceLocked = false;\n    this._added = false;\n    this._hidden = false;\n  }\n\n  dispose() {\n    if (this._added) {\n      this._added = false;\n\n      this._editor.removeContentWidget(this);\n    }\n  }\n\n  getId() {\n    return 'editor.widget.suggestWidget';\n  }\n\n  getDomNode() {\n    return this._widget.element.domNode;\n  }\n\n  show() {\n    this._hidden = false;\n\n    if (!this._added) {\n      this._added = true;\n\n      this._editor.addContentWidget(this);\n    }\n  }\n\n  hide() {\n    if (!this._hidden) {\n      this._hidden = true;\n      this.layout();\n    }\n  }\n\n  layout() {\n    this._editor.layoutContentWidget(this);\n  }\n\n  getPosition() {\n    if (this._hidden || !this._position || !this._preference) {\n      return null;\n    }\n\n    return {\n      position: this._position,\n      preference: [this._preference]\n    };\n  }\n\n  beforeRender() {\n    const {\n      height,\n      width\n    } = this._widget.element.size;\n\n    const {\n      borderWidth,\n      horizontalPadding\n    } = this._widget.getLayoutInfo();\n\n    return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n  }\n\n  afterRender(position) {\n    this._widget._afterRender(position);\n  }\n\n  setPreference(preference) {\n    if (!this._preferenceLocked) {\n      this._preference = preference;\n    }\n  }\n\n  lockPreference() {\n    this._preferenceLocked = true;\n  }\n\n  unlockPreference() {\n    this._preferenceLocked = false;\n  }\n\n  setPosition(position) {\n    this._position = position;\n  }\n\n}","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidget.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","dom","List","createCancelablePromise","disposableTimeout","TimeoutTimer","onUnexpectedError","Emitter","DisposableStore","clamp","strings","EmbeddedCodeEditorWidget","SuggestWidgetStatus","nls","IContextKeyService","IInstantiationService","IStorageService","activeContrastBorder","editorForeground","editorWidgetBackground","editorWidgetBorder","listFocusHighlightForeground","listHighlightForeground","quickInputListFocusBackground","quickInputListFocusForeground","quickInputListFocusIconForeground","registerColor","transparent","attachListStyler","IThemeService","ResizableHTMLElement","Context","SuggestContext","canExpandCompletionItem","SuggestDetailsOverlay","SuggestDetailsWidget","getAriaId","ItemRenderer","editorSuggestWidgetBackground","dark","light","hc","localize","editorSuggestWidgetBorder","editorSuggestWidgetForeground","editorSuggestWidgetSelectedForeground","editorSuggestWidgetSelectedIconForeground","editorSuggestWidgetSelectedBackground","editorSuggestWidgetHighlightForeground","editorSuggestWidgetHighlightFocusForeground","editorSuggestWidgetStatusForeground","PersistedWidgetSize","constructor","_service","editor","_key","getEditorType","restore","_a","raw","get","obj","JSON","parse","Dimension","is","lift","_b","undefined","store","size","stringify","reset","remove","SuggestWidget","_storageService","_contextKeyService","_themeService","instantiationService","_state","_isAuto","_ignoreFocusEvents","_forceRenderingAbove","_explainMode","_showTimeout","_disposables","_onDidSelect","_onDidFocus","_onDidHide","_onDidShow","onDidSelect","event","onDidFocus","onDidHide","onDidShow","_onDetailsKeydown","onDetailsKeyDown","element","domNode","classList","add","_contentWidget","SuggestContentWidget","_persistedSize","ResizeState","persistedSize","currentSize","persistHeight","persistWidth","state","onDidWillResize","lockPreference","onDidResize","_c","_d","_resize","dimension","width","height","north","south","east","west","itemHeight","defaultSize","getLayoutInfo","threshold","Math","round","abs","unlockPreference","_messageElement","append","$","_listElement","details","createInstance","onDidClose","toggleDetails","_details","applyIconStyle","toggle","getOption","showIcons","renderer","onDidToggleDetails","_list","getHeight","_element","getTemplateId","alwaysConsumeMouseWheel","useShadows","mouseSupport","accessibilityProvider","getRole","getWidgetAriaLabel","getWidgetRole","getAriaLabel","item","label","textLabel","completion","detail","description","isResolved","_isDetailsVisible","documentation","docs","format","_status","applyStatusBarStyle","showStatusBar","listInactiveFocusBackground","listInactiveFocusOutline","onDidColorThemeChange","t","_onThemeChange","getColorTheme","onMouseDown","_onListMouseDownOrTap","onTap","onDidChangeSelection","_onListSelection","onDidChangeFocus","_onListFocus","onDidChangeCursorSelection","_onCursorSelectionChanged","onDidChangeConfiguration","hasChanged","_ctxSuggestWidgetVisible","Visible","bindTo","_ctxSuggestWidgetDetailsVisible","DetailsVisible","_ctxSuggestWidgetMultipleSuggestions","MultipleSuggestions","addStandardDisposableListener","widget","fire","_onEditorMouseDown","dispose","_loadingTimeout","mouseEvent","contains","focus","layout","index","browserEvent","preventDefault","stopPropagation","_select","elements","indexes","completionModel","_completionModel","model","theme","borderWidth","type","_currentSuggestionDetails","cancel","_focusedItem","setAriaOptions","activeDescendant","reveal","token","loading","showDetails","onCancellationRequested","splice","setFocus","catch","_setState","hide","_cappedHeight","textContent","LOADING_MESSAGE","show","_show","NO_SUGGESTIONS_MESSAGE","_layout","set","cancelAndSet","showTriggered","auto","delay","setPosition","getPosition","showSuggestions","selectionIndex","isFrozen","isAuto","visibleCount","items","isEmpty","selectNextPage","pageDown","focusNextPage","selectNext","focusNext","selectLast","scrollBottom","focusLast","selectPreviousPage","pageUp","focusPreviousPage","selectPrevious","focusPrevious","selectFirst","scrollTop","focusFirst","getFocusedItem","getFocusedElements","getFocus","toggleDetailsFocus","_setDetailsVisible","renderLoading","renderItem","_positionDetails","toggleExplainMode","resetPersistedSize","hideWidget","clearSashHoverState","dim","minPersistedHeight","ceil","with","_afterRender","position","hasModel","getDomNode","bodyBox","getClientArea","document","body","info","style","lineHeight","borderHeight","enableSashes","minSize","maxSize","setPreference","maxWidth","horizontalPadding","preferredWidth","stats","pLabelLen","typicalHalfwidthCharacterWidth","fullHeight","statusBarHeight","contentHeight","minHeight","editorBox","getDomNodePagePosition","cursorBox","getScrolledVisiblePosition","cursorBottom","top","maxHeightBelow","min","verticalPadding","availableSpaceAbove","maxHeightAbove","maxHeight","max","capped","wanted","forceRenderingAboveRequiredSpace","preferredSize","placeAtAnchor","preference","fontInfo","getBoolean","forceRenderingAbove","stopForceRenderingAbove","_widget","_editor","allowEditorOverflow","suppressMouseDown","_preferenceLocked","_added","_hidden","removeContentWidget","getId","addContentWidget","layoutContentWidget","_position","_preference","beforeRender","afterRender"],"mappings":"AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,QAAQ,KAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,MAAIC,CAAC,GAAGC,SAAS,CAACC,MAAlB;AAAA,MAA0BC,CAAC,GAAGH,CAAC,GAAG,CAAJ,GAAQH,MAAR,GAAiBE,IAAI,KAAK,IAAT,GAAgBA,IAAI,GAAGK,MAAM,CAACC,wBAAP,CAAgCR,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,MAA2HO,CAA3H;AACA,MAAI,OAAOC,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAO,CAACC,QAAf,KAA4B,UAA/D,EAA2EL,CAAC,GAAGI,OAAO,CAACC,QAAR,CAAiBZ,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAX,GAAoB,CAAjC,EAAoCO,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C,EAAiD,IAAIH,CAAC,GAAGV,UAAU,CAACa,CAAD,CAAlB,EAAuBN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAJ,GAAQM,CAAC,CAACH,CAAD,CAAT,GAAeH,CAAC,GAAG,CAAJ,GAAQM,CAAC,CAACT,MAAD,EAASC,GAAT,EAAcK,CAAd,CAAT,GAA4BG,CAAC,CAACT,MAAD,EAASC,GAAT,CAA7C,KAA+DK,CAAnE;AAC7E,SAAOH,CAAC,GAAG,CAAJ,IAASG,CAAT,IAAcC,MAAM,CAACM,cAAP,CAAsBb,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;;AAMA,IAAIQ,OAAO,GAAI,QAAQ,KAAKA,OAAd,IAA0B,UAAUC,UAAV,EAAsBC,SAAtB,EAAiC;AACrE,SAAO,UAAUhB,MAAV,EAAkBC,GAAlB,EAAuB;AAAEe,IAAAA,SAAS,CAAChB,MAAD,EAASC,GAAT,EAAcc,UAAd,CAAT;AAAqC,GAArE;AACH,CAFD;;AAGA,IAAIE,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA4B,UAAUC,OAAV,EAAmBC,UAAnB,EAA+BC,CAA/B,EAAkCC,SAAlC,EAA6C;AACrF,WAASC,KAAT,CAAeC,KAAf,EAAsB;AAAE,WAAOA,KAAK,YAAYH,CAAjB,GAAqBG,KAArB,GAA6B,IAAIH,CAAJ,CAAM,UAAUI,OAAV,EAAmB;AAAEA,MAAAA,OAAO,CAACD,KAAD,CAAP;AAAiB,KAA5C,CAApC;AAAoF;;AAC5G,SAAO,KAAKH,CAAC,KAAKA,CAAC,GAAGK,OAAT,CAAN,EAAyB,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AACvD,aAASC,SAAT,CAAmBJ,KAAnB,EAA0B;AAAE,UAAI;AAAEK,QAAAA,IAAI,CAACP,SAAS,CAACQ,IAAV,CAAeN,KAAf,CAAD,CAAJ;AAA8B,OAApC,CAAqC,OAAOO,CAAP,EAAU;AAAEJ,QAAAA,MAAM,CAACI,CAAD,CAAN;AAAY;AAAE;;AAC3F,aAASC,QAAT,CAAkBR,KAAlB,EAAyB;AAAE,UAAI;AAAEK,QAAAA,IAAI,CAACP,SAAS,CAAC,OAAD,CAAT,CAAmBE,KAAnB,CAAD,CAAJ;AAAkC,OAAxC,CAAyC,OAAOO,CAAP,EAAU;AAAEJ,QAAAA,MAAM,CAACI,CAAD,CAAN;AAAY;AAAE;;AAC9F,aAASF,IAAT,CAAcI,MAAd,EAAsB;AAAEA,MAAAA,MAAM,CAACC,IAAP,GAAcT,OAAO,CAACQ,MAAM,CAACT,KAAR,CAArB,GAAsCD,KAAK,CAACU,MAAM,CAACT,KAAR,CAAL,CAAoBW,IAApB,CAAyBP,SAAzB,EAAoCI,QAApC,CAAtC;AAAsF;;AAC9GH,IAAAA,IAAI,CAAC,CAACP,SAAS,GAAGA,SAAS,CAACc,KAAV,CAAgBjB,OAAhB,EAAyBC,UAAU,IAAI,EAAvC,CAAb,EAAyDU,IAAzD,EAAD,CAAJ;AACH,GALM,CAAP;AAMH,CARD;;AASA,OAAO,KAAKO,GAAZ,MAAqB,iCAArB;AACA,OAAO,uDAAP,C,CAAgE;;AAChE,SAASC,IAAT,QAAqB,gDAArB;AACA,SAASC,uBAAT,EAAkCC,iBAAlC,EAAqDC,YAArD,QAAyE,kCAAzE;AACA,SAASC,iBAAT,QAAkC,mCAAlC;AACA,SAASC,OAAT,QAAwB,kCAAxB;AACA,SAASC,eAAT,QAAgC,sCAAhC;AACA,SAASC,KAAT,QAAsB,oCAAtB;AACA,OAAO,KAAKC,OAAZ,MAAyB,oCAAzB;AACA,OAAO,qBAAP;AACA,SAASC,wBAAT,QAAyC,qDAAzC;AACA,SAASC,mBAAT,QAAoC,0BAApC;AACA,OAAO,0CAAP,C,CAAmD;;AACnD,OAAO,KAAKC,GAAZ,MAAqB,oBAArB;AACA,SAASC,kBAAT,QAAmC,sDAAnC;AACA,SAASC,qBAAT,QAAsC,4DAAtC;AACA,SAASC,eAAT,QAAgC,gDAAhC;AACA,SAASC,oBAAT,EAA+BC,gBAA/B,EAAiDC,sBAAjD,EAAyEC,kBAAzE,EAA6FC,4BAA7F,EAA2HC,uBAA3H,EAAoJC,6BAApJ,EAAmLC,6BAAnL,EAAkNC,iCAAlN,EAAqPC,aAArP,EAAoQC,WAApQ,QAAuR,oDAAvR;AACA,SAASC,gBAAT,QAAiC,6CAAjC;AACA,SAASC,aAAT,QAA8B,mDAA9B;AACA,SAASC,oBAAT,QAAqC,gBAArC;AACA,SAASC,OAAO,IAAIC,cAApB,QAA0C,cAA1C;AACA,SAASC,uBAAT,EAAkCC,qBAAlC,EAAyDC,oBAAzD,QAAqF,2BAArF;AACA,SAASC,SAAT,EAAoBC,YAApB,QAAwC,4BAAxC;AACA;AACA;AACA;;AACA,OAAO,MAAMC,6BAA6B,GAAGZ,aAAa,CAAC,gCAAD,EAAmC;AAAEa,EAAAA,IAAI,EAAEpB,sBAAR;AAAgCqB,EAAAA,KAAK,EAAErB,sBAAvC;AAA+DsB,EAAAA,EAAE,EAAEtB;AAAnE,CAAnC,EAAgIN,GAAG,CAAC6B,QAAJ,CAAa,+BAAb,EAA8C,yCAA9C,CAAhI,CAAnD;AACP,OAAO,MAAMC,yBAAyB,GAAGjB,aAAa,CAAC,4BAAD,EAA+B;AAAEa,EAAAA,IAAI,EAAEnB,kBAAR;AAA4BoB,EAAAA,KAAK,EAAEpB,kBAAnC;AAAuDqB,EAAAA,EAAE,EAAErB;AAA3D,CAA/B,EAAgHP,GAAG,CAAC6B,QAAJ,CAAa,2BAAb,EAA0C,qCAA1C,CAAhH,CAA/C;AACP,OAAO,MAAME,6BAA6B,GAAGlB,aAAa,CAAC,gCAAD,EAAmC;AAAEa,EAAAA,IAAI,EAAErB,gBAAR;AAA0BsB,EAAAA,KAAK,EAAEtB,gBAAjC;AAAmDuB,EAAAA,EAAE,EAAEvB;AAAvD,CAAnC,EAA8GL,GAAG,CAAC6B,QAAJ,CAAa,+BAAb,EAA8C,yCAA9C,CAA9G,CAAnD;AACP,OAAO,MAAMG,qCAAqC,GAAGnB,aAAa,CAAC,wCAAD,EAA2C;AAAEa,EAAAA,IAAI,EAAEf,6BAAR;AAAuCgB,EAAAA,KAAK,EAAEhB,6BAA9C;AAA6EiB,EAAAA,EAAE,EAAEjB;AAAjF,CAA3C,EAA6JX,GAAG,CAAC6B,QAAJ,CAAa,uCAAb,EAAsD,+DAAtD,CAA7J,CAA3D;AACP,OAAO,MAAMI,yCAAyC,GAAGpB,aAAa,CAAC,4CAAD,EAA+C;AAAEa,EAAAA,IAAI,EAAEd,iCAAR;AAA2Ce,EAAAA,KAAK,EAAEf,iCAAlD;AAAqFgB,EAAAA,EAAE,EAAEhB;AAAzF,CAA/C,EAA6KZ,GAAG,CAAC6B,QAAJ,CAAa,2CAAb,EAA0D,oEAA1D,CAA7K,CAA/D;AACP,OAAO,MAAMK,qCAAqC,GAAGrB,aAAa,CAAC,wCAAD,EAA2C;AAAEa,EAAAA,IAAI,EAAEhB,6BAAR;AAAuCiB,EAAAA,KAAK,EAAEjB,6BAA9C;AAA6EkB,EAAAA,EAAE,EAAElB;AAAjF,CAA3C,EAA6JV,GAAG,CAAC6B,QAAJ,CAAa,uCAAb,EAAsD,+DAAtD,CAA7J,CAA3D;AACP,OAAO,MAAMM,sCAAsC,GAAGtB,aAAa,CAAC,yCAAD,EAA4C;AAAEa,EAAAA,IAAI,EAAEjB,uBAAR;AAAiCkB,EAAAA,KAAK,EAAElB,uBAAxC;AAAiEmB,EAAAA,EAAE,EAAEnB;AAArE,CAA5C,EAA4IT,GAAG,CAAC6B,QAAJ,CAAa,wCAAb,EAAuD,sDAAvD,CAA5I,CAA5D;AACP,OAAO,MAAMO,2CAA2C,GAAGvB,aAAa,CAAC,8CAAD,EAAiD;AAAEa,EAAAA,IAAI,EAAElB,4BAAR;AAAsCmB,EAAAA,KAAK,EAAEnB,4BAA7C;AAA2EoB,EAAAA,EAAE,EAAEpB;AAA/E,CAAjD,EAAgKR,GAAG,CAAC6B,QAAJ,CAAa,6CAAb,EAA4D,8EAA5D,CAAhK,CAAjE;AACP,OAAO,MAAMQ,mCAAmC,GAAGxB,aAAa,CAAC,sCAAD,EAAyC;AAAEa,EAAAA,IAAI,EAAEZ,WAAW,CAACiB,6BAAD,EAAgC,EAAhC,CAAnB;AAAwDJ,EAAAA,KAAK,EAAEb,WAAW,CAACiB,6BAAD,EAAgC,EAAhC,CAA1E;AAA+GH,EAAAA,EAAE,EAAEd,WAAW,CAACiB,6BAAD,EAAgC,EAAhC;AAA9H,CAAzC,EAA8M/B,GAAG,CAAC6B,QAAJ,CAAa,qCAAb,EAAoD,gDAApD,CAA9M,CAAzD;;AACP,MAAMS,mBAAN,CAA0B;AACtBC,EAAAA,WAAW,CAACC,QAAD,EAAWC,MAAX,EAAmB;AAC1B,SAAKD,QAAL,GAAgBA,QAAhB;AACA,SAAKE,IAAL,GAAa,sBAAqBD,MAAM,CAACE,aAAP,EAAuB,IAAGF,MAAM,YAAY3C,wBAAyB,EAAvG;AACH;;AACD8C,EAAAA,OAAO,GAAG;AACN,QAAIC,EAAJ;;AACA,UAAMC,GAAG,GAAG,CAACD,EAAE,GAAG,KAAKL,QAAL,CAAcO,GAAd,CAAkB,KAAKL,IAAvB,EAA6B;AAAE;AAA/B,KAAN,MAAwD,IAAxD,IAAgEG,EAAE,KAAK,KAAK,CAA5E,GAAgFA,EAAhF,GAAqF,EAAjG;;AACA,QAAI;AACA,YAAMG,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWJ,GAAX,CAAZ;;AACA,UAAI1D,GAAG,CAAC+D,SAAJ,CAAcC,EAAd,CAAiBJ,GAAjB,CAAJ,EAA2B;AACvB,eAAO5D,GAAG,CAAC+D,SAAJ,CAAcE,IAAd,CAAmBL,GAAnB,CAAP;AACH;AACJ,KALD,CAMA,OAAOM,EAAP,EAAW,CACP;AACH;;AACD,WAAOC,SAAP;AACH;;AACDC,EAAAA,KAAK,CAACC,IAAD,EAAO;AACR,SAAKjB,QAAL,CAAcgB,KAAd,CAAoB,KAAKd,IAAzB,EAA+BO,IAAI,CAACS,SAAL,CAAeD,IAAf,CAA/B,EAAqD;AAAE;AAAvD,MAAqE;AAAE;AAAvE;AACH;;AACDE,EAAAA,KAAK,GAAG;AACJ,SAAKnB,QAAL,CAAcoB,MAAd,CAAqB,KAAKlB,IAA1B,EAAgC;AAAE;AAAlC;AACH;;AAxBqB;;AA0B1B,IAAImB,aAAa,GAAG,MAAMA,aAAN,CAAoB;AACpCtB,EAAAA,WAAW,CAACE,MAAD,EAASqB,eAAT,EAA0BC,kBAA1B,EAA8CC,aAA9C,EAA6DC,oBAA7D,EAAmF;AAC1F,SAAKxB,MAAL,GAAcA,MAAd;AACA,SAAKqB,eAAL,GAAuBA,eAAvB;AACA,SAAKI,MAAL,GAAc;AAAE;AAAhB;AACA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,kBAAL,GAA0B,KAA1B;AACA,SAAKC,oBAAL,GAA4B,KAA5B;AACA,SAAKC,YAAL,GAAoB,KAApB;AACA,SAAKC,YAAL,GAAoB,IAAI/E,YAAJ,EAApB;AACA,SAAKgF,YAAL,GAAoB,IAAI7E,eAAJ,EAApB;AACA,SAAK8E,YAAL,GAAoB,IAAI/E,OAAJ,EAApB;AACA,SAAKgF,WAAL,GAAmB,IAAIhF,OAAJ,EAAnB;AACA,SAAKiF,UAAL,GAAkB,IAAIjF,OAAJ,EAAlB;AACA,SAAKkF,UAAL,GAAkB,IAAIlF,OAAJ,EAAlB;AACA,SAAKmF,WAAL,GAAmB,KAAKJ,YAAL,CAAkBK,KAArC;AACA,SAAKC,UAAL,GAAkB,KAAKL,WAAL,CAAiBI,KAAnC;AACA,SAAKE,SAAL,GAAiB,KAAKL,UAAL,CAAgBG,KAAjC;AACA,SAAKG,SAAL,GAAiB,KAAKL,UAAL,CAAgBE,KAAjC;AACA,SAAKI,iBAAL,GAAyB,IAAIxF,OAAJ,EAAzB;AACA,SAAKyF,gBAAL,GAAwB,KAAKD,iBAAL,CAAuBJ,KAA/C;AACA,SAAKM,OAAL,GAAe,IAAInE,oBAAJ,EAAf;AACA,SAAKmE,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+BC,GAA/B,CAAmC,eAAnC,EAAoD,gBAApD;AACA,SAAKC,cAAL,GAAsB,IAAIC,oBAAJ,CAAyB,IAAzB,EAA+BhD,MAA/B,CAAtB;AACA,SAAKiD,cAAL,GAAsB,IAAIpD,mBAAJ,CAAwBwB,eAAxB,EAAyCrB,MAAzC,CAAtB;;AACA,UAAMkD,WAAN,CAAkB;AACdpD,MAAAA,WAAW,CAACqD,aAAD,EAAgBC,WAAhB,EAA6BC,aAAa,GAAG,KAA7C,EAAoDC,YAAY,GAAG,KAAnE,EAA0E;AACjF,aAAKH,aAAL,GAAqBA,aAArB;AACA,aAAKC,WAAL,GAAmBA,WAAnB;AACA,aAAKC,aAAL,GAAqBA,aAArB;AACA,aAAKC,YAAL,GAAoBA,YAApB;AACH;;AANa;;AAQlB,QAAIC,KAAJ;;AACA,SAAKxB,YAAL,CAAkBe,GAAlB,CAAsB,KAAKH,OAAL,CAAaa,eAAb,CAA6B,MAAM;AACrD,WAAKT,cAAL,CAAoBU,cAApB;;AACAF,MAAAA,KAAK,GAAG,IAAIL,WAAJ,CAAgB,KAAKD,cAAL,CAAoB9C,OAApB,EAAhB,EAA+C,KAAKwC,OAAL,CAAa3B,IAA5D,CAAR;AACH,KAHqB,CAAtB;;AAIA,SAAKe,YAAL,CAAkBe,GAAlB,CAAsB,KAAKH,OAAL,CAAae,WAAb,CAAyBrH,CAAC,IAAI;AAChD,UAAI+D,EAAJ,EAAQS,EAAR,EAAY8C,EAAZ,EAAgBC,EAAhB;;AACA,WAAKC,OAAL,CAAaxH,CAAC,CAACyH,SAAF,CAAYC,KAAzB,EAAgC1H,CAAC,CAACyH,SAAF,CAAYE,MAA5C;;AACA,UAAIT,KAAJ,EAAW;AACPA,QAAAA,KAAK,CAACF,aAAN,GAAsBE,KAAK,CAACF,aAAN,IAAuB,CAAC,CAAChH,CAAC,CAAC4H,KAA3B,IAAoC,CAAC,CAAC5H,CAAC,CAAC6H,KAA9D;AACAX,QAAAA,KAAK,CAACD,YAAN,GAAqBC,KAAK,CAACD,YAAN,IAAsB,CAAC,CAACjH,CAAC,CAAC8H,IAA1B,IAAkC,CAAC,CAAC9H,CAAC,CAAC+H,IAA3D;AACH;;AACD,UAAI,CAAC/H,CAAC,CAACG,IAAP,EAAa;AACT;AACH;;AACD,UAAI+G,KAAJ,EAAW;AACP;AACA;AACA,cAAM;AAAEc,UAAAA,UAAF;AAAcC,UAAAA;AAAd,YAA8B,KAAKC,aAAL,EAApC;AACA,cAAMC,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAWL,UAAU,GAAG,CAAxB,CAAlB;AACA,YAAI;AAAEN,UAAAA,KAAF;AAASC,UAAAA;AAAT,YAAoB,KAAKrB,OAAL,CAAa3B,IAArC;;AACA,YAAI,CAACuC,KAAK,CAACF,aAAP,IAAwBoB,IAAI,CAACE,GAAL,CAASpB,KAAK,CAACH,WAAN,CAAkBY,MAAlB,GAA2BA,MAApC,KAA+CQ,SAA3E,EAAsF;AAClFR,UAAAA,MAAM,GAAG,CAACnD,EAAE,GAAG,CAACT,EAAE,GAAGmD,KAAK,CAACJ,aAAZ,MAA+B,IAA/B,IAAuC/C,EAAE,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,EAAE,CAAC4D,MAAzE,MAAqF,IAArF,IAA6FnD,EAAE,KAAK,KAAK,CAAzG,GAA6GA,EAA7G,GAAkHyD,WAAW,CAACN,MAAvI;AACH;;AACD,YAAI,CAACT,KAAK,CAACD,YAAP,IAAuBmB,IAAI,CAACE,GAAL,CAASpB,KAAK,CAACH,WAAN,CAAkBW,KAAlB,GAA0BA,KAAnC,KAA6CS,SAAxE,EAAmF;AAC/ET,UAAAA,KAAK,GAAG,CAACH,EAAE,GAAG,CAACD,EAAE,GAAGJ,KAAK,CAACJ,aAAZ,MAA+B,IAA/B,IAAuCQ,EAAE,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,EAAE,CAACI,KAAzE,MAAoF,IAApF,IAA4FH,EAAE,KAAK,KAAK,CAAxG,GAA4GA,EAA5G,GAAiHU,WAAW,CAACP,KAArI;AACH;;AACD,aAAKd,cAAL,CAAoBlC,KAApB,CAA0B,IAAIpE,GAAG,CAAC+D,SAAR,CAAkBqD,KAAlB,EAAyBC,MAAzB,CAA1B;AACH,OAvB+C,CAwBhD;;;AACA,WAAKjB,cAAL,CAAoB6B,gBAApB;;AACArB,MAAAA,KAAK,GAAGzC,SAAR;AACH,KA3BqB,CAAtB;;AA4BA,SAAK+D,eAAL,GAAuBlI,GAAG,CAACmI,MAAJ,CAAW,KAAKnC,OAAL,CAAaC,OAAxB,EAAiCjG,GAAG,CAACoI,CAAJ,CAAM,UAAN,CAAjC,CAAvB;AACA,SAAKC,YAAL,GAAoBrI,GAAG,CAACmI,MAAJ,CAAW,KAAKnC,OAAL,CAAaC,OAAxB,EAAiCjG,GAAG,CAACoI,CAAJ,CAAM,OAAN,CAAjC,CAApB;AACA,UAAME,OAAO,GAAGzD,oBAAoB,CAAC0D,cAArB,CAAoCrG,oBAApC,EAA0D,KAAKmB,MAA/D,CAAhB;AACAiF,IAAAA,OAAO,CAACE,UAAR,CAAmB,KAAKC,aAAxB,EAAuC,IAAvC,EAA6C,KAAKrD,YAAlD;AACA,SAAKsD,QAAL,GAAgB,IAAIzG,qBAAJ,CAA0BqG,OAA1B,EAAmC,KAAKjF,MAAxC,CAAhB;;AACA,UAAMsF,cAAc,GAAG,MAAM,KAAK3C,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B0C,MAA/B,CAAsC,UAAtC,EAAkD,CAAC,KAAKvF,MAAL,CAAYwF,SAAZ,CAAsB;AAAI;AAA1B,MAAyCC,SAA5F,CAA7B;;AACAH,IAAAA,cAAc;AACd,UAAMI,QAAQ,GAAGlE,oBAAoB,CAAC0D,cAArB,CAAoCnG,YAApC,EAAkD,KAAKiB,MAAvD,CAAjB;;AACA,SAAK+B,YAAL,CAAkBe,GAAlB,CAAsB4C,QAAtB;;AACA,SAAK3D,YAAL,CAAkBe,GAAlB,CAAsB4C,QAAQ,CAACC,kBAAT,CAA4B,MAAM,KAAKP,aAAL,EAAlC,CAAtB;;AACA,SAAKQ,KAAL,GAAa,IAAIhJ,IAAJ,CAAS,eAAT,EAA0B,KAAKoI,YAA/B,EAA6C;AACtDa,MAAAA,SAAS,EAAGC,QAAD,IAAc,KAAKvB,aAAL,GAAqBF,UADQ;AAEtD0B,MAAAA,aAAa,EAAGD,QAAD,IAAc;AAFyB,KAA7C,EAGV,CAACJ,QAAD,CAHU,EAGE;AACXM,MAAAA,uBAAuB,EAAE,IADd;AAEXC,MAAAA,UAAU,EAAE,KAFD;AAGXC,MAAAA,YAAY,EAAE,KAHH;AAIXC,MAAAA,qBAAqB,EAAE;AACnBC,QAAAA,OAAO,EAAE,MAAM,QADI;AAEnBC,QAAAA,kBAAkB,EAAE,MAAM9I,GAAG,CAAC6B,QAAJ,CAAa,SAAb,EAAwB,SAAxB,CAFP;AAGnBkH,QAAAA,aAAa,EAAE,MAAM,SAHF;AAInBC,QAAAA,YAAY,EAAGC,IAAD,IAAU;AACpB,cAAIC,KAAK,GAAGD,IAAI,CAACE,SAAjB;;AACA,cAAI,OAAOF,IAAI,CAACG,UAAL,CAAgBF,KAAvB,KAAiC,QAArC,EAA+C;AAC3C,kBAAM;AAAEG,cAAAA,MAAF;AAAUC,cAAAA;AAAV,gBAA0BL,IAAI,CAACG,UAAL,CAAgBF,KAAhD;;AACA,gBAAIG,MAAM,IAAIC,WAAd,EAA2B;AACvBJ,cAAAA,KAAK,GAAGlJ,GAAG,CAAC6B,QAAJ,CAAa,YAAb,EAA2B,aAA3B,EAA0CqH,KAA1C,EAAiDG,MAAjD,EAAyDC,WAAzD,CAAR;AACH,aAFD,MAGK,IAAID,MAAJ,EAAY;AACbH,cAAAA,KAAK,GAAGlJ,GAAG,CAAC6B,QAAJ,CAAa,cAAb,EAA6B,QAA7B,EAAuCqH,KAAvC,EAA8CG,MAA9C,CAAR;AACH,aAFI,MAGA,IAAIC,WAAJ,EAAiB;AAClBJ,cAAAA,KAAK,GAAGlJ,GAAG,CAAC6B,QAAJ,CAAa,YAAb,EAA2B,UAA3B,EAAuCqH,KAAvC,EAA8CI,WAA9C,CAAR;AACH;AACJ;;AACD,cAAI,CAACL,IAAI,CAACM,UAAN,IAAoB,CAAC,KAAKC,iBAAL,EAAzB,EAAmD;AAC/C,mBAAON,KAAP;AACH;;AACD,gBAAM;AAAEO,YAAAA,aAAF;AAAiBJ,YAAAA;AAAjB,cAA4BJ,IAAI,CAACG,UAAvC;AACA,gBAAMM,IAAI,GAAG7J,OAAO,CAAC8J,MAAR,CAAe,QAAf,EAAyBN,MAAM,IAAI,EAAnC,EAAuCI,aAAa,GAAI,OAAOA,aAAP,KAAyB,QAAzB,GAAoCA,aAApC,GAAoDA,aAAa,CAAClL,KAAtE,GAA+E,EAAnI,CAAb;AACA,iBAAOyB,GAAG,CAAC6B,QAAJ,CAAa,mCAAb,EAAkD,gBAAlD,EAAoEqH,KAApE,EAA2EQ,IAA3E,CAAP;AACH;AAxBkB;AAJZ,KAHF,CAAb;AAkCA,SAAKE,OAAL,GAAe3F,oBAAoB,CAAC0D,cAArB,CAAoC5H,mBAApC,EAAyD,KAAKqF,OAAL,CAAaC,OAAtE,CAAf;;AACA,UAAMwE,mBAAmB,GAAG,MAAM,KAAKzE,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B0C,MAA/B,CAAsC,iBAAtC,EAAyD,KAAKvF,MAAL,CAAYwF,SAAZ,CAAsB;AAAI;AAA1B,MAAyC6B,aAAlG,CAAlC;;AACAD,IAAAA,mBAAmB;;AACnB,SAAKrF,YAAL,CAAkBe,GAAlB,CAAsBxE,gBAAgB,CAAC,KAAKsH,KAAN,EAAarE,aAAb,EAA4B;AAC9D+F,MAAAA,2BAA2B,EAAE7H,qCADiC;AAE9D8H,MAAAA,wBAAwB,EAAE5J;AAFoC,KAA5B,CAAtC;;AAIA,SAAKoE,YAAL,CAAkBe,GAAlB,CAAsBvB,aAAa,CAACiG,qBAAd,CAAoCC,CAAC,IAAI,KAAKC,cAAL,CAAoBD,CAApB,CAAzC,CAAtB;;AACA,SAAKC,cAAL,CAAoBnG,aAAa,CAACoG,aAAd,EAApB;;AACA,SAAK5F,YAAL,CAAkBe,GAAlB,CAAsB,KAAK8C,KAAL,CAAWgC,WAAX,CAAuBvL,CAAC,IAAI,KAAKwL,qBAAL,CAA2BxL,CAA3B,CAA5B,CAAtB;;AACA,SAAK0F,YAAL,CAAkBe,GAAlB,CAAsB,KAAK8C,KAAL,CAAWkC,KAAX,CAAiBzL,CAAC,IAAI,KAAKwL,qBAAL,CAA2BxL,CAA3B,CAAtB,CAAtB;;AACA,SAAK0F,YAAL,CAAkBe,GAAlB,CAAsB,KAAK8C,KAAL,CAAWmC,oBAAX,CAAgC1L,CAAC,IAAI,KAAK2L,gBAAL,CAAsB3L,CAAtB,CAArC,CAAtB;;AACA,SAAK0F,YAAL,CAAkBe,GAAlB,CAAsB,KAAK8C,KAAL,CAAWqC,gBAAX,CAA4B5L,CAAC,IAAI,KAAK6L,YAAL,CAAkB7L,CAAlB,CAAjC,CAAtB;;AACA,SAAK0F,YAAL,CAAkBe,GAAlB,CAAsB,KAAK9C,MAAL,CAAYmI,0BAAZ,CAAuC,MAAM,KAAKC,yBAAL,EAA7C,CAAtB;;AACA,SAAKrG,YAAL,CAAkBe,GAAlB,CAAsB,KAAK9C,MAAL,CAAYqI,wBAAZ,CAAqChM,CAAC,IAAI;AAC5D,UAAIA,CAAC,CAACiM,UAAF,CAAa;AAAI;AAAjB,OAAJ,EAAqC;AACjClB,QAAAA,mBAAmB;AACnB9B,QAAAA,cAAc;AACjB;AACJ,KALqB,CAAtB;;AAMA,SAAKiD,wBAAL,GAAgC7J,cAAc,CAAC8J,OAAf,CAAuBC,MAAvB,CAA8BnH,kBAA9B,CAAhC;AACA,SAAKoH,+BAAL,GAAuChK,cAAc,CAACiK,cAAf,CAA8BF,MAA9B,CAAqCnH,kBAArC,CAAvC;AACA,SAAKsH,oCAAL,GAA4ClK,cAAc,CAACmK,mBAAf,CAAmCJ,MAAnC,CAA0CnH,kBAA1C,CAA5C;;AACA,SAAKS,YAAL,CAAkBe,GAAlB,CAAsBnG,GAAG,CAACmM,6BAAJ,CAAkC,KAAKzD,QAAL,CAAc0D,MAAd,CAAqBnG,OAAvD,EAAgE,SAAhE,EAA2EvG,CAAC,IAAI;AAClG,WAAKoG,iBAAL,CAAuBuG,IAAvB,CAA4B3M,CAA5B;AACH,KAFqB,CAAtB;;AAGA,SAAK0F,YAAL,CAAkBe,GAAlB,CAAsB,KAAK9C,MAAL,CAAY4H,WAAZ,CAAyBvL,CAAD,IAAO,KAAK4M,kBAAL,CAAwB5M,CAAxB,CAA/B,CAAtB;AACH;;AACD6M,EAAAA,OAAO,GAAG;AACN,QAAI9I,EAAJ;;AACA,SAAKiF,QAAL,CAAc0D,MAAd,CAAqBG,OAArB;;AACA,SAAK7D,QAAL,CAAc6D,OAAd;;AACA,SAAKtD,KAAL,CAAWsD,OAAX;;AACA,SAAK/B,OAAL,CAAa+B,OAAb;;AACA,SAAKnH,YAAL,CAAkBmH,OAAlB;;AACA,KAAC9I,EAAE,GAAG,KAAK+I,eAAX,MAAgC,IAAhC,IAAwC/I,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAAC8I,OAAH,EAAjE;;AACA,SAAKpH,YAAL,CAAkBoH,OAAlB;;AACA,SAAKnG,cAAL,CAAoBmG,OAApB;;AACA,SAAKvG,OAAL,CAAauG,OAAb;AACH;;AACDD,EAAAA,kBAAkB,CAACG,UAAD,EAAa;AAC3B,QAAI,KAAK/D,QAAL,CAAc0D,MAAd,CAAqBnG,OAArB,CAA6ByG,QAA7B,CAAsCD,UAAU,CAAC7O,MAAX,CAAkBoI,OAAxD,CAAJ,EAAsE;AAClE;AACA,WAAK0C,QAAL,CAAc0D,MAAd,CAAqBnG,OAArB,CAA6B0G,KAA7B;AACH,KAHD,MAIK;AACD;AACA,UAAI,KAAK3G,OAAL,CAAaC,OAAb,CAAqByG,QAArB,CAA8BD,UAAU,CAAC7O,MAAX,CAAkBoI,OAAhD,CAAJ,EAA8D;AAC1D,aAAK3C,MAAL,CAAYsJ,KAAZ;AACH;AACJ;AACJ;;AACDlB,EAAAA,yBAAyB,GAAG;AACxB,QAAI,KAAK3G,MAAL,KAAgB;AAAE;AAAtB,MAAoC;AAChC,WAAKsB,cAAL,CAAoBwG,MAApB;AACH;AACJ;;AACD1B,EAAAA,qBAAqB,CAACxL,CAAD,EAAI;AACrB,QAAI,OAAOA,CAAC,CAACsG,OAAT,KAAqB,WAArB,IAAoC,OAAOtG,CAAC,CAACmN,KAAT,KAAmB,WAA3D,EAAwE;AACpE;AACH,KAHoB,CAIrB;;;AACAnN,IAAAA,CAAC,CAACoN,YAAF,CAAeC,cAAf;AACArN,IAAAA,CAAC,CAACoN,YAAF,CAAeE,eAAf;;AACA,SAAKC,OAAL,CAAavN,CAAC,CAACsG,OAAf,EAAwBtG,CAAC,CAACmN,KAA1B;AACH;;AACDxB,EAAAA,gBAAgB,CAAC3L,CAAD,EAAI;AAChB,QAAIA,CAAC,CAACwN,QAAF,CAAWjP,MAAf,EAAuB;AACnB,WAAKgP,OAAL,CAAavN,CAAC,CAACwN,QAAF,CAAW,CAAX,CAAb,EAA4BxN,CAAC,CAACyN,OAAF,CAAU,CAAV,CAA5B;AACH;AACJ;;AACDF,EAAAA,OAAO,CAACpD,IAAD,EAAOgD,KAAP,EAAc;AACjB,UAAMO,eAAe,GAAG,KAAKC,gBAA7B;;AACA,QAAID,eAAJ,EAAqB;AACjB,WAAK/H,YAAL,CAAkBgH,IAAlB,CAAuB;AAAExC,QAAAA,IAAF;AAAQgD,QAAAA,KAAR;AAAeS,QAAAA,KAAK,EAAEF;AAAtB,OAAvB;;AACA,WAAK/J,MAAL,CAAYsJ,KAAZ;AACH;AACJ;;AACD5B,EAAAA,cAAc,CAACwC,KAAD,EAAQ;AAClB,SAAK7E,QAAL,CAAc0D,MAAd,CAAqBoB,WAArB,GAAmCD,KAAK,CAACE,IAAN,KAAe,IAAf,GAAsB,CAAtB,GAA0B,CAA7D;AACH;;AACDlC,EAAAA,YAAY,CAAC7L,CAAD,EAAI;AACZ,QAAI+D,EAAJ;;AACA,QAAI,KAAKuB,kBAAT,EAA6B;AACzB;AACH;;AACD,QAAI,CAACtF,CAAC,CAACwN,QAAF,CAAWjP,MAAhB,EAAwB;AACpB,UAAI,KAAKyP,yBAAT,EAAoC;AAChC,aAAKA,yBAAL,CAA+BC,MAA/B;;AACA,aAAKD,yBAAL,GAAiCvJ,SAAjC;AACA,aAAKyJ,YAAL,GAAoBzJ,SAApB;AACH;;AACD,WAAKd,MAAL,CAAYwK,cAAZ,CAA2B;AAAEC,QAAAA,gBAAgB,EAAE3J;AAApB,OAA3B;AACA;AACH;;AACD,QAAI,CAAC,KAAKkJ,gBAAV,EAA4B;AACxB;AACH;;AACD,UAAMxD,IAAI,GAAGnK,CAAC,CAACwN,QAAF,CAAW,CAAX,CAAb;AACA,UAAML,KAAK,GAAGnN,CAAC,CAACyN,OAAF,CAAU,CAAV,CAAd;;AACA,QAAItD,IAAI,KAAK,KAAK+D,YAAlB,EAAgC;AAC5B,OAACnK,EAAE,GAAG,KAAKiK,yBAAX,MAA0C,IAA1C,IAAkDjK,EAAE,KAAK,KAAK,CAA9D,GAAkE,KAAK,CAAvE,GAA2EA,EAAE,CAACkK,MAAH,EAA3E;AACA,WAAKD,yBAAL,GAAiCvJ,SAAjC;AACA,WAAKyJ,YAAL,GAAoB/D,IAApB;;AACA,WAAKZ,KAAL,CAAW8E,MAAX,CAAkBlB,KAAlB;;AACA,WAAKa,yBAAL,GAAiCxN,uBAAuB,CAAE8N,KAAD,IAAWnP,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,aAAa;AAC7G,cAAMoP,OAAO,GAAG9N,iBAAiB,CAAC,MAAM;AACpC,cAAI,KAAKiK,iBAAL,EAAJ,EAA8B;AAC1B,iBAAK8D,WAAL,CAAiB,IAAjB;AACH;AACJ,SAJgC,EAI9B,GAJ8B,CAAjC;AAKAF,QAAAA,KAAK,CAACG,uBAAN,CAA8B,MAAMF,OAAO,CAAC1B,OAAR,EAApC;AACA,cAAM3M,MAAM,GAAG,MAAMiK,IAAI,CAACzK,OAAL,CAAa4O,KAAb,CAArB;AACAC,QAAAA,OAAO,CAAC1B,OAAR;AACA,eAAO3M,MAAP;AACH,OAV4E,CAArB,CAAxD;;AAWA,WAAK8N,yBAAL,CAA+B5N,IAA/B,CAAoC,MAAM;AACtC,YAAI+M,KAAK,IAAI,KAAK5D,KAAL,CAAWhL,MAApB,IAA8B4L,IAAI,KAAK,KAAKZ,KAAL,CAAWjD,OAAX,CAAmB6G,KAAnB,CAA3C,EAAsE;AAClE;AACH,SAHqC,CAItC;;;AACA,aAAK7H,kBAAL,GAA0B,IAA1B;;AACA,aAAKiE,KAAL,CAAWmF,MAAX,CAAkBvB,KAAlB,EAAyB,CAAzB,EAA4B,CAAChD,IAAD,CAA5B;;AACA,aAAKZ,KAAL,CAAWoF,QAAX,CAAoB,CAACxB,KAAD,CAApB;;AACA,aAAK7H,kBAAL,GAA0B,KAA1B;;AACA,YAAI,KAAKoF,iBAAL,EAAJ,EAA8B;AAC1B,eAAK8D,WAAL,CAAiB,KAAjB;AACH,SAFD,MAGK;AACD,eAAKlI,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B1B,MAA/B,CAAsC,WAAtC;AACH;;AACD,aAAKnB,MAAL,CAAYwK,cAAZ,CAA2B;AAAEC,UAAAA,gBAAgB,EAAE3L,SAAS,CAAC0K,KAAD;AAA7B,SAA3B;AACH,OAhBD,EAgBGyB,KAhBH,CAgBSjO,iBAhBT;AAiBH,KApDW,CAqDZ;;;AACA,SAAKiF,WAAL,CAAiB+G,IAAjB,CAAsB;AAAExC,MAAAA,IAAF;AAAQgD,MAAAA,KAAR;AAAeS,MAAAA,KAAK,EAAE,KAAKD;AAA3B,KAAtB;AACH;;AACDkB,EAAAA,SAAS,CAAC3H,KAAD,EAAQ;AACb,QAAI,KAAK9B,MAAL,KAAgB8B,KAApB,EAA2B;AACvB;AACH;;AACD,SAAK9B,MAAL,GAAc8B,KAAd;AACA,SAAKZ,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B0C,MAA/B,CAAsC,QAAtC,EAAgDhC,KAAK,KAAK;AAAE;AAA5D;AACA,SAAKZ,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B1B,MAA/B,CAAsC,SAAtC;;AACA,YAAQoC,KAAR;AACI,WAAK;AAAE;AAAP;AACI5G,QAAAA,GAAG,CAACwO,IAAJ,CAAS,KAAKtG,eAAd,EAA+B,KAAKG,YAApC,EAAkD,KAAKmC,OAAL,CAAaxE,OAA/D;;AACA,aAAK0C,QAAL,CAAc8F,IAAd,CAAmB,IAAnB;;AACA,aAAKhE,OAAL,CAAagE,IAAb;;AACA,aAAKpI,cAAL,CAAoBoI,IAApB;;AACA,aAAK5C,wBAAL,CAA8BrH,KAA9B;;AACA,aAAK0H,oCAAL,CAA0C1H,KAA1C;;AACA,aAAKY,YAAL,CAAkBwI,MAAlB;;AACA,aAAK3H,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B1B,MAA/B,CAAsC,SAAtC;;AACA,aAAKyE,KAAL,CAAWmF,MAAX,CAAkB,CAAlB,EAAqB,KAAKnF,KAAL,CAAWhL,MAAhC;;AACA,aAAK2P,YAAL,GAAoBzJ,SAApB;AACA,aAAKsK,aAAL,GAAqBtK,SAArB;AACA,aAAKe,YAAL,GAAoB,KAApB;AACA;;AACJ,WAAK;AAAE;AAAP;AACI,aAAKc,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+BC,GAA/B,CAAmC,SAAnC;AACA,aAAK+B,eAAL,CAAqBwG,WAArB,GAAmCjK,aAAa,CAACkK,eAAjD;AACA3O,QAAAA,GAAG,CAACwO,IAAJ,CAAS,KAAKnG,YAAd,EAA4B,KAAKmC,OAAL,CAAaxE,OAAzC;AACAhG,QAAAA,GAAG,CAAC4O,IAAJ,CAAS,KAAK1G,eAAd;;AACA,aAAKQ,QAAL,CAAc8F,IAAd;;AACA,aAAKK,KAAL;;AACA,aAAKjB,YAAL,GAAoBzJ,SAApB;AACA;;AACJ,WAAK;AAAE;AAAP;AACI,aAAK6B,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+BC,GAA/B,CAAmC,SAAnC;AACA,aAAK+B,eAAL,CAAqBwG,WAArB,GAAmCjK,aAAa,CAACqK,sBAAjD;AACA9O,QAAAA,GAAG,CAACwO,IAAJ,CAAS,KAAKnG,YAAd,EAA4B,KAAKmC,OAAL,CAAaxE,OAAzC;AACAhG,QAAAA,GAAG,CAAC4O,IAAJ,CAAS,KAAK1G,eAAd;;AACA,aAAKQ,QAAL,CAAc8F,IAAd;;AACA,aAAKK,KAAL;;AACA,aAAKjB,YAAL,GAAoBzJ,SAApB;AACA;;AACJ,WAAK;AAAE;AAAP;AACInE,QAAAA,GAAG,CAACwO,IAAJ,CAAS,KAAKtG,eAAd;AACAlI,QAAAA,GAAG,CAAC4O,IAAJ,CAAS,KAAKvG,YAAd,EAA4B,KAAKmC,OAAL,CAAaxE,OAAzC;;AACA,aAAK6I,KAAL;;AACA;;AACJ,WAAK;AAAE;AAAP;AACI7O,QAAAA,GAAG,CAACwO,IAAJ,CAAS,KAAKtG,eAAd;AACAlI,QAAAA,GAAG,CAAC4O,IAAJ,CAAS,KAAKvG,YAAd,EAA4B,KAAKmC,OAAL,CAAaxE,OAAzC;;AACA,aAAK6I,KAAL;;AACA;;AACJ,WAAK;AAAE;AAAP;AACI7O,QAAAA,GAAG,CAACwO,IAAJ,CAAS,KAAKtG,eAAd;AACAlI,QAAAA,GAAG,CAAC4O,IAAJ,CAAS,KAAKvG,YAAd,EAA4B,KAAKmC,OAAL,CAAaxE,OAAzC;;AACA,aAAK0C,QAAL,CAAckG,IAAd;;AACA,aAAKC,KAAL;;AACA;AAhDR;AAkDH;;AACDA,EAAAA,KAAK,GAAG;AACJ,SAAKrE,OAAL,CAAaoE,IAAb;;AACA,SAAKxI,cAAL,CAAoBwI,IAApB;;AACA,SAAKG,OAAL,CAAa,KAAKzI,cAAL,CAAoB9C,OAApB,EAAb;;AACA,SAAKoI,wBAAL,CAA8BoD,GAA9B,CAAkC,IAAlC;;AACA,SAAK7J,YAAL,CAAkB8J,YAAlB,CAA+B,MAAM;AACjC,WAAKjJ,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+BC,GAA/B,CAAmC,SAAnC;;AACA,WAAKX,UAAL,CAAgB6G,IAAhB,CAAqB,IAArB;AACH,KAHD,EAGG,GAHH;AAIH;;AACD6C,EAAAA,aAAa,CAACC,IAAD,EAAOC,KAAP,EAAc;AACvB,QAAI,KAAKtK,MAAL,KAAgB;AAAE;AAAtB,MAAoC;AAChC;AACH;;AACD,SAAKsB,cAAL,CAAoBiJ,WAApB,CAAgC,KAAKhM,MAAL,CAAYiM,WAAZ,EAAhC;;AACA,SAAKvK,OAAL,GAAe,CAAC,CAACoK,IAAjB;;AACA,QAAI,CAAC,KAAKpK,OAAV,EAAmB;AACf,WAAKyH,eAAL,GAAuBrM,iBAAiB,CAAC,MAAM,KAAKoO,SAAL,CAAe;AAAE;AAAjB,OAAP,EAAwCa,KAAxC,CAAxC;AACH;AACJ;;AACDG,EAAAA,eAAe,CAACnC,eAAD,EAAkBoC,cAAlB,EAAkCC,QAAlC,EAA4CC,MAA5C,EAAoD;AAC/D,QAAIjM,EAAJ,EAAQS,EAAR;;AACA,SAAKkC,cAAL,CAAoBiJ,WAApB,CAAgC,KAAKhM,MAAL,CAAYiM,WAAZ,EAAhC;;AACA,KAAC7L,EAAE,GAAG,KAAK+I,eAAX,MAAgC,IAAhC,IAAwC/I,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAAC8I,OAAH,EAAjE;AACA,KAACrI,EAAE,GAAG,KAAKwJ,yBAAX,MAA0C,IAA1C,IAAkDxJ,EAAE,KAAK,KAAK,CAA9D,GAAkE,KAAK,CAAvE,GAA2EA,EAAE,CAACyJ,MAAH,EAA3E;AACA,SAAKD,yBAAL,GAAiCvJ,SAAjC;;AACA,QAAI,KAAKkJ,gBAAL,KAA0BD,eAA9B,EAA+C;AAC3C,WAAKC,gBAAL,GAAwBD,eAAxB;AACH;;AACD,QAAIqC,QAAQ,IAAI,KAAK3K,MAAL,KAAgB;AAAE;AAA9B,OAA6C,KAAKA,MAAL,KAAgB;AAAE;AAAnE,MAAiF;AAC7E,WAAKyJ,SAAL,CAAe;AAAE;AAAjB;;AACA;AACH;;AACD,UAAMoB,YAAY,GAAG,KAAKtC,gBAAL,CAAsBuC,KAAtB,CAA4B3R,MAAjD;AACA,UAAM4R,OAAO,GAAGF,YAAY,KAAK,CAAjC;;AACA,SAAK1D,oCAAL,CAA0C+C,GAA1C,CAA8CW,YAAY,GAAG,CAA7D;;AACA,QAAIE,OAAJ,EAAa;AACT,WAAKtB,SAAL,CAAemB,MAAM,GAAG;AAAE;AAAL,QAAoB;AAAE;AAA3C;;AACA,WAAKrC,gBAAL,GAAwBlJ,SAAxB;AACA;AACH;;AACD,SAAKyJ,YAAL,GAAoBzJ,SAApB;;AACA,SAAK8E,KAAL,CAAWmF,MAAX,CAAkB,CAAlB,EAAqB,KAAKnF,KAAL,CAAWhL,MAAhC,EAAwC,KAAKoP,gBAAL,CAAsBuC,KAA9D;;AACA,SAAKrB,SAAL,CAAekB,QAAQ,GAAG;AAAE;AAAL,MAAoB;AAAE;AAA7C;;AACA,SAAKxG,KAAL,CAAW8E,MAAX,CAAkByB,cAAlB,EAAkC,CAAlC;;AACA,SAAKvG,KAAL,CAAWoF,QAAX,CAAoB,CAACmB,cAAD,CAApB;;AACA,SAAKT,OAAL,CAAa,KAAK/I,OAAL,CAAa3B,IAA1B,EA1B+D,CA2B/D;;;AACA,SAAKqE,QAAL,CAAc0D,MAAd,CAAqBnG,OAArB,CAA6BC,SAA7B,CAAuC1B,MAAvC,CAA8C,SAA9C;AACH;;AACDsL,EAAAA,cAAc,GAAG;AACb,YAAQ,KAAKhL,MAAb;AACI,WAAK;AAAE;AAAP;AACI,eAAO,KAAP;;AACJ,WAAK;AAAE;AAAP;AACI,aAAK4D,QAAL,CAAc0D,MAAd,CAAqB2D,QAArB;;AACA,eAAO,IAAP;;AACJ,WAAK;AAAE;AAAP;AACI,eAAO,CAAC,KAAKhL,OAAb;;AACJ;AACI,aAAKkE,KAAL,CAAW+G,aAAX;;AACA,eAAO,IAAP;AAVR;AAYH;;AACDC,EAAAA,UAAU,GAAG;AACT,YAAQ,KAAKnL,MAAb;AACI,WAAK;AAAE;AAAP;AACI,eAAO,KAAP;;AACJ,WAAK;AAAE;AAAP;AACI,eAAO,CAAC,KAAKC,OAAb;;AACJ;AACI,aAAKkE,KAAL,CAAWiH,SAAX,CAAqB,CAArB,EAAwB,IAAxB;;AACA,eAAO,IAAP;AAPR;AASH;;AACDC,EAAAA,UAAU,GAAG;AACT,YAAQ,KAAKrL,MAAb;AACI,WAAK;AAAE;AAAP;AACI,eAAO,KAAP;;AACJ,WAAK;AAAE;AAAP;AACI,aAAK4D,QAAL,CAAc0D,MAAd,CAAqBgE,YAArB;;AACA,eAAO,IAAP;;AACJ,WAAK;AAAE;AAAP;AACI,eAAO,CAAC,KAAKrL,OAAb;;AACJ;AACI,aAAKkE,KAAL,CAAWoH,SAAX;;AACA,eAAO,IAAP;AAVR;AAYH;;AACDC,EAAAA,kBAAkB,GAAG;AACjB,YAAQ,KAAKxL,MAAb;AACI,WAAK;AAAE;AAAP;AACI,eAAO,KAAP;;AACJ,WAAK;AAAE;AAAP;AACI,aAAK4D,QAAL,CAAc0D,MAAd,CAAqBmE,MAArB;;AACA,eAAO,IAAP;;AACJ,WAAK;AAAE;AAAP;AACI,eAAO,CAAC,KAAKxL,OAAb;;AACJ;AACI,aAAKkE,KAAL,CAAWuH,iBAAX;;AACA,eAAO,IAAP;AAVR;AAYH;;AACDC,EAAAA,cAAc,GAAG;AACb,YAAQ,KAAK3L,MAAb;AACI,WAAK;AAAE;AAAP;AACI,eAAO,KAAP;;AACJ,WAAK;AAAE;AAAP;AACI,eAAO,CAAC,KAAKC,OAAb;;AACJ;AACI,aAAKkE,KAAL,CAAWyH,aAAX,CAAyB,CAAzB,EAA4B,IAA5B;;AACA,eAAO,KAAP;AAPR;AASH;;AACDC,EAAAA,WAAW,GAAG;AACV,YAAQ,KAAK7L,MAAb;AACI,WAAK;AAAE;AAAP;AACI,eAAO,KAAP;;AACJ,WAAK;AAAE;AAAP;AACI,aAAK4D,QAAL,CAAc0D,MAAd,CAAqBwE,SAArB;;AACA,eAAO,IAAP;;AACJ,WAAK;AAAE;AAAP;AACI,eAAO,CAAC,KAAK7L,OAAb;;AACJ;AACI,aAAKkE,KAAL,CAAW4H,UAAX;;AACA,eAAO,IAAP;AAVR;AAYH;;AACDC,EAAAA,cAAc,GAAG;AACb,QAAI,KAAKhM,MAAL,KAAgB;AAAE;AAAlB,OACG,KAAKA,MAAL,KAAgB;AAAE;AADrB,OAEG,KAAKA,MAAL,KAAgB;AAAE;AAFrB,OAGG,KAAKuI,gBAHZ,EAG8B;AAC1B,aAAO;AACHxD,QAAAA,IAAI,EAAE,KAAKZ,KAAL,CAAW8H,kBAAX,GAAgC,CAAhC,CADH;AAEHlE,QAAAA,KAAK,EAAE,KAAK5D,KAAL,CAAW+H,QAAX,GAAsB,CAAtB,CAFJ;AAGH1D,QAAAA,KAAK,EAAE,KAAKD;AAHT,OAAP;AAKH;;AACD,WAAOlJ,SAAP;AACH;;AACD8M,EAAAA,kBAAkB,GAAG;AACjB,QAAI,KAAKnM,MAAL,KAAgB;AAAE;AAAtB,MAAqC;AACjC,WAAKyJ,SAAL,CAAe;AAAE;AAAjB;;AACA,WAAK7F,QAAL,CAAc0D,MAAd,CAAqBnG,OAArB,CAA6BC,SAA7B,CAAuC1B,MAAvC,CAA8C,SAA9C;AACH,KAHD,MAIK,IAAI,KAAKM,MAAL,KAAgB;AAAE;AAAlB,OAAgC,KAAKsF,iBAAL,EAApC,EAA8D;AAC/D,WAAKmE,SAAL,CAAe;AAAE;AAAjB;;AACA,WAAK7F,QAAL,CAAc0D,MAAd,CAAqBnG,OAArB,CAA6BC,SAA7B,CAAuCC,GAAvC,CAA2C,SAA3C;AACH;AACJ;;AACDsC,EAAAA,aAAa,GAAG;AACZ,QAAI,KAAK2B,iBAAL,EAAJ,EAA8B;AAC1B;AACA,WAAK2B,+BAAL,CAAqCiD,GAArC,CAAyC,KAAzC;;AACA,WAAKkC,kBAAL,CAAwB,KAAxB;;AACA,WAAKxI,QAAL,CAAc8F,IAAd;;AACA,WAAKxI,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+B1B,MAA/B,CAAsC,eAAtC;AACH,KAND,MAOK,IAAI,CAACxC,uBAAuB,CAAC,KAAKiH,KAAL,CAAW8H,kBAAX,GAAgC,CAAhC,CAAD,CAAvB,IAA+D,KAAK7L,YAArE,MAAuF,KAAKJ,MAAL,KAAgB;AAAE;AAAlB,OAAgC,KAAKA,MAAL,KAAgB;AAAE;AAAlD,OAAmE,KAAKA,MAAL,KAAgB;AAAE;AAA5K,KAAJ,EAA+L;AAChM;AACA,WAAKiH,+BAAL,CAAqCiD,GAArC,CAAyC,IAAzC;;AACA,WAAKkC,kBAAL,CAAwB,IAAxB;;AACA,WAAKhD,WAAL,CAAiB,KAAjB;AACH;AACJ;;AACDA,EAAAA,WAAW,CAACD,OAAD,EAAU;AACjB,SAAKvF,QAAL,CAAckG,IAAd;;AACA,QAAIX,OAAJ,EAAa;AACT,WAAKvF,QAAL,CAAc0D,MAAd,CAAqB+E,aAArB;AACH,KAFD,MAGK;AACD,WAAKzI,QAAL,CAAc0D,MAAd,CAAqBgF,UAArB,CAAgC,KAAKnI,KAAL,CAAW8H,kBAAX,GAAgC,CAAhC,CAAhC,EAAoE,KAAK7L,YAAzE;AACH;;AACD,SAAKmM,gBAAL;;AACA,SAAKhO,MAAL,CAAYsJ,KAAZ;AACA,SAAK3G,OAAL,CAAaC,OAAb,CAAqBC,SAArB,CAA+BC,GAA/B,CAAmC,eAAnC;AACH;;AACDmL,EAAAA,iBAAiB,GAAG;AAChB,QAAI,KAAKrI,KAAL,CAAW8H,kBAAX,GAAgC,CAAhC,CAAJ,EAAwC;AACpC,WAAK7L,YAAL,GAAoB,CAAC,KAAKA,YAA1B;;AACA,UAAI,CAAC,KAAKkF,iBAAL,EAAL,EAA+B;AAC3B,aAAK3B,aAAL;AACH,OAFD,MAGK;AACD,aAAKyF,WAAL,CAAiB,KAAjB;AACH;AACJ;AACJ;;AACDqD,EAAAA,kBAAkB,GAAG;AACjB,SAAKjL,cAAL,CAAoB/B,KAApB;AACH;;AACDiN,EAAAA,UAAU,GAAG;AACT,QAAI/N,EAAJ;;AACA,KAACA,EAAE,GAAG,KAAK+I,eAAX,MAAgC,IAAhC,IAAwC/I,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAAC8I,OAAH,EAAjE;;AACA,SAAKgC,SAAL,CAAe;AAAE;AAAjB;;AACA,SAAKhJ,UAAL,CAAgB8G,IAAhB,CAAqB,IAArB;;AACA,SAAKrG,OAAL,CAAayL,mBAAb,GALS,CAMT;AACA;;AACA,UAAMC,GAAG,GAAG,KAAKpL,cAAL,CAAoB9C,OAApB,EAAZ;;AACA,UAAMmO,kBAAkB,GAAG7J,IAAI,CAAC8J,IAAL,CAAU,KAAKhK,aAAL,GAAqBF,UAArB,GAAkC,GAA5C,CAA3B;;AACA,QAAIgK,GAAG,IAAIA,GAAG,CAACrK,MAAJ,GAAasK,kBAAxB,EAA4C;AACxC,WAAKrL,cAAL,CAAoBlC,KAApB,CAA0BsN,GAAG,CAACG,IAAJ,CAAS1N,SAAT,EAAoBwN,kBAApB,CAA1B;AACH;AACJ;;AACDlC,EAAAA,QAAQ,GAAG;AACP,WAAO,KAAK3K,MAAL,KAAgB;AAAE;AAAzB;AACH;;AACDgN,EAAAA,YAAY,CAACC,QAAD,EAAW;AACnB,QAAIA,QAAQ,KAAK,IAAjB,EAAuB;AACnB,UAAI,KAAK3H,iBAAL,EAAJ,EAA8B;AAC1B,aAAK1B,QAAL,CAAc8F,IAAd,GAD0B,CACJ;;AACzB;;AACD;AACH;;AACD,QAAI,KAAK1J,MAAL,KAAgB;AAAE;AAAlB,OAAiC,KAAKA,MAAL,KAAgB;AAAE;AAAvD,MAAsE;AAClE;AACA;AACH;;AACD,QAAI,KAAKsF,iBAAL,EAAJ,EAA8B;AAC1B,WAAK1B,QAAL,CAAckG,IAAd;AACH;;AACD,SAAKyC,gBAAL;AACH;;AACDtC,EAAAA,OAAO,CAAC1K,IAAD,EAAO;AACV,QAAIZ,EAAJ,EAAQS,EAAR,EAAY8C,EAAZ;;AACA,QAAI,CAAC,KAAK3D,MAAL,CAAY2O,QAAZ,EAAL,EAA6B;AACzB;AACH;;AACD,QAAI,CAAC,KAAK3O,MAAL,CAAY4O,UAAZ,EAAL,EAA+B;AAC3B;AACA;AACH;;AACD,UAAMC,OAAO,GAAGlS,GAAG,CAACmS,aAAJ,CAAkBC,QAAQ,CAACC,IAA3B,CAAhB;AACA,UAAMC,IAAI,GAAG,KAAK1K,aAAL,EAAb;;AACA,QAAI,CAACvD,IAAL,EAAW;AACPA,MAAAA,IAAI,GAAGiO,IAAI,CAAC3K,WAAZ;AACH;;AACD,QAAIN,MAAM,GAAGhD,IAAI,CAACgD,MAAlB;AACA,QAAID,KAAK,GAAG/C,IAAI,CAAC+C,KAAjB,CAfU,CAgBV;;AACA,SAAKoD,OAAL,CAAaxE,OAAb,CAAqBuM,KAArB,CAA2BC,UAA3B,GAAyC,GAAEF,IAAI,CAAC5K,UAAW,IAA3D;;AACA,QAAI,KAAK5C,MAAL,KAAgB;AAAE;AAAlB,OAAiC,KAAKA,MAAL,KAAgB;AAAE;AAAvD,MAAsE;AAClE;AACAuC,MAAAA,MAAM,GAAGiL,IAAI,CAAC5K,UAAL,GAAkB4K,IAAI,CAACG,YAAhC;AACArL,MAAAA,KAAK,GAAGkL,IAAI,CAAC3K,WAAL,CAAiBP,KAAjB,GAAyB,CAAjC;AACA,WAAKpB,OAAL,CAAa0M,YAAb,CAA0B,KAA1B,EAAiC,KAAjC,EAAwC,KAAxC,EAA+C,KAA/C;AACA,WAAK1M,OAAL,CAAa2M,OAAb,GAAuB,KAAK3M,OAAL,CAAa4M,OAAb,GAAuB,IAAI5S,GAAG,CAAC+D,SAAR,CAAkBqD,KAAlB,EAAyBC,MAAzB,CAA9C;;AACA,WAAKjB,cAAL,CAAoByM,aAApB,CAAkC;AAAE;AAApC;AACH,KAPD,MAQK;AACD;AACA;AACA,YAAMC,QAAQ,GAAGZ,OAAO,CAAC9K,KAAR,GAAgBkL,IAAI,CAACG,YAArB,GAAoC,IAAIH,IAAI,CAACS,iBAA9D;;AACA,UAAI3L,KAAK,GAAG0L,QAAZ,EAAsB;AAClB1L,QAAAA,KAAK,GAAG0L,QAAR;AACH;;AACD,YAAME,cAAc,GAAG,KAAK3F,gBAAL,GAAwB,KAAKA,gBAAL,CAAsB4F,KAAtB,CAA4BC,SAA5B,GAAwCZ,IAAI,CAACa,8BAArE,GAAsG/L,KAA7H,CAPC,CAQD;;AACA,YAAMgM,UAAU,GAAGd,IAAI,CAACe,eAAL,GAAuB,KAAKpK,KAAL,CAAWqK,aAAlC,GAAkDhB,IAAI,CAACG,YAA1E;AACA,YAAMc,SAAS,GAAGjB,IAAI,CAAC5K,UAAL,GAAkB4K,IAAI,CAACe,eAAzC;AACA,YAAMG,SAAS,GAAGxT,GAAG,CAACyT,sBAAJ,CAA2B,KAAKpQ,MAAL,CAAY4O,UAAZ,EAA3B,CAAlB;AACA,YAAMyB,SAAS,GAAG,KAAKrQ,MAAL,CAAYsQ,0BAAZ,CAAuC,KAAKtQ,MAAL,CAAYiM,WAAZ,EAAvC,CAAlB;AACA,YAAMsE,YAAY,GAAGJ,SAAS,CAACK,GAAV,GAAgBH,SAAS,CAACG,GAA1B,GAAgCH,SAAS,CAACrM,MAA/D;AACA,YAAMyM,cAAc,GAAGhM,IAAI,CAACiM,GAAL,CAAS7B,OAAO,CAAC7K,MAAR,GAAiBuM,YAAjB,GAAgCtB,IAAI,CAAC0B,eAA9C,EAA+DZ,UAA/D,CAAvB;AACA,YAAMa,mBAAmB,GAAGT,SAAS,CAACK,GAAV,GAAgBH,SAAS,CAACG,GAA1B,GAAgCvB,IAAI,CAAC0B,eAAjE;AACA,YAAME,cAAc,GAAGpM,IAAI,CAACiM,GAAL,CAASE,mBAAT,EAA8Bb,UAA9B,CAAvB;AACA,UAAIe,SAAS,GAAGrM,IAAI,CAACiM,GAAL,CAASjM,IAAI,CAACsM,GAAL,CAASF,cAAT,EAAyBJ,cAAzB,IAA2CxB,IAAI,CAACG,YAAzD,EAAuEW,UAAvE,CAAhB;;AACA,UAAI/L,MAAM,MAAM,CAAC5D,EAAE,GAAG,KAAKgL,aAAX,MAA8B,IAA9B,IAAsChL,EAAE,KAAK,KAAK,CAAlD,GAAsD,KAAK,CAA3D,GAA+DA,EAAE,CAAC4Q,MAAxE,CAAV,EAA2F;AACvF;AACA;AACAhN,QAAAA,MAAM,GAAG,KAAKoH,aAAL,CAAmB6F,MAA5B;AACH;;AACD,UAAIjN,MAAM,GAAGkM,SAAb,EAAwB;AACpBlM,QAAAA,MAAM,GAAGkM,SAAT;AACH;;AACD,UAAIlM,MAAM,GAAG8M,SAAb,EAAwB;AACpB9M,QAAAA,MAAM,GAAG8M,SAAT;AACH;;AACD,YAAMI,gCAAgC,GAAG,GAAzC;;AACA,UAAIlN,MAAM,GAAGyM,cAAT,IAA4B,KAAK7O,oBAAL,IAA6BgP,mBAAmB,GAAGM,gCAAnF,EAAsH;AAClH,aAAKnO,cAAL,CAAoByM,aAApB,CAAkC;AAAE;AAApC;;AACA,aAAK7M,OAAL,CAAa0M,YAAb,CAA0B,IAA1B,EAAgC,IAAhC,EAAsC,KAAtC,EAA6C,KAA7C;AACAyB,QAAAA,SAAS,GAAGD,cAAZ;AACH,OAJD,MAKK;AACD,aAAK9N,cAAL,CAAoByM,aAApB,CAAkC;AAAE;AAApC;;AACA,aAAK7M,OAAL,CAAa0M,YAAb,CAA0B,KAA1B,EAAiC,IAAjC,EAAuC,IAAvC,EAA6C,KAA7C;AACAyB,QAAAA,SAAS,GAAGL,cAAZ;AACH;;AACD,WAAK9N,OAAL,CAAawO,aAAb,GAA6B,IAAIxU,GAAG,CAAC+D,SAAR,CAAkBiP,cAAlB,EAAkCV,IAAI,CAAC3K,WAAL,CAAiBN,MAAnD,CAA7B;AACA,WAAKrB,OAAL,CAAa4M,OAAb,GAAuB,IAAI5S,GAAG,CAAC+D,SAAR,CAAkB+O,QAAlB,EAA4BqB,SAA5B,CAAvB;AACA,WAAKnO,OAAL,CAAa2M,OAAb,GAAuB,IAAI3S,GAAG,CAAC+D,SAAR,CAAkB,GAAlB,EAAuBwP,SAAvB,CAAvB,CA1CC,CA2CD;AACA;AACA;;AACA,WAAK9E,aAAL,GAAqBpH,MAAM,KAAK+L,UAAX,GACf;AAAEkB,QAAAA,MAAM,EAAE,CAACtN,EAAE,GAAG,CAAC9C,EAAE,GAAG,KAAKuK,aAAX,MAA8B,IAA9B,IAAsCvK,EAAE,KAAK,KAAK,CAAlD,GAAsD,KAAK,CAA3D,GAA+DA,EAAE,CAACoQ,MAAxE,MAAoF,IAApF,IAA4FtN,EAAE,KAAK,KAAK,CAAxG,GAA4GA,EAA5G,GAAiH3C,IAAI,CAACgD,MAAhI;AAAwIgN,QAAAA,MAAM,EAAEhN;AAAhJ,OADe,GAEflD,SAFN;AAGH;;AACD,SAAK+C,OAAL,CAAaE,KAAb,EAAoBC,MAApB;AACH;;AACDH,EAAAA,OAAO,CAACE,KAAD,EAAQC,MAAR,EAAgB;AACnB,UAAM;AAAED,MAAAA,KAAK,EAAE0L,QAAT;AAAmBzL,MAAAA,MAAM,EAAE8M;AAA3B,QAAyC,KAAKnO,OAAL,CAAa4M,OAA5D;AACAxL,IAAAA,KAAK,GAAGU,IAAI,CAACiM,GAAL,CAASjB,QAAT,EAAmB1L,KAAnB,CAAR;AACAC,IAAAA,MAAM,GAAGS,IAAI,CAACiM,GAAL,CAASI,SAAT,EAAoB9M,MAApB,CAAT;AACA,UAAM;AAAEgM,MAAAA;AAAF,QAAsB,KAAKzL,aAAL,EAA5B;;AACA,SAAKqB,KAAL,CAAW2D,MAAX,CAAkBvF,MAAM,GAAGgM,eAA3B,EAA4CjM,KAA5C;;AACA,SAAKiB,YAAL,CAAkBkK,KAAlB,CAAwBlL,MAAxB,GAAkC,GAAEA,MAAM,GAAGgM,eAAgB,IAA7D;AACA,SAAKrN,OAAL,CAAa4G,MAAb,CAAoBvF,MAApB,EAA4BD,KAA5B;;AACA,SAAKhB,cAAL,CAAoBwG,MAApB;;AACA,SAAKyE,gBAAL;AACH;;AACDA,EAAAA,gBAAgB,GAAG;AACf,QAAI5N,EAAJ;;AACA,QAAI,KAAK2G,iBAAL,EAAJ,EAA8B;AAC1B,WAAK1B,QAAL,CAAc+L,aAAd,CAA4B,KAAKzO,OAAL,CAAaC,OAAzC,EAAkD,CAAC,CAACxC,EAAE,GAAG,KAAK2C,cAAL,CAAoBkJ,WAApB,EAAN,MAA6C,IAA7C,IAAqD7L,EAAE,KAAK,KAAK,CAAjE,GAAqE,KAAK,CAA1E,GAA8EA,EAAE,CAACiR,UAAH,CAAc,CAAd,CAA/E,MAAqG;AAAE;AAAzJ;AACH;AACJ;;AACD9M,EAAAA,aAAa,GAAG;AACZ,UAAM+M,QAAQ,GAAG,KAAKtR,MAAL,CAAYwF,SAAZ,CAAsB;AAAG;AAAzB,KAAjB;AACA,UAAMnB,UAAU,GAAGlH,KAAK,CAAC,KAAK6C,MAAL,CAAYwF,SAAZ,CAAsB;AAAI;AAA1B,SAAsD8L,QAAQ,CAACnC,UAAhE,EAA4E,CAA5E,EAA+E,IAA/E,CAAxB;AACA,UAAMa,eAAe,GAAG,CAAC,KAAKhQ,MAAL,CAAYwF,SAAZ,CAAsB;AAAI;AAA1B,MAAyC6B,aAA1C,IAA2D,KAAK5F,MAAL,KAAgB;AAAE;AAA7E,OAA4F,KAAKA,MAAL,KAAgB;AAAE;AAA9G,MAA8H,CAA9H,GAAkI4C,UAA1J;AACA,UAAM8F,WAAW,GAAG,KAAK9E,QAAL,CAAc0D,MAAd,CAAqBoB,WAAzC;AACA,UAAMiF,YAAY,GAAG,IAAIjF,WAAzB;AACA,WAAO;AACH9F,MAAAA,UADG;AAEH2L,MAAAA,eAFG;AAGH7F,MAAAA,WAHG;AAIHiF,MAAAA,YAJG;AAKHU,MAAAA,8BAA8B,EAAEwB,QAAQ,CAACxB,8BALtC;AAMHa,MAAAA,eAAe,EAAE,EANd;AAOHjB,MAAAA,iBAAiB,EAAE,EAPhB;AAQHpL,MAAAA,WAAW,EAAE,IAAI3H,GAAG,CAAC+D,SAAR,CAAkB,GAAlB,EAAuBsP,eAAe,GAAG,KAAK3L,UAAvB,GAAoC+K,YAA3D;AARV,KAAP;AAUH;;AACDrI,EAAAA,iBAAiB,GAAG;AAChB,WAAO,KAAK1F,eAAL,CAAqBkQ,UAArB,CAAgC,sBAAhC,EAAwD;AAAE;AAA1D,MAAwE,KAAxE,CAAP;AACH;;AACD1D,EAAAA,kBAAkB,CAAC/R,KAAD,EAAQ;AACtB,SAAKuF,eAAL,CAAqBN,KAArB,CAA2B,sBAA3B,EAAmDjF,KAAnD,EAA0D;AAAE;AAA5D,MAA0E;AAAE;AAA5E;AACH;;AACD0V,EAAAA,mBAAmB,GAAG;AAClB,QAAI,CAAC,KAAK5P,oBAAV,EAAgC;AAC5B,WAAKA,oBAAL,GAA4B,IAA5B;;AACA,WAAK8J,OAAL,CAAa,KAAKzI,cAAL,CAAoB9C,OAApB,EAAb;AACH;AACJ;;AACDsR,EAAAA,uBAAuB,GAAG;AACtB,SAAK7P,oBAAL,GAA4B,KAA5B;AACH;;AAhpBmC,CAAxC;AAkpBAR,aAAa,CAACkK,eAAd,GAAgC/N,GAAG,CAAC6B,QAAJ,CAAa,uBAAb,EAAsC,YAAtC,CAAhC;AACAgC,aAAa,CAACqK,sBAAd,GAAuClO,GAAG,CAAC6B,QAAJ,CAAa,6BAAb,EAA4C,iBAA5C,CAAvC;AACAgC,aAAa,GAAG/G,UAAU,CAAC,CACvBgB,OAAO,CAAC,CAAD,EAAIqC,eAAJ,CADgB,EAEvBrC,OAAO,CAAC,CAAD,EAAImC,kBAAJ,CAFgB,EAGvBnC,OAAO,CAAC,CAAD,EAAIkD,aAAJ,CAHgB,EAIvBlD,OAAO,CAAC,CAAD,EAAIoC,qBAAJ,CAJgB,CAAD,EAKvB2D,aALuB,CAA1B;AAMA,SAASA,aAAT;AACA,OAAO,MAAM4B,oBAAN,CAA2B;AAC9BlD,EAAAA,WAAW,CAAC4R,OAAD,EAAUC,OAAV,EAAmB;AAC1B,SAAKD,OAAL,GAAeA,OAAf;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKC,mBAAL,GAA2B,IAA3B;AACA,SAAKC,iBAAL,GAAyB,KAAzB;AACA,SAAKC,iBAAL,GAAyB,KAAzB;AACA,SAAKC,MAAL,GAAc,KAAd;AACA,SAAKC,OAAL,GAAe,KAAf;AACH;;AACD9I,EAAAA,OAAO,GAAG;AACN,QAAI,KAAK6I,MAAT,EAAiB;AACb,WAAKA,MAAL,GAAc,KAAd;;AACA,WAAKJ,OAAL,CAAaM,mBAAb,CAAiC,IAAjC;AACH;AACJ;;AACDC,EAAAA,KAAK,GAAG;AACJ,WAAO,6BAAP;AACH;;AACDtD,EAAAA,UAAU,GAAG;AACT,WAAO,KAAK8C,OAAL,CAAa/O,OAAb,CAAqBC,OAA5B;AACH;;AACD2I,EAAAA,IAAI,GAAG;AACH,SAAKyG,OAAL,GAAe,KAAf;;AACA,QAAI,CAAC,KAAKD,MAAV,EAAkB;AACd,WAAKA,MAAL,GAAc,IAAd;;AACA,WAAKJ,OAAL,CAAaQ,gBAAb,CAA8B,IAA9B;AACH;AACJ;;AACDhH,EAAAA,IAAI,GAAG;AACH,QAAI,CAAC,KAAK6G,OAAV,EAAmB;AACf,WAAKA,OAAL,GAAe,IAAf;AACA,WAAKzI,MAAL;AACH;AACJ;;AACDA,EAAAA,MAAM,GAAG;AACL,SAAKoI,OAAL,CAAaS,mBAAb,CAAiC,IAAjC;AACH;;AACDnG,EAAAA,WAAW,GAAG;AACV,QAAI,KAAK+F,OAAL,IAAgB,CAAC,KAAKK,SAAtB,IAAmC,CAAC,KAAKC,WAA7C,EAA0D;AACtD,aAAO,IAAP;AACH;;AACD,WAAO;AACH5D,MAAAA,QAAQ,EAAE,KAAK2D,SADZ;AAEHhB,MAAAA,UAAU,EAAE,CAAC,KAAKiB,WAAN;AAFT,KAAP;AAIH;;AACDC,EAAAA,YAAY,GAAG;AACX,UAAM;AAAEvO,MAAAA,MAAF;AAAUD,MAAAA;AAAV,QAAoB,KAAK2N,OAAL,CAAa/O,OAAb,CAAqB3B,IAA/C;;AACA,UAAM;AAAEmJ,MAAAA,WAAF;AAAeuF,MAAAA;AAAf,QAAqC,KAAKgC,OAAL,CAAanN,aAAb,EAA3C;;AACA,WAAO,IAAI5H,GAAG,CAAC+D,SAAR,CAAkBqD,KAAK,GAAG,IAAIoG,WAAZ,GAA0BuF,iBAA5C,EAA+D1L,MAAM,GAAG,IAAImG,WAA5E,CAAP;AACH;;AACDqI,EAAAA,WAAW,CAAC9D,QAAD,EAAW;AAClB,SAAKgD,OAAL,CAAajD,YAAb,CAA0BC,QAA1B;AACH;;AACDc,EAAAA,aAAa,CAAC6B,UAAD,EAAa;AACtB,QAAI,CAAC,KAAKS,iBAAV,EAA6B;AACzB,WAAKQ,WAAL,GAAmBjB,UAAnB;AACH;AACJ;;AACD5N,EAAAA,cAAc,GAAG;AACb,SAAKqO,iBAAL,GAAyB,IAAzB;AACH;;AACDlN,EAAAA,gBAAgB,GAAG;AACf,SAAKkN,iBAAL,GAAyB,KAAzB;AACH;;AACD9F,EAAAA,WAAW,CAAC0C,QAAD,EAAW;AAClB,SAAK2D,SAAL,GAAiB3D,QAAjB;AACH;;AApE6B","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { attachListStyler } from '../../../../platform/theme/common/styler.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from './resizable.js';\nimport { Context as SuggestContext } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\n/**\n * Suggest widget colors\n */\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexport const editorSuggestWidgetSelectedForeground = registerColor('editorSuggestWidget.selectedForeground', { dark: quickInputListFocusForeground, light: quickInputListFocusForeground, hc: quickInputListFocusForeground }, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedIconForeground = registerColor('editorSuggestWidget.selectedIconForeground', { dark: quickInputListFocusIconForeground, light: quickInputListFocusIconForeground, hc: quickInputListFocusIconForeground }, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hc: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nexport const editorSuggestWidgetHighlightFocusForeground = registerColor('editorSuggestWidget.focusHighlightForeground', { dark: listFocusHighlightForeground, light: listFocusHighlightForeground, hc: listFocusHighlightForeground }, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nexport const editorSuggestWidgetStatusForeground = registerColor('editorSuggestWidgetStatus.foreground', { dark: transparent(editorSuggestWidgetForeground, .5), light: transparent(editorSuggestWidgetForeground, .5), hc: transparent(editorSuggestWidgetForeground, .5) }, nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\nclass PersistedWidgetSize {\n    constructor(_service, editor) {\n        this._service = _service;\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n    }\n    restore() {\n        var _a;\n        const raw = (_a = this._service.get(this._key, 0 /* GLOBAL */)) !== null && _a !== void 0 ? _a : '';\n        try {\n            const obj = JSON.parse(raw);\n            if (dom.Dimension.is(obj)) {\n                return dom.Dimension.lift(obj);\n            }\n        }\n        catch (_b) {\n            // ignore\n        }\n        return undefined;\n    }\n    store(size) {\n        this._service.store(this._key, JSON.stringify(size), 0 /* GLOBAL */, 1 /* MACHINE */);\n    }\n    reset() {\n        this._service.remove(this._key, 0 /* GLOBAL */);\n    }\n}\nlet SuggestWidget = class SuggestWidget {\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n        this.editor = editor;\n        this._storageService = _storageService;\n        this._state = 0 /* Hidden */;\n        this._isAuto = false;\n        this._ignoreFocusEvents = false;\n        this._forceRenderingAbove = false;\n        this._explainMode = false;\n        this._showTimeout = new TimeoutTimer();\n        this._disposables = new DisposableStore();\n        this._onDidSelect = new Emitter();\n        this._onDidFocus = new Emitter();\n        this._onDidHide = new Emitter();\n        this._onDidShow = new Emitter();\n        this.onDidSelect = this._onDidSelect.event;\n        this.onDidFocus = this._onDidFocus.event;\n        this.onDidHide = this._onDidHide.event;\n        this.onDidShow = this._onDidShow.event;\n        this._onDetailsKeydown = new Emitter();\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\n        this.element = new ResizableHTMLElement();\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n        this._contentWidget = new SuggestContentWidget(this, editor);\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n        class ResizeState {\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n                this.persistedSize = persistedSize;\n                this.currentSize = currentSize;\n                this.persistHeight = persistHeight;\n                this.persistWidth = persistWidth;\n            }\n        }\n        let state;\n        this._disposables.add(this.element.onDidWillResize(() => {\n            this._contentWidget.lockPreference();\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\n        }));\n        this._disposables.add(this.element.onDidResize(e => {\n            var _a, _b, _c, _d;\n            this._resize(e.dimension.width, e.dimension.height);\n            if (state) {\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n            }\n            if (!e.done) {\n                return;\n            }\n            if (state) {\n                // only store width or height value that have changed and also\n                // only store changes that are above a certain threshold\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\n                const threshold = Math.round(itemHeight / 2);\n                let { width, height } = this.element.size;\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n                }\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n                }\n                this._persistedSize.store(new dom.Dimension(width, height));\n            }\n            // reset working state\n            this._contentWidget.unlockPreference();\n            state = undefined;\n        }));\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n        const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\n        details.onDidClose(this.toggleDetails, this, this._disposables);\n        this._details = new SuggestDetailsOverlay(details, this.editor);\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(106 /* suggest */).showIcons);\n        applyIconStyle();\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n        this._disposables.add(renderer);\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n        this._list = new List('SuggestWidget', this._listElement, {\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\n            getTemplateId: (_element) => 'suggestion'\n        }, [renderer], {\n            alwaysConsumeMouseWheel: true,\n            useShadows: false,\n            mouseSupport: false,\n            accessibilityProvider: {\n                getRole: () => 'option',\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n                getWidgetRole: () => 'listbox',\n                getAriaLabel: (item) => {\n                    let label = item.textLabel;\n                    if (typeof item.completion.label !== 'string') {\n                        const { detail, description } = item.completion.label;\n                        if (detail && description) {\n                            label = nls.localize('label.full', '{0}{1}, {2}', label, detail, description);\n                        }\n                        else if (detail) {\n                            label = nls.localize('label.detail', '{0}{1}', label, detail);\n                        }\n                        else if (description) {\n                            label = nls.localize('label.desc', '{0}, {1}', label, description);\n                        }\n                    }\n                    if (!item.isResolved || !this._isDetailsVisible()) {\n                        return label;\n                    }\n                    const { documentation, detail } = item.completion;\n                    const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n                    return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n                },\n            }\n        });\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(106 /* suggest */).showStatusBar);\n        applyStatusBarStyle();\n        this._disposables.add(attachListStyler(this._list, _themeService, {\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n            listInactiveFocusOutline: activeContrastBorder\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n        this._onThemeChange(_themeService.getColorTheme());\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(106 /* suggest */)) {\n                applyStatusBarStyle();\n                applyIconStyle();\n            }\n        }));\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n            this._onDetailsKeydown.fire(e);\n        }));\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n    }\n    dispose() {\n        var _a;\n        this._details.widget.dispose();\n        this._details.dispose();\n        this._list.dispose();\n        this._status.dispose();\n        this._disposables.dispose();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._showTimeout.dispose();\n        this._contentWidget.dispose();\n        this.element.dispose();\n    }\n    _onEditorMouseDown(mouseEvent) {\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n            // Clicking inside details\n            this._details.widget.domNode.focus();\n        }\n        else {\n            // Clicking outside details and inside suggest\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\n                this.editor.focus();\n            }\n        }\n    }\n    _onCursorSelectionChanged() {\n        if (this._state !== 0 /* Hidden */) {\n            this._contentWidget.layout();\n        }\n    }\n    _onListMouseDownOrTap(e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this._select(e.element, e.index);\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            this._select(e.elements[0], e.indexes[0]);\n        }\n    }\n    _select(item, index) {\n        const completionModel = this._completionModel;\n        if (completionModel) {\n            this._onDidSelect.fire({ item, index, model: completionModel });\n            this.editor.focus();\n        }\n    }\n    _onThemeChange(theme) {\n        this._details.widget.borderWidth = theme.type === 'hc' ? 2 : 1;\n    }\n    _onListFocus(e) {\n        var _a;\n        if (this._ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this._currentSuggestionDetails) {\n                this._currentSuggestionDetails.cancel();\n                this._currentSuggestionDetails = undefined;\n                this._focusedItem = undefined;\n            }\n            this.editor.setAriaOptions({ activeDescendant: undefined });\n            return;\n        }\n        if (!this._completionModel) {\n            return;\n        }\n        const item = e.elements[0];\n        const index = e.indexes[0];\n        if (item !== this._focusedItem) {\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._currentSuggestionDetails = undefined;\n            this._focusedItem = item;\n            this._list.reveal(index);\n            this._currentSuggestionDetails = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                const loading = disposableTimeout(() => {\n                    if (this._isDetailsVisible()) {\n                        this.showDetails(true);\n                    }\n                }, 250);\n                token.onCancellationRequested(() => loading.dispose());\n                const result = yield item.resolve(token);\n                loading.dispose();\n                return result;\n            }));\n            this._currentSuggestionDetails.then(() => {\n                if (index >= this._list.length || item !== this._list.element(index)) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                this._ignoreFocusEvents = true;\n                this._list.splice(index, 1, [item]);\n                this._list.setFocus([index]);\n                this._ignoreFocusEvents = false;\n                if (this._isDetailsVisible()) {\n                    this.showDetails(false);\n                }\n                else {\n                    this.element.domNode.classList.remove('docs-side');\n                }\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n            }).catch(onUnexpectedError);\n        }\n        // emit an event\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\n    }\n    _setState(state) {\n        if (this._state === state) {\n            return;\n        }\n        this._state = state;\n        this.element.domNode.classList.toggle('frozen', state === 4 /* Frozen */);\n        this.element.domNode.classList.remove('message');\n        switch (state) {\n            case 0 /* Hidden */:\n                dom.hide(this._messageElement, this._listElement, this._status.element);\n                this._details.hide(true);\n                this._status.hide();\n                this._contentWidget.hide();\n                this._ctxSuggestWidgetVisible.reset();\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\n                this._showTimeout.cancel();\n                this.element.domNode.classList.remove('visible');\n                this._list.splice(0, this._list.length);\n                this._focusedItem = undefined;\n                this._cappedHeight = undefined;\n                this._explainMode = false;\n                break;\n            case 1 /* Loading */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                break;\n            case 2 /* Empty */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                break;\n            case 3 /* Open */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 4 /* Frozen */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 5 /* Details */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._details.show();\n                this._show();\n                break;\n        }\n    }\n    _show() {\n        this._status.show();\n        this._contentWidget.show();\n        this._layout(this._persistedSize.restore());\n        this._ctxSuggestWidgetVisible.set(true);\n        this._showTimeout.cancelAndSet(() => {\n            this.element.domNode.classList.add('visible');\n            this._onDidShow.fire(this);\n        }, 100);\n    }\n    showTriggered(auto, delay) {\n        if (this._state !== 0 /* Hidden */) {\n            return;\n        }\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._isAuto = !!auto;\n        if (!this._isAuto) {\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* Loading */), delay);\n        }\n    }\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto) {\n        var _a, _b;\n        this._contentWidget.setPosition(this.editor.getPosition());\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._currentSuggestionDetails = undefined;\n        if (this._completionModel !== completionModel) {\n            this._completionModel = completionModel;\n        }\n        if (isFrozen && this._state !== 2 /* Empty */ && this._state !== 0 /* Hidden */) {\n            this._setState(4 /* Frozen */);\n            return;\n        }\n        const visibleCount = this._completionModel.items.length;\n        const isEmpty = visibleCount === 0;\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            this._setState(isAuto ? 0 /* Hidden */ : 2 /* Empty */);\n            this._completionModel = undefined;\n            return;\n        }\n        this._focusedItem = undefined;\n        this._list.splice(0, this._list.length, this._completionModel.items);\n        this._setState(isFrozen ? 4 /* Frozen */ : 3 /* Open */);\n        this._list.reveal(selectionIndex, 0);\n        this._list.setFocus([selectionIndex]);\n        this._layout(this.element.size);\n        // Reset focus border\n        this._details.widget.domNode.classList.remove('focused');\n    }\n    selectNextPage() {\n        switch (this._state) {\n            case 0 /* Hidden */:\n                return false;\n            case 5 /* Details */:\n                this._details.widget.pageDown();\n                return true;\n            case 1 /* Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNextPage();\n                return true;\n        }\n    }\n    selectNext() {\n        switch (this._state) {\n            case 0 /* Hidden */:\n                return false;\n            case 1 /* Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNext(1, true);\n                return true;\n        }\n    }\n    selectLast() {\n        switch (this._state) {\n            case 0 /* Hidden */:\n                return false;\n            case 5 /* Details */:\n                this._details.widget.scrollBottom();\n                return true;\n            case 1 /* Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusLast();\n                return true;\n        }\n    }\n    selectPreviousPage() {\n        switch (this._state) {\n            case 0 /* Hidden */:\n                return false;\n            case 5 /* Details */:\n                this._details.widget.pageUp();\n                return true;\n            case 1 /* Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPreviousPage();\n                return true;\n        }\n    }\n    selectPrevious() {\n        switch (this._state) {\n            case 0 /* Hidden */:\n                return false;\n            case 1 /* Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPrevious(1, true);\n                return false;\n        }\n    }\n    selectFirst() {\n        switch (this._state) {\n            case 0 /* Hidden */:\n                return false;\n            case 5 /* Details */:\n                this._details.widget.scrollTop();\n                return true;\n            case 1 /* Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusFirst();\n                return true;\n        }\n    }\n    getFocusedItem() {\n        if (this._state !== 0 /* Hidden */\n            && this._state !== 2 /* Empty */\n            && this._state !== 1 /* Loading */\n            && this._completionModel) {\n            return {\n                item: this._list.getFocusedElements()[0],\n                index: this._list.getFocus()[0],\n                model: this._completionModel\n            };\n        }\n        return undefined;\n    }\n    toggleDetailsFocus() {\n        if (this._state === 5 /* Details */) {\n            this._setState(3 /* Open */);\n            this._details.widget.domNode.classList.remove('focused');\n        }\n        else if (this._state === 3 /* Open */ && this._isDetailsVisible()) {\n            this._setState(5 /* Details */);\n            this._details.widget.domNode.classList.add('focused');\n        }\n    }\n    toggleDetails() {\n        if (this._isDetailsVisible()) {\n            // hide details widget\n            this._ctxSuggestWidgetDetailsVisible.set(false);\n            this._setDetailsVisible(false);\n            this._details.hide();\n            this.element.domNode.classList.remove('shows-details');\n        }\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* Open */ || this._state === 5 /* Details */ || this._state === 4 /* Frozen */)) {\n            // show details widget (iff possible)\n            this._ctxSuggestWidgetDetailsVisible.set(true);\n            this._setDetailsVisible(true);\n            this.showDetails(false);\n        }\n    }\n    showDetails(loading) {\n        this._details.show();\n        if (loading) {\n            this._details.widget.renderLoading();\n        }\n        else {\n            this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n        }\n        this._positionDetails();\n        this.editor.focus();\n        this.element.domNode.classList.add('shows-details');\n    }\n    toggleExplainMode() {\n        if (this._list.getFocusedElements()[0]) {\n            this._explainMode = !this._explainMode;\n            if (!this._isDetailsVisible()) {\n                this.toggleDetails();\n            }\n            else {\n                this.showDetails(false);\n            }\n        }\n    }\n    resetPersistedSize() {\n        this._persistedSize.reset();\n    }\n    hideWidget() {\n        var _a;\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._setState(0 /* Hidden */);\n        this._onDidHide.fire(this);\n        this.element.clearSashHoverState();\n        // ensure that a reasonable widget height is persisted so that\n        // accidential \"resize-to-single-items\" cases aren't happening\n        const dim = this._persistedSize.restore();\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n        if (dim && dim.height < minPersistedHeight) {\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n        }\n    }\n    isFrozen() {\n        return this._state === 4 /* Frozen */;\n    }\n    _afterRender(position) {\n        if (position === null) {\n            if (this._isDetailsVisible()) {\n                this._details.hide(); //todo@jrieken soft-hide\n            }\n            return;\n        }\n        if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\n            // no special positioning when widget isn't showing list\n            return;\n        }\n        if (this._isDetailsVisible()) {\n            this._details.show();\n        }\n        this._positionDetails();\n    }\n    _layout(size) {\n        var _a, _b, _c;\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (!this.editor.getDomNode()) {\n            // happens when running tests\n            return;\n        }\n        const bodyBox = dom.getClientArea(document.body);\n        const info = this.getLayoutInfo();\n        if (!size) {\n            size = info.defaultSize;\n        }\n        let height = size.height;\n        let width = size.width;\n        // status bar\n        this._status.element.style.lineHeight = `${info.itemHeight}px`;\n        if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\n            // showing a message only\n            height = info.itemHeight + info.borderHeight;\n            width = info.defaultSize.width / 2;\n            this.element.enableSashes(false, false, false, false);\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n            this._contentWidget.setPreference(2 /* BELOW */);\n        }\n        else {\n            // showing items\n            // width math\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n            if (width > maxWidth) {\n                width = maxWidth;\n            }\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n            // height math\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n            const minHeight = info.itemHeight + info.statusBarHeight;\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n            const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n            const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n                // Restore the old (wanted) height when the current\n                // height is capped to fit\n                height = this._cappedHeight.wanted;\n            }\n            if (height < minHeight) {\n                height = minHeight;\n            }\n            if (height > maxHeight) {\n                height = maxHeight;\n            }\n            const forceRenderingAboveRequiredSpace = 150;\n            if (height > maxHeightBelow || (this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace)) {\n                this._contentWidget.setPreference(1 /* ABOVE */);\n                this.element.enableSashes(true, true, false, false);\n                maxHeight = maxHeightAbove;\n            }\n            else {\n                this._contentWidget.setPreference(2 /* BELOW */);\n                this.element.enableSashes(false, true, true, false);\n                maxHeight = maxHeightBelow;\n            }\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n            this.element.minSize = new dom.Dimension(220, minHeight);\n            // Know when the height was capped to fit and remember\n            // the wanted height for later. This is required when going\n            // left to widen suggestions.\n            this._cappedHeight = height === fullHeight\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\n                : undefined;\n        }\n        this._resize(width, height);\n    }\n    _resize(width, height) {\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\n        width = Math.min(maxWidth, width);\n        height = Math.min(maxHeight, height);\n        const { statusBarHeight } = this.getLayoutInfo();\n        this._list.layout(height - statusBarHeight, width);\n        this._listElement.style.height = `${height - statusBarHeight}px`;\n        this.element.layout(height, width);\n        this._contentWidget.layout();\n        this._positionDetails();\n    }\n    _positionDetails() {\n        var _a;\n        if (this._isDetailsVisible()) {\n            this._details.placeAtAnchor(this.element.domNode, ((_a = this._contentWidget.getPosition()) === null || _a === void 0 ? void 0 : _a.preference[0]) === 2 /* BELOW */);\n        }\n    }\n    getLayoutInfo() {\n        const fontInfo = this.editor.getOption(44 /* fontInfo */);\n        const itemHeight = clamp(this.editor.getOption(108 /* suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n        const statusBarHeight = !this.editor.getOption(106 /* suggest */).showStatusBar || this._state === 2 /* Empty */ || this._state === 1 /* Loading */ ? 0 : itemHeight;\n        const borderWidth = this._details.widget.borderWidth;\n        const borderHeight = 2 * borderWidth;\n        return {\n            itemHeight,\n            statusBarHeight,\n            borderWidth,\n            borderHeight,\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n            verticalPadding: 22,\n            horizontalPadding: 14,\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n        };\n    }\n    _isDetailsVisible() {\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* GLOBAL */, false);\n    }\n    _setDetailsVisible(value) {\n        this._storageService.store('expandSuggestionDocs', value, 0 /* GLOBAL */, 0 /* USER */);\n    }\n    forceRenderingAbove() {\n        if (!this._forceRenderingAbove) {\n            this._forceRenderingAbove = true;\n            this._layout(this._persistedSize.restore());\n        }\n    }\n    stopForceRenderingAbove() {\n        this._forceRenderingAbove = false;\n    }\n};\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = __decorate([\n    __param(1, IStorageService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IInstantiationService)\n], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n    constructor(_widget, _editor) {\n        this._widget = _widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._preferenceLocked = false;\n        this._added = false;\n        this._hidden = false;\n    }\n    dispose() {\n        if (this._added) {\n            this._added = false;\n            this._editor.removeContentWidget(this);\n        }\n    }\n    getId() {\n        return 'editor.widget.suggestWidget';\n    }\n    getDomNode() {\n        return this._widget.element.domNode;\n    }\n    show() {\n        this._hidden = false;\n        if (!this._added) {\n            this._added = true;\n            this._editor.addContentWidget(this);\n        }\n    }\n    hide() {\n        if (!this._hidden) {\n            this._hidden = true;\n            this.layout();\n        }\n    }\n    layout() {\n        this._editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this._hidden || !this._position || !this._preference) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [this._preference]\n        };\n    }\n    beforeRender() {\n        const { height, width } = this._widget.element.size;\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n    }\n    afterRender(position) {\n        this._widget._afterRender(position);\n    }\n    setPreference(preference) {\n        if (!this._preferenceLocked) {\n            this._preference = preference;\n        }\n    }\n    lockPreference() {\n        this._preferenceLocked = true;\n    }\n    unlockPreference() {\n        this._preferenceLocked = false;\n    }\n    setPosition(position) {\n        this._position = position;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}