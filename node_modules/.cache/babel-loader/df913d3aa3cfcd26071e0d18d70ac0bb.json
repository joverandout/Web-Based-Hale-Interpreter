{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, Delayer, first } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { isCancellationError, onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { LinkedEditingRangeProviderRegistry } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nexport const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE = new RawContextKey('LinkedEditingInputVisible', false);\nconst DECORATION_CLASS_NAME = 'linked-editing-decoration';\nlet LinkedEditingContribution = class LinkedEditingContribution extends Disposable {\n  constructor(editor, contextKeyService, languageConfigurationService) {\n    super();\n    this.languageConfigurationService = languageConfigurationService;\n    this._debounceDuration = 200;\n    this._localToDispose = this._register(new DisposableStore());\n    this._editor = editor;\n    this._enabled = false;\n    this._visibleContextKey = CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n    this._currentDecorations = [];\n    this._languageWordPattern = null;\n    this._currentWordPattern = null;\n    this._ignoreChangeEvent = false;\n    this._localToDispose = this._register(new DisposableStore());\n    this._rangeUpdateTriggerPromise = null;\n    this._rangeSyncTriggerPromise = null;\n    this._currentRequest = null;\n    this._currentRequestPosition = null;\n    this._currentRequestModelVersion = null;\n\n    this._register(this._editor.onDidChangeModel(() => this.reinitialize(true)));\n\n    this._register(this._editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(62\n      /* linkedEditing */\n      ) || e.hasChanged(82\n      /* renameOnType */\n      )) {\n        this.reinitialize(false);\n      }\n    }));\n\n    this._register(LinkedEditingRangeProviderRegistry.onDidChange(() => this.reinitialize(false)));\n\n    this._register(this._editor.onDidChangeModelLanguage(() => this.reinitialize(true)));\n\n    this.reinitialize(true);\n  }\n\n  static get(editor) {\n    return editor.getContribution(LinkedEditingContribution.ID);\n  }\n\n  reinitialize(forceRefresh) {\n    const model = this._editor.getModel();\n\n    const isEnabled = model !== null && (this._editor.getOption(62\n    /* linkedEditing */\n    ) || this._editor.getOption(82\n    /* renameOnType */\n    )) && LinkedEditingRangeProviderRegistry.has(model);\n\n    if (isEnabled === this._enabled && !forceRefresh) {\n      return;\n    }\n\n    this._enabled = isEnabled;\n    this.clearRanges();\n\n    this._localToDispose.clear();\n\n    if (!isEnabled || model === null) {\n      return;\n    }\n\n    this._localToDispose.add(Event.runAndSubscribe(model.onDidChangeLanguageConfiguration, () => {\n      this._languageWordPattern = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n    }));\n\n    const rangeUpdateScheduler = new Delayer(this._debounceDuration);\n\n    const triggerRangeUpdate = () => {\n      this._rangeUpdateTriggerPromise = rangeUpdateScheduler.trigger(() => this.updateRanges(), this._debounceDuration);\n    };\n\n    const rangeSyncScheduler = new Delayer(0);\n\n    const triggerRangeSync = decorations => {\n      this._rangeSyncTriggerPromise = rangeSyncScheduler.trigger(() => this._syncRanges(decorations));\n    };\n\n    this._localToDispose.add(this._editor.onDidChangeCursorPosition(() => {\n      triggerRangeUpdate();\n    }));\n\n    this._localToDispose.add(this._editor.onDidChangeModelContent(e => {\n      if (!this._ignoreChangeEvent) {\n        if (this._currentDecorations.length > 0) {\n          const referenceRange = model.getDecorationRange(this._currentDecorations[0]);\n\n          if (referenceRange && e.changes.every(c => referenceRange.intersectRanges(c.range))) {\n            triggerRangeSync(this._currentDecorations);\n            return;\n          }\n        }\n      }\n\n      triggerRangeUpdate();\n    }));\n\n    this._localToDispose.add({\n      dispose: () => {\n        rangeUpdateScheduler.cancel();\n        rangeSyncScheduler.cancel();\n      }\n    });\n\n    this.updateRanges();\n  }\n\n  _syncRanges(decorations) {\n    // dalayed invocation, make sure we're still on\n    if (!this._editor.hasModel() || decorations !== this._currentDecorations || decorations.length === 0) {\n      // nothing to do\n      return;\n    }\n\n    const model = this._editor.getModel();\n\n    const referenceRange = model.getDecorationRange(decorations[0]);\n\n    if (!referenceRange || referenceRange.startLineNumber !== referenceRange.endLineNumber) {\n      return this.clearRanges();\n    }\n\n    const referenceValue = model.getValueInRange(referenceRange);\n\n    if (this._currentWordPattern) {\n      const match = referenceValue.match(this._currentWordPattern);\n      const matchLength = match ? match[0].length : 0;\n\n      if (matchLength !== referenceValue.length) {\n        return this.clearRanges();\n      }\n    }\n\n    let edits = [];\n\n    for (let i = 1, len = decorations.length; i < len; i++) {\n      const mirrorRange = model.getDecorationRange(decorations[i]);\n\n      if (!mirrorRange) {\n        continue;\n      }\n\n      if (mirrorRange.startLineNumber !== mirrorRange.endLineNumber) {\n        edits.push({\n          range: mirrorRange,\n          text: referenceValue\n        });\n      } else {\n        let oldValue = model.getValueInRange(mirrorRange);\n        let newValue = referenceValue;\n        let rangeStartColumn = mirrorRange.startColumn;\n        let rangeEndColumn = mirrorRange.endColumn;\n        const commonPrefixLength = strings.commonPrefixLength(oldValue, newValue);\n        rangeStartColumn += commonPrefixLength;\n        oldValue = oldValue.substr(commonPrefixLength);\n        newValue = newValue.substr(commonPrefixLength);\n        const commonSuffixLength = strings.commonSuffixLength(oldValue, newValue);\n        rangeEndColumn -= commonSuffixLength;\n        oldValue = oldValue.substr(0, oldValue.length - commonSuffixLength);\n        newValue = newValue.substr(0, newValue.length - commonSuffixLength);\n\n        if (rangeStartColumn !== rangeEndColumn || newValue.length !== 0) {\n          edits.push({\n            range: new Range(mirrorRange.startLineNumber, rangeStartColumn, mirrorRange.endLineNumber, rangeEndColumn),\n            text: newValue\n          });\n        }\n      }\n    }\n\n    if (edits.length === 0) {\n      return;\n    }\n\n    try {\n      this._editor.popUndoStop();\n\n      this._ignoreChangeEvent = true;\n\n      const prevEditOperationType = this._editor._getViewModel().getPrevEditOperationType();\n\n      this._editor.executeEdits('linkedEditing', edits);\n\n      this._editor._getViewModel().setPrevEditOperationType(prevEditOperationType);\n    } finally {\n      this._ignoreChangeEvent = false;\n    }\n  }\n\n  dispose() {\n    this.clearRanges();\n    super.dispose();\n  }\n\n  clearRanges() {\n    this._visibleContextKey.set(false);\n\n    this._currentDecorations = this._editor.deltaDecorations(this._currentDecorations, []);\n\n    if (this._currentRequest) {\n      this._currentRequest.cancel();\n\n      this._currentRequest = null;\n      this._currentRequestPosition = null;\n    }\n  }\n\n  updateRanges(force = false) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this._editor.hasModel()) {\n        this.clearRanges();\n        return;\n      }\n\n      const position = this._editor.getPosition();\n\n      if (!this._enabled && !force || this._editor.getSelections().length > 1) {\n        // disabled or multicursor\n        this.clearRanges();\n        return;\n      }\n\n      const model = this._editor.getModel();\n\n      const modelVersionId = model.getVersionId();\n\n      if (this._currentRequestPosition && this._currentRequestModelVersion === modelVersionId) {\n        if (position.equals(this._currentRequestPosition)) {\n          return; // same position\n        }\n\n        if (this._currentDecorations && this._currentDecorations.length > 0) {\n          const range = model.getDecorationRange(this._currentDecorations[0]);\n\n          if (range && range.containsPosition(position)) {\n            return; // just moving inside the existing primary range\n          }\n        }\n      }\n\n      this._currentRequestPosition = position;\n      this._currentRequestModelVersion = modelVersionId;\n      const request = createCancelablePromise(token => __awaiter(this, void 0, void 0, function* () {\n        try {\n          const response = yield getLinkedEditingRanges(model, position, token);\n\n          if (request !== this._currentRequest) {\n            return;\n          }\n\n          this._currentRequest = null;\n\n          if (modelVersionId !== model.getVersionId()) {\n            return;\n          }\n\n          let ranges = [];\n\n          if (response === null || response === void 0 ? void 0 : response.ranges) {\n            ranges = response.ranges;\n          }\n\n          this._currentWordPattern = (response === null || response === void 0 ? void 0 : response.wordPattern) || this._languageWordPattern;\n          let foundReferenceRange = false;\n\n          for (let i = 0, len = ranges.length; i < len; i++) {\n            if (Range.containsPosition(ranges[i], position)) {\n              foundReferenceRange = true;\n\n              if (i !== 0) {\n                const referenceRange = ranges[i];\n                ranges.splice(i, 1);\n                ranges.unshift(referenceRange);\n              }\n\n              break;\n            }\n          }\n\n          if (!foundReferenceRange) {\n            // Cannot do linked editing if the ranges are not where the cursor is...\n            this.clearRanges();\n            return;\n          }\n\n          const decorations = ranges.map(range => ({\n            range: range,\n            options: LinkedEditingContribution.DECORATION\n          }));\n\n          this._visibleContextKey.set(true);\n\n          this._currentDecorations = this._editor.deltaDecorations(this._currentDecorations, decorations);\n        } catch (err) {\n          if (!isCancellationError(err)) {\n            onUnexpectedError(err);\n          }\n\n          if (this._currentRequest === request || !this._currentRequest) {\n            // stop if we are still the latest request\n            this.clearRanges();\n          }\n        }\n      }));\n      this._currentRequest = request;\n      return request;\n    });\n  }\n\n};\nLinkedEditingContribution.ID = 'editor.contrib.linkedEditing';\nLinkedEditingContribution.DECORATION = ModelDecorationOptions.register({\n  description: 'linked-editing',\n  stickiness: 0\n  /* AlwaysGrowsWhenTypingAtEdges */\n  ,\n  className: DECORATION_CLASS_NAME\n});\nLinkedEditingContribution = __decorate([__param(1, IContextKeyService), __param(2, ILanguageConfigurationService)], LinkedEditingContribution);\nexport { LinkedEditingContribution };\nexport class LinkedEditingAction extends EditorAction {\n  constructor() {\n    super({\n      id: 'editor.action.linkedEditing',\n      label: nls.localize('linkedEditing.label', \"Start Linked Editing\"),\n      alias: 'Start Linked Editing',\n      precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2048\n        /* CtrlCmd */\n        | 1024\n        /* Shift */\n        | 60\n        /* F2 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    });\n  }\n\n  runCommand(accessor, args) {\n    const editorService = accessor.get(ICodeEditorService);\n    const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n\n    if (URI.isUri(uri) && Position.isIPosition(pos)) {\n      return editorService.openCodeEditor({\n        resource: uri\n      }, editorService.getActiveCodeEditor()).then(editor => {\n        if (!editor) {\n          return;\n        }\n\n        editor.setPosition(pos);\n        editor.invokeWithinContext(accessor => {\n          this.reportTelemetry(accessor, editor);\n          return this.run(accessor, editor);\n        });\n      }, onUnexpectedError);\n    }\n\n    return super.runCommand(accessor, args);\n  }\n\n  run(_accessor, editor) {\n    const controller = LinkedEditingContribution.get(editor);\n\n    if (controller) {\n      return Promise.resolve(controller.updateRanges(true));\n    }\n\n    return Promise.resolve();\n  }\n\n}\nconst LinkedEditingCommand = EditorCommand.bindToContribution(LinkedEditingContribution.get);\nregisterEditorCommand(new LinkedEditingCommand({\n  id: 'cancelLinkedEditingInput',\n  precondition: CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,\n  handler: x => x.clearRanges(),\n  kbOpts: {\n    kbExpr: EditorContextKeys.editorTextFocus,\n    weight: 100\n    /* EditorContrib */\n    + 99,\n    primary: 9\n    /* Escape */\n    ,\n    secondary: [1024\n    /* Shift */\n    | 9\n    /* Escape */\n    ]\n  }\n}));\n\nfunction getLinkedEditingRanges(model, position, token) {\n  const orderedByScore = LinkedEditingRangeProviderRegistry.ordered(model); // in order of score ask the linked editing range provider\n  // until someone response with a good result\n  // (good = not null)\n\n  return first(orderedByScore.map(provider => () => __awaiter(this, void 0, void 0, function* () {\n    try {\n      return yield provider.provideLinkedEditingRanges(model, position, token);\n    } catch (e) {\n      onUnexpectedExternalError(e);\n      return undefined;\n    }\n  })), result => !!result && arrays.isNonEmptyArray(result === null || result === void 0 ? void 0 : result.ranges));\n}\n\nexport const editorLinkedEditingBackground = registerColor('editor.linkedEditingBackground', {\n  dark: Color.fromHex('#f00').transparent(0.3),\n  light: Color.fromHex('#f00').transparent(0.3),\n  hc: Color.fromHex('#f00').transparent(0.3)\n}, nls.localize('editorLinkedEditingBackground', 'Background color when the editor auto renames on type.'));\nregisterThemingParticipant((theme, collector) => {\n  const editorLinkedEditingBackgroundColor = theme.getColor(editorLinkedEditingBackground);\n\n  if (editorLinkedEditingBackgroundColor) {\n    collector.addRule(`.monaco-editor .${DECORATION_CLASS_NAME} { background: ${editorLinkedEditingBackgroundColor}; border-left-color: ${editorLinkedEditingBackgroundColor}; }`);\n  }\n});\nregisterModelAndPositionCommand('_executeLinkedEditingProvider', (model, position) => getLinkedEditingRanges(model, position, CancellationToken.None));\nregisterEditorContribution(LinkedEditingContribution.ID, LinkedEditingContribution);\nregisterEditorAction(LinkedEditingAction);","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/linkedEditing/browser/linkedEditing.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","arrays","createCancelablePromise","Delayer","first","CancellationToken","Color","isCancellationError","onUnexpectedError","onUnexpectedExternalError","Event","Disposable","DisposableStore","strings","URI","EditorAction","EditorCommand","registerEditorAction","registerEditorCommand","registerEditorContribution","registerModelAndPositionCommand","ICodeEditorService","Position","Range","EditorContextKeys","ModelDecorationOptions","LinkedEditingRangeProviderRegistry","ILanguageConfigurationService","nls","ContextKeyExpr","IContextKeyService","RawContextKey","registerColor","registerThemingParticipant","CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE","DECORATION_CLASS_NAME","LinkedEditingContribution","constructor","editor","contextKeyService","languageConfigurationService","_debounceDuration","_localToDispose","_register","_editor","_enabled","_visibleContextKey","bindTo","_currentDecorations","_languageWordPattern","_currentWordPattern","_ignoreChangeEvent","_rangeUpdateTriggerPromise","_rangeSyncTriggerPromise","_currentRequest","_currentRequestPosition","_currentRequestModelVersion","onDidChangeModel","reinitialize","onDidChangeConfiguration","hasChanged","onDidChange","onDidChangeModelLanguage","get","getContribution","ID","forceRefresh","model","getModel","isEnabled","getOption","has","clearRanges","clear","add","runAndSubscribe","onDidChangeLanguageConfiguration","getLanguageConfiguration","getLanguageId","getWordDefinition","rangeUpdateScheduler","triggerRangeUpdate","trigger","updateRanges","rangeSyncScheduler","triggerRangeSync","decorations","_syncRanges","onDidChangeCursorPosition","onDidChangeModelContent","referenceRange","getDecorationRange","changes","every","intersectRanges","range","dispose","cancel","hasModel","startLineNumber","endLineNumber","referenceValue","getValueInRange","match","matchLength","edits","len","mirrorRange","push","text","oldValue","newValue","rangeStartColumn","startColumn","rangeEndColumn","endColumn","commonPrefixLength","substr","commonSuffixLength","popUndoStop","prevEditOperationType","_getViewModel","getPrevEditOperationType","executeEdits","setPrevEditOperationType","set","deltaDecorations","force","position","getPosition","getSelections","modelVersionId","getVersionId","equals","containsPosition","request","token","response","getLinkedEditingRanges","ranges","wordPattern","foundReferenceRange","splice","unshift","map","options","DECORATION","err","register","description","stickiness","className","LinkedEditingAction","id","label","localize","alias","precondition","and","writable","hasRenameProvider","kbOpts","kbExpr","editorTextFocus","primary","weight","runCommand","accessor","args","editorService","uri","pos","Array","isArray","undefined","isUri","isIPosition","openCodeEditor","resource","getActiveCodeEditor","setPosition","invokeWithinContext","reportTelemetry","run","_accessor","controller","LinkedEditingCommand","bindToContribution","handler","x","secondary","orderedByScore","ordered","provider","provideLinkedEditingRanges","isNonEmptyArray","editorLinkedEditingBackground","dark","fromHex","transparent","light","hc","theme","collector","editorLinkedEditingBackgroundColor","getColor","addRule","None"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, Delayer, first } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { isCancellationError, onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { LinkedEditingRangeProviderRegistry } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nexport const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE = new RawContextKey('LinkedEditingInputVisible', false);\nconst DECORATION_CLASS_NAME = 'linked-editing-decoration';\nlet LinkedEditingContribution = class LinkedEditingContribution extends Disposable {\n    constructor(editor, contextKeyService, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._debounceDuration = 200;\n        this._localToDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._enabled = false;\n        this._visibleContextKey = CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._currentDecorations = [];\n        this._languageWordPattern = null;\n        this._currentWordPattern = null;\n        this._ignoreChangeEvent = false;\n        this._localToDispose = this._register(new DisposableStore());\n        this._rangeUpdateTriggerPromise = null;\n        this._rangeSyncTriggerPromise = null;\n        this._currentRequest = null;\n        this._currentRequestPosition = null;\n        this._currentRequestModelVersion = null;\n        this._register(this._editor.onDidChangeModel(() => this.reinitialize(true)));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(62 /* linkedEditing */) || e.hasChanged(82 /* renameOnType */)) {\n                this.reinitialize(false);\n            }\n        }));\n        this._register(LinkedEditingRangeProviderRegistry.onDidChange(() => this.reinitialize(false)));\n        this._register(this._editor.onDidChangeModelLanguage(() => this.reinitialize(true)));\n        this.reinitialize(true);\n    }\n    static get(editor) {\n        return editor.getContribution(LinkedEditingContribution.ID);\n    }\n    reinitialize(forceRefresh) {\n        const model = this._editor.getModel();\n        const isEnabled = model !== null && (this._editor.getOption(62 /* linkedEditing */) || this._editor.getOption(82 /* renameOnType */)) && LinkedEditingRangeProviderRegistry.has(model);\n        if (isEnabled === this._enabled && !forceRefresh) {\n            return;\n        }\n        this._enabled = isEnabled;\n        this.clearRanges();\n        this._localToDispose.clear();\n        if (!isEnabled || model === null) {\n            return;\n        }\n        this._localToDispose.add(Event.runAndSubscribe(model.onDidChangeLanguageConfiguration, () => {\n            this._languageWordPattern = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n        }));\n        const rangeUpdateScheduler = new Delayer(this._debounceDuration);\n        const triggerRangeUpdate = () => {\n            this._rangeUpdateTriggerPromise = rangeUpdateScheduler.trigger(() => this.updateRanges(), this._debounceDuration);\n        };\n        const rangeSyncScheduler = new Delayer(0);\n        const triggerRangeSync = (decorations) => {\n            this._rangeSyncTriggerPromise = rangeSyncScheduler.trigger(() => this._syncRanges(decorations));\n        };\n        this._localToDispose.add(this._editor.onDidChangeCursorPosition(() => {\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (!this._ignoreChangeEvent) {\n                if (this._currentDecorations.length > 0) {\n                    const referenceRange = model.getDecorationRange(this._currentDecorations[0]);\n                    if (referenceRange && e.changes.every(c => referenceRange.intersectRanges(c.range))) {\n                        triggerRangeSync(this._currentDecorations);\n                        return;\n                    }\n                }\n            }\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add({\n            dispose: () => {\n                rangeUpdateScheduler.cancel();\n                rangeSyncScheduler.cancel();\n            }\n        });\n        this.updateRanges();\n    }\n    _syncRanges(decorations) {\n        // dalayed invocation, make sure we're still on\n        if (!this._editor.hasModel() || decorations !== this._currentDecorations || decorations.length === 0) {\n            // nothing to do\n            return;\n        }\n        const model = this._editor.getModel();\n        const referenceRange = model.getDecorationRange(decorations[0]);\n        if (!referenceRange || referenceRange.startLineNumber !== referenceRange.endLineNumber) {\n            return this.clearRanges();\n        }\n        const referenceValue = model.getValueInRange(referenceRange);\n        if (this._currentWordPattern) {\n            const match = referenceValue.match(this._currentWordPattern);\n            const matchLength = match ? match[0].length : 0;\n            if (matchLength !== referenceValue.length) {\n                return this.clearRanges();\n            }\n        }\n        let edits = [];\n        for (let i = 1, len = decorations.length; i < len; i++) {\n            const mirrorRange = model.getDecorationRange(decorations[i]);\n            if (!mirrorRange) {\n                continue;\n            }\n            if (mirrorRange.startLineNumber !== mirrorRange.endLineNumber) {\n                edits.push({\n                    range: mirrorRange,\n                    text: referenceValue\n                });\n            }\n            else {\n                let oldValue = model.getValueInRange(mirrorRange);\n                let newValue = referenceValue;\n                let rangeStartColumn = mirrorRange.startColumn;\n                let rangeEndColumn = mirrorRange.endColumn;\n                const commonPrefixLength = strings.commonPrefixLength(oldValue, newValue);\n                rangeStartColumn += commonPrefixLength;\n                oldValue = oldValue.substr(commonPrefixLength);\n                newValue = newValue.substr(commonPrefixLength);\n                const commonSuffixLength = strings.commonSuffixLength(oldValue, newValue);\n                rangeEndColumn -= commonSuffixLength;\n                oldValue = oldValue.substr(0, oldValue.length - commonSuffixLength);\n                newValue = newValue.substr(0, newValue.length - commonSuffixLength);\n                if (rangeStartColumn !== rangeEndColumn || newValue.length !== 0) {\n                    edits.push({\n                        range: new Range(mirrorRange.startLineNumber, rangeStartColumn, mirrorRange.endLineNumber, rangeEndColumn),\n                        text: newValue\n                    });\n                }\n            }\n        }\n        if (edits.length === 0) {\n            return;\n        }\n        try {\n            this._editor.popUndoStop();\n            this._ignoreChangeEvent = true;\n            const prevEditOperationType = this._editor._getViewModel().getPrevEditOperationType();\n            this._editor.executeEdits('linkedEditing', edits);\n            this._editor._getViewModel().setPrevEditOperationType(prevEditOperationType);\n        }\n        finally {\n            this._ignoreChangeEvent = false;\n        }\n    }\n    dispose() {\n        this.clearRanges();\n        super.dispose();\n    }\n    clearRanges() {\n        this._visibleContextKey.set(false);\n        this._currentDecorations = this._editor.deltaDecorations(this._currentDecorations, []);\n        if (this._currentRequest) {\n            this._currentRequest.cancel();\n            this._currentRequest = null;\n            this._currentRequestPosition = null;\n        }\n    }\n    updateRanges(force = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                this.clearRanges();\n                return;\n            }\n            const position = this._editor.getPosition();\n            if (!this._enabled && !force || this._editor.getSelections().length > 1) {\n                // disabled or multicursor\n                this.clearRanges();\n                return;\n            }\n            const model = this._editor.getModel();\n            const modelVersionId = model.getVersionId();\n            if (this._currentRequestPosition && this._currentRequestModelVersion === modelVersionId) {\n                if (position.equals(this._currentRequestPosition)) {\n                    return; // same position\n                }\n                if (this._currentDecorations && this._currentDecorations.length > 0) {\n                    const range = model.getDecorationRange(this._currentDecorations[0]);\n                    if (range && range.containsPosition(position)) {\n                        return; // just moving inside the existing primary range\n                    }\n                }\n            }\n            this._currentRequestPosition = position;\n            this._currentRequestModelVersion = modelVersionId;\n            const request = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    const response = yield getLinkedEditingRanges(model, position, token);\n                    if (request !== this._currentRequest) {\n                        return;\n                    }\n                    this._currentRequest = null;\n                    if (modelVersionId !== model.getVersionId()) {\n                        return;\n                    }\n                    let ranges = [];\n                    if (response === null || response === void 0 ? void 0 : response.ranges) {\n                        ranges = response.ranges;\n                    }\n                    this._currentWordPattern = (response === null || response === void 0 ? void 0 : response.wordPattern) || this._languageWordPattern;\n                    let foundReferenceRange = false;\n                    for (let i = 0, len = ranges.length; i < len; i++) {\n                        if (Range.containsPosition(ranges[i], position)) {\n                            foundReferenceRange = true;\n                            if (i !== 0) {\n                                const referenceRange = ranges[i];\n                                ranges.splice(i, 1);\n                                ranges.unshift(referenceRange);\n                            }\n                            break;\n                        }\n                    }\n                    if (!foundReferenceRange) {\n                        // Cannot do linked editing if the ranges are not where the cursor is...\n                        this.clearRanges();\n                        return;\n                    }\n                    const decorations = ranges.map(range => ({ range: range, options: LinkedEditingContribution.DECORATION }));\n                    this._visibleContextKey.set(true);\n                    this._currentDecorations = this._editor.deltaDecorations(this._currentDecorations, decorations);\n                }\n                catch (err) {\n                    if (!isCancellationError(err)) {\n                        onUnexpectedError(err);\n                    }\n                    if (this._currentRequest === request || !this._currentRequest) {\n                        // stop if we are still the latest request\n                        this.clearRanges();\n                    }\n                }\n            }));\n            this._currentRequest = request;\n            return request;\n        });\n    }\n};\nLinkedEditingContribution.ID = 'editor.contrib.linkedEditing';\nLinkedEditingContribution.DECORATION = ModelDecorationOptions.register({\n    description: 'linked-editing',\n    stickiness: 0 /* AlwaysGrowsWhenTypingAtEdges */,\n    className: DECORATION_CLASS_NAME\n});\nLinkedEditingContribution = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService)\n], LinkedEditingContribution);\nexport { LinkedEditingContribution };\nexport class LinkedEditingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.linkedEditing',\n            label: nls.localize('linkedEditing.label', \"Start Linked Editing\"),\n            alias: 'Start Linked Editing',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 60 /* F2 */,\n                weight: 100 /* EditorContrib */\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(_accessor, editor) {\n        const controller = LinkedEditingContribution.get(editor);\n        if (controller) {\n            return Promise.resolve(controller.updateRanges(true));\n        }\n        return Promise.resolve();\n    }\n}\nconst LinkedEditingCommand = EditorCommand.bindToContribution(LinkedEditingContribution.get);\nregisterEditorCommand(new LinkedEditingCommand({\n    id: 'cancelLinkedEditingInput',\n    precondition: CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,\n    handler: x => x.clearRanges(),\n    kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        weight: 100 /* EditorContrib */ + 99,\n        primary: 9 /* Escape */,\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\n    }\n}));\nfunction getLinkedEditingRanges(model, position, token) {\n    const orderedByScore = LinkedEditingRangeProviderRegistry.ordered(model);\n    // in order of score ask the linked editing range provider\n    // until someone response with a good result\n    // (good = not null)\n    return first(orderedByScore.map(provider => () => __awaiter(this, void 0, void 0, function* () {\n        try {\n            return yield provider.provideLinkedEditingRanges(model, position, token);\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n            return undefined;\n        }\n    })), result => !!result && arrays.isNonEmptyArray(result === null || result === void 0 ? void 0 : result.ranges));\n}\nexport const editorLinkedEditingBackground = registerColor('editor.linkedEditingBackground', { dark: Color.fromHex('#f00').transparent(0.3), light: Color.fromHex('#f00').transparent(0.3), hc: Color.fromHex('#f00').transparent(0.3) }, nls.localize('editorLinkedEditingBackground', 'Background color when the editor auto renames on type.'));\nregisterThemingParticipant((theme, collector) => {\n    const editorLinkedEditingBackgroundColor = theme.getColor(editorLinkedEditingBackground);\n    if (editorLinkedEditingBackgroundColor) {\n        collector.addRule(`.monaco-editor .${DECORATION_CLASS_NAME} { background: ${editorLinkedEditingBackgroundColor}; border-left-color: ${editorLinkedEditingBackgroundColor}; }`);\n    }\n});\nregisterModelAndPositionCommand('_executeLinkedEditingProvider', (model, position) => getLinkedEditingRanges(model, position, CancellationToken.None));\nregisterEditorContribution(LinkedEditingContribution.ID, LinkedEditingContribution);\nregisterEditorAction(LinkedEditingAction);\n"]},"metadata":{},"sourceType":"module"}