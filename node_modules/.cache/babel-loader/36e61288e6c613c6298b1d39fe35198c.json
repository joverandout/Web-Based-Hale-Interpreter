{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isFirefox } from '../../browser.js';\nimport { EventType as TouchEventType, Gesture } from '../../touch.js';\nimport { $, addDisposableListener, append, clearNode, createStyleSheet, Dimension, EventHelper, EventType, getActiveElement, isAncestor, isInShadowDOM } from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { ActionBar } from '../actionbar/actionbar.js';\nimport { ActionViewItem, BaseActionViewItem } from '../actionbar/actionViewItems.js';\nimport { formatRule } from '../codicons/codiconStyles.js';\nimport { layout } from '../contextview/contextview.js';\nimport { DomScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { EmptySubmenuAction, Separator, SubmenuAction } from '../../../common/actions.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { stripIcons } from '../../../common/iconLabels.js';\nimport { DisposableStore } from '../../../common/lifecycle.js';\nimport { isLinux, isMacintosh } from '../../../common/platform.js';\nimport * as strings from '../../../common/strings.js';\nexport const MENU_MNEMONIC_REGEX = /\\(&([^\\s&])\\)|(^|[^&])&([^\\s&])/;\nexport const MENU_ESCAPED_MNEMONIC_REGEX = /(&amp;)?(&amp;)([^\\s&])/g;\nexport var Direction;\n\n(function (Direction) {\n  Direction[Direction[\"Right\"] = 0] = \"Right\";\n  Direction[Direction[\"Left\"] = 1] = \"Left\";\n})(Direction || (Direction = {}));\n\nexport class Menu extends ActionBar {\n  constructor(container, actions, options = {}) {\n    container.classList.add('monaco-menu-container');\n    container.setAttribute('role', 'presentation');\n    const menuElement = document.createElement('div');\n    menuElement.classList.add('monaco-menu');\n    menuElement.setAttribute('role', 'presentation');\n    super(menuElement, {\n      orientation: 1\n      /* VERTICAL */\n      ,\n      actionViewItemProvider: action => this.doGetActionViewItem(action, options, parentData),\n      context: options.context,\n      actionRunner: options.actionRunner,\n      ariaLabel: options.ariaLabel,\n      focusOnlyEnabledItems: true,\n      triggerKeys: {\n        keys: [3\n        /* Enter */\n        , ...(isMacintosh || isLinux ? [10\n        /* Space */\n        ] : [])],\n        keyDown: true\n      }\n    });\n    this.menuElement = menuElement;\n    this.actionsList.setAttribute('role', 'menu');\n    this.actionsList.tabIndex = 0;\n    this.menuDisposables = this._register(new DisposableStore());\n    this.initializeOrUpdateStyleSheet(container, {});\n\n    this._register(Gesture.addTarget(menuElement));\n\n    addDisposableListener(menuElement, EventType.KEY_DOWN, e => {\n      const event = new StandardKeyboardEvent(e); // Stop tab navigation of menus\n\n      if (event.equals(2\n      /* Tab */\n      )) {\n        e.preventDefault();\n      }\n    });\n\n    if (options.enableMnemonics) {\n      this.menuDisposables.add(addDisposableListener(menuElement, EventType.KEY_DOWN, e => {\n        const key = e.key.toLocaleLowerCase();\n\n        if (this.mnemonics.has(key)) {\n          EventHelper.stop(e, true);\n          const actions = this.mnemonics.get(key);\n\n          if (actions.length === 1) {\n            if (actions[0] instanceof SubmenuMenuActionViewItem && actions[0].container) {\n              this.focusItemByElement(actions[0].container);\n            }\n\n            actions[0].onClick(e);\n          }\n\n          if (actions.length > 1) {\n            const action = actions.shift();\n\n            if (action && action.container) {\n              this.focusItemByElement(action.container);\n              actions.push(action);\n            }\n\n            this.mnemonics.set(key, actions);\n          }\n        }\n      }));\n    }\n\n    if (isLinux) {\n      this._register(addDisposableListener(menuElement, EventType.KEY_DOWN, e => {\n        const event = new StandardKeyboardEvent(e);\n\n        if (event.equals(14\n        /* Home */\n        ) || event.equals(11\n        /* PageUp */\n        )) {\n          this.focusedItem = this.viewItems.length - 1;\n          this.focusNext();\n          EventHelper.stop(e, true);\n        } else if (event.equals(13\n        /* End */\n        ) || event.equals(12\n        /* PageDown */\n        )) {\n          this.focusedItem = 0;\n          this.focusPrevious();\n          EventHelper.stop(e, true);\n        }\n      }));\n    }\n\n    this._register(addDisposableListener(this.domNode, EventType.MOUSE_OUT, e => {\n      let relatedTarget = e.relatedTarget;\n\n      if (!isAncestor(relatedTarget, this.domNode)) {\n        this.focusedItem = undefined;\n        this.updateFocus();\n        e.stopPropagation();\n      }\n    }));\n\n    this._register(addDisposableListener(this.actionsList, EventType.MOUSE_OVER, e => {\n      let target = e.target;\n\n      if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n        return;\n      }\n\n      while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n        target = target.parentElement;\n      }\n\n      if (target.classList.contains('action-item')) {\n        const lastFocusedItem = this.focusedItem;\n        this.setFocusedItem(target);\n\n        if (lastFocusedItem !== this.focusedItem) {\n          this.updateFocus();\n        }\n      }\n    })); // Support touch on actions list to focus items (needed for submenus)\n\n\n    this._register(Gesture.addTarget(this.actionsList));\n\n    this._register(addDisposableListener(this.actionsList, TouchEventType.Tap, e => {\n      let target = e.initialTarget;\n\n      if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n        return;\n      }\n\n      while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n        target = target.parentElement;\n      }\n\n      if (target.classList.contains('action-item')) {\n        const lastFocusedItem = this.focusedItem;\n        this.setFocusedItem(target);\n\n        if (lastFocusedItem !== this.focusedItem) {\n          this.updateFocus();\n        }\n      }\n    }));\n\n    let parentData = {\n      parent: this\n    };\n    this.mnemonics = new Map(); // Scroll Logic\n\n    this.scrollableElement = this._register(new DomScrollableElement(menuElement, {\n      alwaysConsumeMouseWheel: true,\n      horizontal: 2\n      /* Hidden */\n      ,\n      vertical: 3\n      /* Visible */\n      ,\n      verticalScrollbarSize: 7,\n      handleMouseWheel: true,\n      useShadows: true\n    }));\n    const scrollElement = this.scrollableElement.getDomNode();\n    scrollElement.style.position = ''; // Support scroll on menu drag\n\n    this._register(addDisposableListener(menuElement, TouchEventType.Change, e => {\n      EventHelper.stop(e, true);\n      const scrollTop = this.scrollableElement.getScrollPosition().scrollTop;\n      this.scrollableElement.setScrollPosition({\n        scrollTop: scrollTop - e.translationY\n      });\n    }));\n\n    this._register(addDisposableListener(scrollElement, EventType.MOUSE_UP, e => {\n      // Absorb clicks in menu dead space https://github.com/microsoft/vscode/issues/63575\n      // We do this on the scroll element so the scroll bar doesn't dismiss the menu either\n      e.preventDefault();\n    }));\n\n    menuElement.style.maxHeight = `${Math.max(10, window.innerHeight - container.getBoundingClientRect().top - 35)}px`;\n    actions = actions.filter(a => {\n      var _a;\n\n      if ((_a = options.submenuIds) === null || _a === void 0 ? void 0 : _a.has(a.id)) {\n        console.warn(`Found submenu cycle: ${a.id}`);\n        return false;\n      }\n\n      return true;\n    });\n    this.push(actions, {\n      icon: true,\n      label: true,\n      isMenu: true\n    });\n    container.appendChild(this.scrollableElement.getDomNode());\n    this.scrollableElement.scanDomNode();\n    this.viewItems.filter(item => !(item instanceof MenuSeparatorActionViewItem)).forEach((item, index, array) => {\n      item.updatePositionInSet(index + 1, array.length);\n    });\n  }\n\n  initializeOrUpdateStyleSheet(container, style) {\n    if (!this.styleSheet) {\n      if (isInShadowDOM(container)) {\n        this.styleSheet = createStyleSheet(container);\n      } else {\n        if (!Menu.globalStyleSheet) {\n          Menu.globalStyleSheet = createStyleSheet();\n        }\n\n        this.styleSheet = Menu.globalStyleSheet;\n      }\n    }\n\n    this.styleSheet.textContent = getMenuWidgetCSS(style);\n  }\n\n  style(style) {\n    const container = this.getContainer();\n    this.initializeOrUpdateStyleSheet(container, style);\n    const fgColor = style.foregroundColor ? `${style.foregroundColor}` : '';\n    const bgColor = style.backgroundColor ? `${style.backgroundColor}` : '';\n    const border = style.borderColor ? `1px solid ${style.borderColor}` : '';\n    const shadow = style.shadowColor ? `0 2px 4px ${style.shadowColor}` : '';\n    container.style.border = border;\n    this.domNode.style.color = fgColor;\n    this.domNode.style.backgroundColor = bgColor;\n    container.style.boxShadow = shadow;\n\n    if (this.viewItems) {\n      this.viewItems.forEach(item => {\n        if (item instanceof BaseMenuActionViewItem || item instanceof MenuSeparatorActionViewItem) {\n          item.style(style);\n        }\n      });\n    }\n  }\n\n  getContainer() {\n    return this.scrollableElement.getDomNode();\n  }\n\n  get onScroll() {\n    return this.scrollableElement.onScroll;\n  }\n\n  focusItemByElement(element) {\n    const lastFocusedItem = this.focusedItem;\n    this.setFocusedItem(element);\n\n    if (lastFocusedItem !== this.focusedItem) {\n      this.updateFocus();\n    }\n  }\n\n  setFocusedItem(element) {\n    for (let i = 0; i < this.actionsList.children.length; i++) {\n      let elem = this.actionsList.children[i];\n\n      if (element === elem) {\n        this.focusedItem = i;\n        break;\n      }\n    }\n  }\n\n  updateFocus(fromRight) {\n    super.updateFocus(fromRight, true, true);\n\n    if (typeof this.focusedItem !== 'undefined') {\n      // Workaround for #80047 caused by an issue in chromium\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=414283\n      // When that's fixed, just call this.scrollableElement.scanDomNode()\n      this.scrollableElement.setScrollPosition({\n        scrollTop: Math.round(this.menuElement.scrollTop)\n      });\n    }\n  }\n\n  doGetActionViewItem(action, options, parentData) {\n    if (action instanceof Separator) {\n      return new MenuSeparatorActionViewItem(options.context, action, {\n        icon: true\n      });\n    } else if (action instanceof SubmenuAction) {\n      const menuActionViewItem = new SubmenuMenuActionViewItem(action, action.actions, parentData, Object.assign(Object.assign({}, options), {\n        submenuIds: new Set([...(options.submenuIds || []), action.id])\n      }));\n\n      if (options.enableMnemonics) {\n        const mnemonic = menuActionViewItem.getMnemonic();\n\n        if (mnemonic && menuActionViewItem.isEnabled()) {\n          let actionViewItems = [];\n\n          if (this.mnemonics.has(mnemonic)) {\n            actionViewItems = this.mnemonics.get(mnemonic);\n          }\n\n          actionViewItems.push(menuActionViewItem);\n          this.mnemonics.set(mnemonic, actionViewItems);\n        }\n      }\n\n      return menuActionViewItem;\n    } else {\n      const menuItemOptions = {\n        enableMnemonics: options.enableMnemonics,\n        useEventAsContext: options.useEventAsContext\n      };\n\n      if (options.getKeyBinding) {\n        const keybinding = options.getKeyBinding(action);\n\n        if (keybinding) {\n          const keybindingLabel = keybinding.getLabel();\n\n          if (keybindingLabel) {\n            menuItemOptions.keybinding = keybindingLabel;\n          }\n        }\n      }\n\n      const menuActionViewItem = new BaseMenuActionViewItem(options.context, action, menuItemOptions);\n\n      if (options.enableMnemonics) {\n        const mnemonic = menuActionViewItem.getMnemonic();\n\n        if (mnemonic && menuActionViewItem.isEnabled()) {\n          let actionViewItems = [];\n\n          if (this.mnemonics.has(mnemonic)) {\n            actionViewItems = this.mnemonics.get(mnemonic);\n          }\n\n          actionViewItems.push(menuActionViewItem);\n          this.mnemonics.set(mnemonic, actionViewItems);\n        }\n      }\n\n      return menuActionViewItem;\n    }\n  }\n\n}\n\nclass BaseMenuActionViewItem extends BaseActionViewItem {\n  constructor(ctx, action, options = {}) {\n    options.isMenu = true;\n    super(action, action, options);\n    this.options = options;\n    this.options.icon = options.icon !== undefined ? options.icon : false;\n    this.options.label = options.label !== undefined ? options.label : true;\n    this.cssClass = ''; // Set mnemonic\n\n    if (this.options.label && options.enableMnemonics) {\n      let label = this.getAction().label;\n\n      if (label) {\n        let matches = MENU_MNEMONIC_REGEX.exec(label);\n\n        if (matches) {\n          this.mnemonic = (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase();\n        }\n      }\n    } // Add mouse up listener later to avoid accidental clicks\n\n\n    this.runOnceToEnableMouseUp = new RunOnceScheduler(() => {\n      if (!this.element) {\n        return;\n      }\n\n      this._register(addDisposableListener(this.element, EventType.MOUSE_UP, e => {\n        // removed default prevention as it conflicts\n        // with BaseActionViewItem #101537\n        // add back if issues arise and link new issue\n        EventHelper.stop(e, true); // See https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Interact_with_the_clipboard\n        // > Writing to the clipboard\n        // > You can use the \"cut\" and \"copy\" commands without any special\n        // permission if you are using them in a short-lived event handler\n        // for a user action (for example, a click handler).\n        // => to get the Copy and Paste context menu actions working on Firefox,\n        // there should be no timeout here\n\n        if (isFirefox) {\n          const mouseEvent = new StandardMouseEvent(e); // Allowing right click to trigger the event causes the issue described below,\n          // but since the solution below does not work in FF, we must disable right click\n\n          if (mouseEvent.rightButton) {\n            return;\n          }\n\n          this.onClick(e);\n        } // In all other cases, set timeout to allow context menu cancellation to trigger\n        // otherwise the action will destroy the menu and a second context menu\n        // will still trigger for right click.\n        else {\n          setTimeout(() => {\n            this.onClick(e);\n          }, 0);\n        }\n      }));\n\n      this._register(addDisposableListener(this.element, EventType.CONTEXT_MENU, e => {\n        EventHelper.stop(e, true);\n      }));\n    }, 100);\n\n    this._register(this.runOnceToEnableMouseUp);\n  }\n\n  render(container) {\n    super.render(container);\n\n    if (!this.element) {\n      return;\n    }\n\n    this.container = container;\n    this.item = append(this.element, $('a.action-menu-item'));\n\n    if (this._action.id === Separator.ID) {\n      // A separator is a presentation item\n      this.item.setAttribute('role', 'presentation');\n    } else {\n      this.item.setAttribute('role', 'menuitem');\n\n      if (this.mnemonic) {\n        this.item.setAttribute('aria-keyshortcuts', `${this.mnemonic}`);\n      }\n    }\n\n    this.check = append(this.item, $('span.menu-item-check' + Codicon.menuSelection.cssSelector));\n    this.check.setAttribute('role', 'none');\n    this.label = append(this.item, $('span.action-label'));\n\n    if (this.options.label && this.options.keybinding) {\n      append(this.item, $('span.keybinding')).textContent = this.options.keybinding;\n    } // Adds mouse up listener to actually run the action\n\n\n    this.runOnceToEnableMouseUp.schedule();\n    this.updateClass();\n    this.updateLabel();\n    this.updateTooltip();\n    this.updateEnabled();\n    this.updateChecked();\n  }\n\n  blur() {\n    super.blur();\n    this.applyStyle();\n  }\n\n  focus() {\n    super.focus();\n\n    if (this.item) {\n      this.item.focus();\n    }\n\n    this.applyStyle();\n  }\n\n  updatePositionInSet(pos, setSize) {\n    if (this.item) {\n      this.item.setAttribute('aria-posinset', `${pos}`);\n      this.item.setAttribute('aria-setsize', `${setSize}`);\n    }\n  }\n\n  updateLabel() {\n    if (!this.label) {\n      return;\n    }\n\n    if (this.options.label) {\n      clearNode(this.label);\n      let label = stripIcons(this.getAction().label);\n\n      if (label) {\n        const cleanLabel = cleanMnemonic(label);\n\n        if (!this.options.enableMnemonics) {\n          label = cleanLabel;\n        }\n\n        this.label.setAttribute('aria-label', cleanLabel.replace(/&&/g, '&'));\n        const matches = MENU_MNEMONIC_REGEX.exec(label);\n\n        if (matches) {\n          label = strings.escape(label); // This is global, reset it\n\n          MENU_ESCAPED_MNEMONIC_REGEX.lastIndex = 0;\n          let escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label); // We can't use negative lookbehind so if we match our negative and skip\n\n          while (escMatch && escMatch[1]) {\n            escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n          }\n\n          const replaceDoubleEscapes = str => str.replace(/&amp;&amp;/g, '&amp;');\n\n          if (escMatch) {\n            this.label.append(strings.ltrim(replaceDoubleEscapes(label.substr(0, escMatch.index)), ' '), $('u', {\n              'aria-hidden': 'true'\n            }, escMatch[3]), strings.rtrim(replaceDoubleEscapes(label.substr(escMatch.index + escMatch[0].length)), ' '));\n          } else {\n            this.label.innerText = replaceDoubleEscapes(label).trim();\n          }\n\n          if (this.item) {\n            this.item.setAttribute('aria-keyshortcuts', (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase());\n          }\n        } else {\n          this.label.innerText = label.replace(/&&/g, '&').trim();\n        }\n      }\n    }\n  }\n\n  updateTooltip() {// menus should function like native menus and they do not have tooltips\n  }\n\n  updateClass() {\n    if (this.cssClass && this.item) {\n      this.item.classList.remove(...this.cssClass.split(' '));\n    }\n\n    if (this.options.icon && this.label) {\n      this.cssClass = this.getAction().class || '';\n      this.label.classList.add('icon');\n\n      if (this.cssClass) {\n        this.label.classList.add(...this.cssClass.split(' '));\n      }\n\n      this.updateEnabled();\n    } else if (this.label) {\n      this.label.classList.remove('icon');\n    }\n  }\n\n  updateEnabled() {\n    if (this.getAction().enabled) {\n      if (this.element) {\n        this.element.classList.remove('disabled');\n        this.element.removeAttribute('aria-disabled');\n      }\n\n      if (this.item) {\n        this.item.classList.remove('disabled');\n        this.item.removeAttribute('aria-disabled');\n        this.item.tabIndex = 0;\n      }\n    } else {\n      if (this.element) {\n        this.element.classList.add('disabled');\n        this.element.setAttribute('aria-disabled', 'true');\n      }\n\n      if (this.item) {\n        this.item.classList.add('disabled');\n        this.item.setAttribute('aria-disabled', 'true');\n      }\n    }\n  }\n\n  updateChecked() {\n    if (!this.item) {\n      return;\n    }\n\n    const checked = this.getAction().checked;\n    this.item.classList.toggle('checked', !!checked);\n\n    if (checked !== undefined) {\n      this.item.setAttribute('role', 'menuitemcheckbox');\n      this.item.setAttribute('aria-checked', checked ? 'true' : 'false');\n    } else {\n      this.item.setAttribute('role', 'menuitem');\n      this.item.setAttribute('aria-checked', '');\n    }\n  }\n\n  getMnemonic() {\n    return this.mnemonic;\n  }\n\n  applyStyle() {\n    if (!this.menuStyle) {\n      return;\n    }\n\n    const isSelected = this.element && this.element.classList.contains('focused');\n    const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n    const bgColor = isSelected && this.menuStyle.selectionBackgroundColor ? this.menuStyle.selectionBackgroundColor : undefined;\n    const border = isSelected && this.menuStyle.selectionBorderColor ? `thin solid ${this.menuStyle.selectionBorderColor}` : '';\n\n    if (this.item) {\n      this.item.style.color = fgColor ? fgColor.toString() : '';\n      this.item.style.backgroundColor = bgColor ? bgColor.toString() : '';\n    }\n\n    if (this.check) {\n      this.check.style.color = fgColor ? fgColor.toString() : '';\n    }\n\n    if (this.container) {\n      this.container.style.border = border;\n    }\n  }\n\n  style(style) {\n    this.menuStyle = style;\n    this.applyStyle();\n  }\n\n}\n\nclass SubmenuMenuActionViewItem extends BaseMenuActionViewItem {\n  constructor(action, submenuActions, parentData, submenuOptions) {\n    super(action, action, submenuOptions);\n    this.submenuActions = submenuActions;\n    this.parentData = parentData;\n    this.submenuOptions = submenuOptions;\n    this.mysubmenu = null;\n    this.submenuDisposables = this._register(new DisposableStore());\n    this.mouseOver = false;\n    this.expandDirection = submenuOptions && submenuOptions.expandDirection !== undefined ? submenuOptions.expandDirection : Direction.Right;\n    this.showScheduler = new RunOnceScheduler(() => {\n      if (this.mouseOver) {\n        this.cleanupExistingSubmenu(false);\n        this.createSubmenu(false);\n      }\n    }, 250);\n    this.hideScheduler = new RunOnceScheduler(() => {\n      if (this.element && !isAncestor(getActiveElement(), this.element) && this.parentData.submenu === this.mysubmenu) {\n        this.parentData.parent.focus(false);\n        this.cleanupExistingSubmenu(true);\n      }\n    }, 750);\n  }\n\n  render(container) {\n    super.render(container);\n\n    if (!this.element) {\n      return;\n    }\n\n    if (this.item) {\n      this.item.classList.add('monaco-submenu-item');\n      this.item.tabIndex = 0;\n      this.item.setAttribute('aria-haspopup', 'true');\n      this.updateAriaExpanded('false');\n      this.submenuIndicator = append(this.item, $('span.submenu-indicator' + Codicon.menuSubmenu.cssSelector));\n      this.submenuIndicator.setAttribute('aria-hidden', 'true');\n    }\n\n    this._register(addDisposableListener(this.element, EventType.KEY_UP, e => {\n      let event = new StandardKeyboardEvent(e);\n\n      if (event.equals(17\n      /* RightArrow */\n      ) || event.equals(3\n      /* Enter */\n      )) {\n        EventHelper.stop(e, true);\n        this.createSubmenu(true);\n      }\n    }));\n\n    this._register(addDisposableListener(this.element, EventType.KEY_DOWN, e => {\n      let event = new StandardKeyboardEvent(e);\n\n      if (getActiveElement() === this.item) {\n        if (event.equals(17\n        /* RightArrow */\n        ) || event.equals(3\n        /* Enter */\n        )) {\n          EventHelper.stop(e, true);\n        }\n      }\n    }));\n\n    this._register(addDisposableListener(this.element, EventType.MOUSE_OVER, e => {\n      if (!this.mouseOver) {\n        this.mouseOver = true;\n        this.showScheduler.schedule();\n      }\n    }));\n\n    this._register(addDisposableListener(this.element, EventType.MOUSE_LEAVE, e => {\n      this.mouseOver = false;\n    }));\n\n    this._register(addDisposableListener(this.element, EventType.FOCUS_OUT, e => {\n      if (this.element && !isAncestor(getActiveElement(), this.element)) {\n        this.hideScheduler.schedule();\n      }\n    }));\n\n    this._register(this.parentData.parent.onScroll(() => {\n      this.parentData.parent.focus(false);\n      this.cleanupExistingSubmenu(false);\n    }));\n  }\n\n  updateEnabled() {// override on submenu entry\n    // native menus do not observe enablement on sumbenus\n    // we mimic that behavior\n  }\n\n  onClick(e) {\n    // stop clicking from trying to run an action\n    EventHelper.stop(e, true);\n    this.cleanupExistingSubmenu(false);\n    this.createSubmenu(true);\n  }\n\n  cleanupExistingSubmenu(force) {\n    if (this.parentData.submenu && (force || this.parentData.submenu !== this.mysubmenu)) {\n      // disposal may throw if the submenu has already been removed\n      try {\n        this.parentData.submenu.dispose();\n      } catch (_a) {}\n\n      this.parentData.submenu = undefined;\n      this.updateAriaExpanded('false');\n\n      if (this.submenuContainer) {\n        this.submenuDisposables.clear();\n        this.submenuContainer = undefined;\n      }\n    }\n  }\n\n  calculateSubmenuMenuLayout(windowDimensions, submenu, entry, expandDirection) {\n    const ret = {\n      top: 0,\n      left: 0\n    }; // Start with horizontal\n\n    ret.left = layout(windowDimensions.width, submenu.width, {\n      position: expandDirection === Direction.Right ? 0\n      /* Before */\n      : 1\n      /* After */\n      ,\n      offset: entry.left,\n      size: entry.width\n    }); // We don't have enough room to layout the menu fully, so we are overlapping the menu\n\n    if (ret.left >= entry.left && ret.left < entry.left + entry.width) {\n      if (entry.left + 10 + submenu.width <= windowDimensions.width) {\n        ret.left = entry.left + 10;\n      }\n\n      entry.top += 10;\n      entry.height = 0;\n    } // Now that we have a horizontal position, try layout vertically\n\n\n    ret.top = layout(windowDimensions.height, submenu.height, {\n      position: 0\n      /* Before */\n      ,\n      offset: entry.top,\n      size: 0\n    }); // We didn't have enough room below, but we did above, so we shift down to align the menu\n\n    if (ret.top + submenu.height === entry.top && ret.top + entry.height + submenu.height <= windowDimensions.height) {\n      ret.top += entry.height;\n    }\n\n    return ret;\n  }\n\n  createSubmenu(selectFirstItem = true) {\n    if (!this.element) {\n      return;\n    }\n\n    if (!this.parentData.submenu) {\n      this.updateAriaExpanded('true');\n      this.submenuContainer = append(this.element, $('div.monaco-submenu'));\n      this.submenuContainer.classList.add('menubar-menu-items-holder', 'context-view'); // Set the top value of the menu container before construction\n      // This allows the menu constructor to calculate the proper max height\n\n      const computedStyles = getComputedStyle(this.parentData.parent.domNode);\n      const paddingTop = parseFloat(computedStyles.paddingTop || '0') || 0; // this.submenuContainer.style.top = `${this.element.offsetTop - this.parentData.parent.scrollOffset - paddingTop}px`;\n\n      this.submenuContainer.style.zIndex = '1';\n      this.submenuContainer.style.position = 'fixed';\n      this.submenuContainer.style.top = '0';\n      this.submenuContainer.style.left = '0';\n      this.parentData.submenu = new Menu(this.submenuContainer, this.submenuActions.length ? this.submenuActions : [new EmptySubmenuAction()], this.submenuOptions);\n\n      if (this.menuStyle) {\n        this.parentData.submenu.style(this.menuStyle);\n      } // layout submenu\n\n\n      const entryBox = this.element.getBoundingClientRect();\n      const entryBoxUpdated = {\n        top: entryBox.top - paddingTop,\n        left: entryBox.left,\n        height: entryBox.height + 2 * paddingTop,\n        width: entryBox.width\n      };\n      const viewBox = this.submenuContainer.getBoundingClientRect();\n      const {\n        top,\n        left\n      } = this.calculateSubmenuMenuLayout(new Dimension(window.innerWidth, window.innerHeight), Dimension.lift(viewBox), entryBoxUpdated, this.expandDirection); // subtract offsets caused by transform parent\n\n      this.submenuContainer.style.left = `${left - viewBox.left}px`;\n      this.submenuContainer.style.top = `${top - viewBox.top}px`;\n      this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_UP, e => {\n        let event = new StandardKeyboardEvent(e);\n\n        if (event.equals(15\n        /* LeftArrow */\n        )) {\n          EventHelper.stop(e, true);\n          this.parentData.parent.focus();\n          this.cleanupExistingSubmenu(true);\n        }\n      }));\n      this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_DOWN, e => {\n        let event = new StandardKeyboardEvent(e);\n\n        if (event.equals(15\n        /* LeftArrow */\n        )) {\n          EventHelper.stop(e, true);\n        }\n      }));\n      this.submenuDisposables.add(this.parentData.submenu.onDidCancel(() => {\n        this.parentData.parent.focus();\n        this.cleanupExistingSubmenu(true);\n      }));\n      this.parentData.submenu.focus(selectFirstItem);\n      this.mysubmenu = this.parentData.submenu;\n    } else {\n      this.parentData.submenu.focus(false);\n    }\n  }\n\n  updateAriaExpanded(value) {\n    var _a;\n\n    if (this.item) {\n      (_a = this.item) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-expanded', value);\n    }\n  }\n\n  applyStyle() {\n    super.applyStyle();\n\n    if (!this.menuStyle) {\n      return;\n    }\n\n    const isSelected = this.element && this.element.classList.contains('focused');\n    const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n\n    if (this.submenuIndicator) {\n      this.submenuIndicator.style.color = fgColor ? `${fgColor}` : '';\n    }\n\n    if (this.parentData.submenu) {\n      this.parentData.submenu.style(this.menuStyle);\n    }\n  }\n\n  dispose() {\n    super.dispose();\n    this.hideScheduler.dispose();\n\n    if (this.mysubmenu) {\n      this.mysubmenu.dispose();\n      this.mysubmenu = null;\n    }\n\n    if (this.submenuContainer) {\n      this.submenuContainer = undefined;\n    }\n  }\n\n}\n\nclass MenuSeparatorActionViewItem extends ActionViewItem {\n  style(style) {\n    if (this.label) {\n      this.label.style.borderBottomColor = style.separatorColor ? `${style.separatorColor}` : '';\n    }\n  }\n\n}\n\nexport function cleanMnemonic(label) {\n  const regex = MENU_MNEMONIC_REGEX;\n  const matches = regex.exec(label);\n\n  if (!matches) {\n    return label;\n  }\n\n  const mnemonicInText = !matches[1];\n  return label.replace(regex, mnemonicInText ? '$2$3' : '').trim();\n}\n\nfunction getMenuWidgetCSS(style) {\n  let result =\n  /* css */\n  `\n.monaco-menu {\n\tfont-size: 13px;\n\n}\n\n${formatRule(Codicon.menuSelection)}\n${formatRule(Codicon.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\topacity: 0.4;\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid #bbb;\n\tpadding-top: 1px;\n\tmargin-left: .8em;\n\tmargin-right: .8em;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tpadding: 0.5em 0 0 0;\n\tmargin-bottom: 0.5em;\n\twidth: 100%;\n\theight: 0px !important;\n\tmargin-left: .8em !important;\n\tmargin-right: .8em !important;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tborder: thin solid transparent; /* prevents jumping behaviour on hover or focus */\n}\n\n\n/* High Contrast Theming */\n:host-context(.hc-black) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .5em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 1.8em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tpadding: 0.2em 0 0 0;\n\tmargin-bottom: 0.2em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}\n\n/* Arrows */\n.monaco-scrollable-element > .scrollbar > .scra {\n\tcursor: pointer;\n\tfont-size: 11px !important;\n}\n\n.monaco-scrollable-element > .visible {\n\topacity: 1;\n\n\t/* Background rule added for IE9 - to allow clicks on dom node */\n\tbackground:rgba(0,0,0,0);\n\n\ttransition: opacity 100ms linear;\n}\n.monaco-scrollable-element > .invisible {\n\topacity: 0;\n\tpointer-events: none;\n}\n.monaco-scrollable-element > .invisible.fade {\n\ttransition: opacity 800ms linear;\n}\n\n/* Scrollable Content Inset Shadow */\n.monaco-scrollable-element > .shadow {\n\tposition: absolute;\n\tdisplay: none;\n}\n.monaco-scrollable-element > .shadow.top {\n\tdisplay: block;\n\ttop: 0;\n\tleft: 3px;\n\theight: 3px;\n\twidth: 100%;\n}\n.monaco-scrollable-element > .shadow.left {\n\tdisplay: block;\n\ttop: 3px;\n\tleft: 0;\n\theight: 100%;\n\twidth: 3px;\n}\n.monaco-scrollable-element > .shadow.top-left-corner {\n\tdisplay: block;\n\ttop: 0;\n\tleft: 0;\n\theight: 3px;\n\twidth: 3px;\n}\n`; // Scrollbars\n\n  const scrollbarShadowColor = style.scrollbarShadow;\n\n  if (scrollbarShadowColor) {\n    result += `\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 0 6px 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 0 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 6px 6px -6px inset;\n\t\t\t}\n\t\t`;\n  }\n\n  const scrollbarSliderBackgroundColor = style.scrollbarSliderBackground;\n\n  if (scrollbarSliderBackgroundColor) {\n    result += `\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t}\n\t\t`;\n  }\n\n  const scrollbarSliderHoverBackgroundColor = style.scrollbarSliderHoverBackground;\n\n  if (scrollbarSliderHoverBackgroundColor) {\n    result += `\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t}\n\t\t`;\n  }\n\n  const scrollbarSliderActiveBackgroundColor = style.scrollbarSliderActiveBackground;\n\n  if (scrollbarSliderActiveBackgroundColor) {\n    result += `\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t}\n\t\t`;\n  }\n\n  return result;\n}","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.js"],"names":["isFirefox","EventType","TouchEventType","Gesture","$","addDisposableListener","append","clearNode","createStyleSheet","Dimension","EventHelper","getActiveElement","isAncestor","isInShadowDOM","StandardKeyboardEvent","StandardMouseEvent","ActionBar","ActionViewItem","BaseActionViewItem","formatRule","layout","DomScrollableElement","EmptySubmenuAction","Separator","SubmenuAction","RunOnceScheduler","Codicon","stripIcons","DisposableStore","isLinux","isMacintosh","strings","MENU_MNEMONIC_REGEX","MENU_ESCAPED_MNEMONIC_REGEX","Direction","Menu","constructor","container","actions","options","classList","add","setAttribute","menuElement","document","createElement","orientation","actionViewItemProvider","action","doGetActionViewItem","parentData","context","actionRunner","ariaLabel","focusOnlyEnabledItems","triggerKeys","keys","keyDown","actionsList","tabIndex","menuDisposables","_register","initializeOrUpdateStyleSheet","addTarget","KEY_DOWN","e","event","equals","preventDefault","enableMnemonics","key","toLocaleLowerCase","mnemonics","has","stop","get","length","SubmenuMenuActionViewItem","focusItemByElement","onClick","shift","push","set","focusedItem","viewItems","focusNext","focusPrevious","domNode","MOUSE_OUT","relatedTarget","undefined","updateFocus","stopPropagation","MOUSE_OVER","target","parentElement","contains","lastFocusedItem","setFocusedItem","Tap","initialTarget","parent","Map","scrollableElement","alwaysConsumeMouseWheel","horizontal","vertical","verticalScrollbarSize","handleMouseWheel","useShadows","scrollElement","getDomNode","style","position","Change","scrollTop","getScrollPosition","setScrollPosition","translationY","MOUSE_UP","maxHeight","Math","max","window","innerHeight","getBoundingClientRect","top","filter","a","_a","submenuIds","id","console","warn","icon","label","isMenu","appendChild","scanDomNode","item","MenuSeparatorActionViewItem","forEach","index","array","updatePositionInSet","styleSheet","globalStyleSheet","textContent","getMenuWidgetCSS","getContainer","fgColor","foregroundColor","bgColor","backgroundColor","border","borderColor","shadow","shadowColor","color","boxShadow","BaseMenuActionViewItem","onScroll","element","i","children","elem","fromRight","round","menuActionViewItem","Object","assign","Set","mnemonic","getMnemonic","isEnabled","actionViewItems","menuItemOptions","useEventAsContext","getKeyBinding","keybinding","keybindingLabel","getLabel","ctx","cssClass","getAction","matches","exec","runOnceToEnableMouseUp","mouseEvent","rightButton","setTimeout","CONTEXT_MENU","render","_action","ID","check","menuSelection","cssSelector","schedule","updateClass","updateLabel","updateTooltip","updateEnabled","updateChecked","blur","applyStyle","focus","pos","setSize","cleanLabel","cleanMnemonic","replace","escape","lastIndex","escMatch","replaceDoubleEscapes","str","ltrim","substr","rtrim","innerText","trim","remove","split","class","enabled","removeAttribute","checked","toggle","menuStyle","isSelected","selectionForegroundColor","selectionBackgroundColor","selectionBorderColor","toString","submenuActions","submenuOptions","mysubmenu","submenuDisposables","mouseOver","expandDirection","Right","showScheduler","cleanupExistingSubmenu","createSubmenu","hideScheduler","submenu","updateAriaExpanded","submenuIndicator","menuSubmenu","KEY_UP","MOUSE_LEAVE","FOCUS_OUT","force","dispose","submenuContainer","clear","calculateSubmenuMenuLayout","windowDimensions","entry","ret","left","width","offset","size","height","selectFirstItem","computedStyles","getComputedStyle","paddingTop","parseFloat","zIndex","entryBox","entryBoxUpdated","viewBox","innerWidth","lift","onDidCancel","value","borderBottomColor","separatorColor","regex","mnemonicInText","result","scrollbarShadowColor","scrollbarShadow","scrollbarSliderBackgroundColor","scrollbarSliderBackground","scrollbarSliderHoverBackgroundColor","scrollbarSliderHoverBackground","scrollbarSliderActiveBackgroundColor","scrollbarSliderActiveBackground"],"mappings":"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C,EAAmD7D,IAAnD,EAAP;AACH;;AACD,SAASzE,gBAAT,CAA0BpC,KAA1B,EAAiC;AAC7B,MAAI2K,MAAM;AAAG;AAAW;AAC5B;AACA;AACA;AACA;AACA;AACA,EAAExQ,UAAU,CAACO,OAAO,CAAC0K,aAAT,CAAwB;AACpC,EAAEjL,UAAU,CAACO,OAAO,CAAC+N,WAAT,CAAsB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAlVI,CAD6B,CAoV7B;;AACA,QAAMmC,oBAAoB,GAAG5K,KAAK,CAAC6K,eAAnC;;AACA,MAAID,oBAAJ,EAA0B;AACtBD,IAAAA,MAAM,IAAK;AACnB;AACA,kBAAkBC,oBAAqB;AACvC;AACA;AACA;AACA,kBAAkBA,oBAAqB;AACvC;AACA;AACA;AACA,kBAAkBA,oBAAqB;AACvC;AACA,GAZQ;AAaH;;AACD,QAAME,8BAA8B,GAAG9K,KAAK,CAAC+K,yBAA7C;;AACA,MAAID,8BAAJ,EAAoC;AAChCH,IAAAA,MAAM,IAAK;AACnB;AACA,kBAAkBG,8BAA+B;AACjD;AACA,GAJQ;AAKH;;AACD,QAAME,mCAAmC,GAAGhL,KAAK,CAACiL,8BAAlD;;AACA,MAAID,mCAAJ,EAAyC;AACrCL,IAAAA,MAAM,IAAK;AACnB;AACA,kBAAkBK,mCAAoC;AACtD;AACA,GAJQ;AAKH;;AACD,QAAME,oCAAoC,GAAGlL,KAAK,CAACmL,+BAAnD;;AACA,MAAID,oCAAJ,EAA0C;AACtCP,IAAAA,MAAM,IAAK;AACnB;AACA,kBAAkBO,oCAAqC;AACvD;AACA,GAJQ;AAKH;;AACD,SAAOP,MAAP;AACH","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isFirefox } from '../../browser.js';\nimport { EventType as TouchEventType, Gesture } from '../../touch.js';\nimport { $, addDisposableListener, append, clearNode, createStyleSheet, Dimension, EventHelper, EventType, getActiveElement, isAncestor, isInShadowDOM } from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { ActionBar } from '../actionbar/actionbar.js';\nimport { ActionViewItem, BaseActionViewItem } from '../actionbar/actionViewItems.js';\nimport { formatRule } from '../codicons/codiconStyles.js';\nimport { layout } from '../contextview/contextview.js';\nimport { DomScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { EmptySubmenuAction, Separator, SubmenuAction } from '../../../common/actions.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { stripIcons } from '../../../common/iconLabels.js';\nimport { DisposableStore } from '../../../common/lifecycle.js';\nimport { isLinux, isMacintosh } from '../../../common/platform.js';\nimport * as strings from '../../../common/strings.js';\nexport const MENU_MNEMONIC_REGEX = /\\(&([^\\s&])\\)|(^|[^&])&([^\\s&])/;\nexport const MENU_ESCAPED_MNEMONIC_REGEX = /(&amp;)?(&amp;)([^\\s&])/g;\nexport var Direction;\n(function (Direction) {\n    Direction[Direction[\"Right\"] = 0] = \"Right\";\n    Direction[Direction[\"Left\"] = 1] = \"Left\";\n})(Direction || (Direction = {}));\nexport class Menu extends ActionBar {\n    constructor(container, actions, options = {}) {\n        container.classList.add('monaco-menu-container');\n        container.setAttribute('role', 'presentation');\n        const menuElement = document.createElement('div');\n        menuElement.classList.add('monaco-menu');\n        menuElement.setAttribute('role', 'presentation');\n        super(menuElement, {\n            orientation: 1 /* VERTICAL */,\n            actionViewItemProvider: action => this.doGetActionViewItem(action, options, parentData),\n            context: options.context,\n            actionRunner: options.actionRunner,\n            ariaLabel: options.ariaLabel,\n            focusOnlyEnabledItems: true,\n            triggerKeys: { keys: [3 /* Enter */, ...(isMacintosh || isLinux ? [10 /* Space */] : [])], keyDown: true }\n        });\n        this.menuElement = menuElement;\n        this.actionsList.setAttribute('role', 'menu');\n        this.actionsList.tabIndex = 0;\n        this.menuDisposables = this._register(new DisposableStore());\n        this.initializeOrUpdateStyleSheet(container, {});\n        this._register(Gesture.addTarget(menuElement));\n        addDisposableListener(menuElement, EventType.KEY_DOWN, (e) => {\n            const event = new StandardKeyboardEvent(e);\n            // Stop tab navigation of menus\n            if (event.equals(2 /* Tab */)) {\n                e.preventDefault();\n            }\n        });\n        if (options.enableMnemonics) {\n            this.menuDisposables.add(addDisposableListener(menuElement, EventType.KEY_DOWN, (e) => {\n                const key = e.key.toLocaleLowerCase();\n                if (this.mnemonics.has(key)) {\n                    EventHelper.stop(e, true);\n                    const actions = this.mnemonics.get(key);\n                    if (actions.length === 1) {\n                        if (actions[0] instanceof SubmenuMenuActionViewItem && actions[0].container) {\n                            this.focusItemByElement(actions[0].container);\n                        }\n                        actions[0].onClick(e);\n                    }\n                    if (actions.length > 1) {\n                        const action = actions.shift();\n                        if (action && action.container) {\n                            this.focusItemByElement(action.container);\n                            actions.push(action);\n                        }\n                        this.mnemonics.set(key, actions);\n                    }\n                }\n            }));\n        }\n        if (isLinux) {\n            this._register(addDisposableListener(menuElement, EventType.KEY_DOWN, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(14 /* Home */) || event.equals(11 /* PageUp */)) {\n                    this.focusedItem = this.viewItems.length - 1;\n                    this.focusNext();\n                    EventHelper.stop(e, true);\n                }\n                else if (event.equals(13 /* End */) || event.equals(12 /* PageDown */)) {\n                    this.focusedItem = 0;\n                    this.focusPrevious();\n                    EventHelper.stop(e, true);\n                }\n            }));\n        }\n        this._register(addDisposableListener(this.domNode, EventType.MOUSE_OUT, e => {\n            let relatedTarget = e.relatedTarget;\n            if (!isAncestor(relatedTarget, this.domNode)) {\n                this.focusedItem = undefined;\n                this.updateFocus();\n                e.stopPropagation();\n            }\n        }));\n        this._register(addDisposableListener(this.actionsList, EventType.MOUSE_OVER, e => {\n            let target = e.target;\n            if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n                return;\n            }\n            while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n                target = target.parentElement;\n            }\n            if (target.classList.contains('action-item')) {\n                const lastFocusedItem = this.focusedItem;\n                this.setFocusedItem(target);\n                if (lastFocusedItem !== this.focusedItem) {\n                    this.updateFocus();\n                }\n            }\n        }));\n        // Support touch on actions list to focus items (needed for submenus)\n        this._register(Gesture.addTarget(this.actionsList));\n        this._register(addDisposableListener(this.actionsList, TouchEventType.Tap, e => {\n            let target = e.initialTarget;\n            if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n                return;\n            }\n            while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n                target = target.parentElement;\n            }\n            if (target.classList.contains('action-item')) {\n                const lastFocusedItem = this.focusedItem;\n                this.setFocusedItem(target);\n                if (lastFocusedItem !== this.focusedItem) {\n                    this.updateFocus();\n                }\n            }\n        }));\n        let parentData = {\n            parent: this\n        };\n        this.mnemonics = new Map();\n        // Scroll Logic\n        this.scrollableElement = this._register(new DomScrollableElement(menuElement, {\n            alwaysConsumeMouseWheel: true,\n            horizontal: 2 /* Hidden */,\n            vertical: 3 /* Visible */,\n            verticalScrollbarSize: 7,\n            handleMouseWheel: true,\n            useShadows: true\n        }));\n        const scrollElement = this.scrollableElement.getDomNode();\n        scrollElement.style.position = '';\n        // Support scroll on menu drag\n        this._register(addDisposableListener(menuElement, TouchEventType.Change, e => {\n            EventHelper.stop(e, true);\n            const scrollTop = this.scrollableElement.getScrollPosition().scrollTop;\n            this.scrollableElement.setScrollPosition({ scrollTop: scrollTop - e.translationY });\n        }));\n        this._register(addDisposableListener(scrollElement, EventType.MOUSE_UP, e => {\n            // Absorb clicks in menu dead space https://github.com/microsoft/vscode/issues/63575\n            // We do this on the scroll element so the scroll bar doesn't dismiss the menu either\n            e.preventDefault();\n        }));\n        menuElement.style.maxHeight = `${Math.max(10, window.innerHeight - container.getBoundingClientRect().top - 35)}px`;\n        actions = actions.filter(a => {\n            var _a;\n            if ((_a = options.submenuIds) === null || _a === void 0 ? void 0 : _a.has(a.id)) {\n                console.warn(`Found submenu cycle: ${a.id}`);\n                return false;\n            }\n            return true;\n        });\n        this.push(actions, { icon: true, label: true, isMenu: true });\n        container.appendChild(this.scrollableElement.getDomNode());\n        this.scrollableElement.scanDomNode();\n        this.viewItems.filter(item => !(item instanceof MenuSeparatorActionViewItem)).forEach((item, index, array) => {\n            item.updatePositionInSet(index + 1, array.length);\n        });\n    }\n    initializeOrUpdateStyleSheet(container, style) {\n        if (!this.styleSheet) {\n            if (isInShadowDOM(container)) {\n                this.styleSheet = createStyleSheet(container);\n            }\n            else {\n                if (!Menu.globalStyleSheet) {\n                    Menu.globalStyleSheet = createStyleSheet();\n                }\n                this.styleSheet = Menu.globalStyleSheet;\n            }\n        }\n        this.styleSheet.textContent = getMenuWidgetCSS(style);\n    }\n    style(style) {\n        const container = this.getContainer();\n        this.initializeOrUpdateStyleSheet(container, style);\n        const fgColor = style.foregroundColor ? `${style.foregroundColor}` : '';\n        const bgColor = style.backgroundColor ? `${style.backgroundColor}` : '';\n        const border = style.borderColor ? `1px solid ${style.borderColor}` : '';\n        const shadow = style.shadowColor ? `0 2px 4px ${style.shadowColor}` : '';\n        container.style.border = border;\n        this.domNode.style.color = fgColor;\n        this.domNode.style.backgroundColor = bgColor;\n        container.style.boxShadow = shadow;\n        if (this.viewItems) {\n            this.viewItems.forEach(item => {\n                if (item instanceof BaseMenuActionViewItem || item instanceof MenuSeparatorActionViewItem) {\n                    item.style(style);\n                }\n            });\n        }\n    }\n    getContainer() {\n        return this.scrollableElement.getDomNode();\n    }\n    get onScroll() {\n        return this.scrollableElement.onScroll;\n    }\n    focusItemByElement(element) {\n        const lastFocusedItem = this.focusedItem;\n        this.setFocusedItem(element);\n        if (lastFocusedItem !== this.focusedItem) {\n            this.updateFocus();\n        }\n    }\n    setFocusedItem(element) {\n        for (let i = 0; i < this.actionsList.children.length; i++) {\n            let elem = this.actionsList.children[i];\n            if (element === elem) {\n                this.focusedItem = i;\n                break;\n            }\n        }\n    }\n    updateFocus(fromRight) {\n        super.updateFocus(fromRight, true, true);\n        if (typeof this.focusedItem !== 'undefined') {\n            // Workaround for #80047 caused by an issue in chromium\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=414283\n            // When that's fixed, just call this.scrollableElement.scanDomNode()\n            this.scrollableElement.setScrollPosition({\n                scrollTop: Math.round(this.menuElement.scrollTop)\n            });\n        }\n    }\n    doGetActionViewItem(action, options, parentData) {\n        if (action instanceof Separator) {\n            return new MenuSeparatorActionViewItem(options.context, action, { icon: true });\n        }\n        else if (action instanceof SubmenuAction) {\n            const menuActionViewItem = new SubmenuMenuActionViewItem(action, action.actions, parentData, Object.assign(Object.assign({}, options), { submenuIds: new Set([...(options.submenuIds || []), action.id]) }));\n            if (options.enableMnemonics) {\n                const mnemonic = menuActionViewItem.getMnemonic();\n                if (mnemonic && menuActionViewItem.isEnabled()) {\n                    let actionViewItems = [];\n                    if (this.mnemonics.has(mnemonic)) {\n                        actionViewItems = this.mnemonics.get(mnemonic);\n                    }\n                    actionViewItems.push(menuActionViewItem);\n                    this.mnemonics.set(mnemonic, actionViewItems);\n                }\n            }\n            return menuActionViewItem;\n        }\n        else {\n            const menuItemOptions = { enableMnemonics: options.enableMnemonics, useEventAsContext: options.useEventAsContext };\n            if (options.getKeyBinding) {\n                const keybinding = options.getKeyBinding(action);\n                if (keybinding) {\n                    const keybindingLabel = keybinding.getLabel();\n                    if (keybindingLabel) {\n                        menuItemOptions.keybinding = keybindingLabel;\n                    }\n                }\n            }\n            const menuActionViewItem = new BaseMenuActionViewItem(options.context, action, menuItemOptions);\n            if (options.enableMnemonics) {\n                const mnemonic = menuActionViewItem.getMnemonic();\n                if (mnemonic && menuActionViewItem.isEnabled()) {\n                    let actionViewItems = [];\n                    if (this.mnemonics.has(mnemonic)) {\n                        actionViewItems = this.mnemonics.get(mnemonic);\n                    }\n                    actionViewItems.push(menuActionViewItem);\n                    this.mnemonics.set(mnemonic, actionViewItems);\n                }\n            }\n            return menuActionViewItem;\n        }\n    }\n}\nclass BaseMenuActionViewItem extends BaseActionViewItem {\n    constructor(ctx, action, options = {}) {\n        options.isMenu = true;\n        super(action, action, options);\n        this.options = options;\n        this.options.icon = options.icon !== undefined ? options.icon : false;\n        this.options.label = options.label !== undefined ? options.label : true;\n        this.cssClass = '';\n        // Set mnemonic\n        if (this.options.label && options.enableMnemonics) {\n            let label = this.getAction().label;\n            if (label) {\n                let matches = MENU_MNEMONIC_REGEX.exec(label);\n                if (matches) {\n                    this.mnemonic = (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase();\n                }\n            }\n        }\n        // Add mouse up listener later to avoid accidental clicks\n        this.runOnceToEnableMouseUp = new RunOnceScheduler(() => {\n            if (!this.element) {\n                return;\n            }\n            this._register(addDisposableListener(this.element, EventType.MOUSE_UP, e => {\n                // removed default prevention as it conflicts\n                // with BaseActionViewItem #101537\n                // add back if issues arise and link new issue\n                EventHelper.stop(e, true);\n                // See https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Interact_with_the_clipboard\n                // > Writing to the clipboard\n                // > You can use the \"cut\" and \"copy\" commands without any special\n                // permission if you are using them in a short-lived event handler\n                // for a user action (for example, a click handler).\n                // => to get the Copy and Paste context menu actions working on Firefox,\n                // there should be no timeout here\n                if (isFirefox) {\n                    const mouseEvent = new StandardMouseEvent(e);\n                    // Allowing right click to trigger the event causes the issue described below,\n                    // but since the solution below does not work in FF, we must disable right click\n                    if (mouseEvent.rightButton) {\n                        return;\n                    }\n                    this.onClick(e);\n                }\n                // In all other cases, set timeout to allow context menu cancellation to trigger\n                // otherwise the action will destroy the menu and a second context menu\n                // will still trigger for right click.\n                else {\n                    setTimeout(() => {\n                        this.onClick(e);\n                    }, 0);\n                }\n            }));\n            this._register(addDisposableListener(this.element, EventType.CONTEXT_MENU, e => {\n                EventHelper.stop(e, true);\n            }));\n        }, 100);\n        this._register(this.runOnceToEnableMouseUp);\n    }\n    render(container) {\n        super.render(container);\n        if (!this.element) {\n            return;\n        }\n        this.container = container;\n        this.item = append(this.element, $('a.action-menu-item'));\n        if (this._action.id === Separator.ID) {\n            // A separator is a presentation item\n            this.item.setAttribute('role', 'presentation');\n        }\n        else {\n            this.item.setAttribute('role', 'menuitem');\n            if (this.mnemonic) {\n                this.item.setAttribute('aria-keyshortcuts', `${this.mnemonic}`);\n            }\n        }\n        this.check = append(this.item, $('span.menu-item-check' + Codicon.menuSelection.cssSelector));\n        this.check.setAttribute('role', 'none');\n        this.label = append(this.item, $('span.action-label'));\n        if (this.options.label && this.options.keybinding) {\n            append(this.item, $('span.keybinding')).textContent = this.options.keybinding;\n        }\n        // Adds mouse up listener to actually run the action\n        this.runOnceToEnableMouseUp.schedule();\n        this.updateClass();\n        this.updateLabel();\n        this.updateTooltip();\n        this.updateEnabled();\n        this.updateChecked();\n    }\n    blur() {\n        super.blur();\n        this.applyStyle();\n    }\n    focus() {\n        super.focus();\n        if (this.item) {\n            this.item.focus();\n        }\n        this.applyStyle();\n    }\n    updatePositionInSet(pos, setSize) {\n        if (this.item) {\n            this.item.setAttribute('aria-posinset', `${pos}`);\n            this.item.setAttribute('aria-setsize', `${setSize}`);\n        }\n    }\n    updateLabel() {\n        if (!this.label) {\n            return;\n        }\n        if (this.options.label) {\n            clearNode(this.label);\n            let label = stripIcons(this.getAction().label);\n            if (label) {\n                const cleanLabel = cleanMnemonic(label);\n                if (!this.options.enableMnemonics) {\n                    label = cleanLabel;\n                }\n                this.label.setAttribute('aria-label', cleanLabel.replace(/&&/g, '&'));\n                const matches = MENU_MNEMONIC_REGEX.exec(label);\n                if (matches) {\n                    label = strings.escape(label);\n                    // This is global, reset it\n                    MENU_ESCAPED_MNEMONIC_REGEX.lastIndex = 0;\n                    let escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n                    // We can't use negative lookbehind so if we match our negative and skip\n                    while (escMatch && escMatch[1]) {\n                        escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n                    }\n                    const replaceDoubleEscapes = (str) => str.replace(/&amp;&amp;/g, '&amp;');\n                    if (escMatch) {\n                        this.label.append(strings.ltrim(replaceDoubleEscapes(label.substr(0, escMatch.index)), ' '), $('u', { 'aria-hidden': 'true' }, escMatch[3]), strings.rtrim(replaceDoubleEscapes(label.substr(escMatch.index + escMatch[0].length)), ' '));\n                    }\n                    else {\n                        this.label.innerText = replaceDoubleEscapes(label).trim();\n                    }\n                    if (this.item) {\n                        this.item.setAttribute('aria-keyshortcuts', (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase());\n                    }\n                }\n                else {\n                    this.label.innerText = label.replace(/&&/g, '&').trim();\n                }\n            }\n        }\n    }\n    updateTooltip() {\n        // menus should function like native menus and they do not have tooltips\n    }\n    updateClass() {\n        if (this.cssClass && this.item) {\n            this.item.classList.remove(...this.cssClass.split(' '));\n        }\n        if (this.options.icon && this.label) {\n            this.cssClass = this.getAction().class || '';\n            this.label.classList.add('icon');\n            if (this.cssClass) {\n                this.label.classList.add(...this.cssClass.split(' '));\n            }\n            this.updateEnabled();\n        }\n        else if (this.label) {\n            this.label.classList.remove('icon');\n        }\n    }\n    updateEnabled() {\n        if (this.getAction().enabled) {\n            if (this.element) {\n                this.element.classList.remove('disabled');\n                this.element.removeAttribute('aria-disabled');\n            }\n            if (this.item) {\n                this.item.classList.remove('disabled');\n                this.item.removeAttribute('aria-disabled');\n                this.item.tabIndex = 0;\n            }\n        }\n        else {\n            if (this.element) {\n                this.element.classList.add('disabled');\n                this.element.setAttribute('aria-disabled', 'true');\n            }\n            if (this.item) {\n                this.item.classList.add('disabled');\n                this.item.setAttribute('aria-disabled', 'true');\n            }\n        }\n    }\n    updateChecked() {\n        if (!this.item) {\n            return;\n        }\n        const checked = this.getAction().checked;\n        this.item.classList.toggle('checked', !!checked);\n        if (checked !== undefined) {\n            this.item.setAttribute('role', 'menuitemcheckbox');\n            this.item.setAttribute('aria-checked', checked ? 'true' : 'false');\n        }\n        else {\n            this.item.setAttribute('role', 'menuitem');\n            this.item.setAttribute('aria-checked', '');\n        }\n    }\n    getMnemonic() {\n        return this.mnemonic;\n    }\n    applyStyle() {\n        if (!this.menuStyle) {\n            return;\n        }\n        const isSelected = this.element && this.element.classList.contains('focused');\n        const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n        const bgColor = isSelected && this.menuStyle.selectionBackgroundColor ? this.menuStyle.selectionBackgroundColor : undefined;\n        const border = isSelected && this.menuStyle.selectionBorderColor ? `thin solid ${this.menuStyle.selectionBorderColor}` : '';\n        if (this.item) {\n            this.item.style.color = fgColor ? fgColor.toString() : '';\n            this.item.style.backgroundColor = bgColor ? bgColor.toString() : '';\n        }\n        if (this.check) {\n            this.check.style.color = fgColor ? fgColor.toString() : '';\n        }\n        if (this.container) {\n            this.container.style.border = border;\n        }\n    }\n    style(style) {\n        this.menuStyle = style;\n        this.applyStyle();\n    }\n}\nclass SubmenuMenuActionViewItem extends BaseMenuActionViewItem {\n    constructor(action, submenuActions, parentData, submenuOptions) {\n        super(action, action, submenuOptions);\n        this.submenuActions = submenuActions;\n        this.parentData = parentData;\n        this.submenuOptions = submenuOptions;\n        this.mysubmenu = null;\n        this.submenuDisposables = this._register(new DisposableStore());\n        this.mouseOver = false;\n        this.expandDirection = submenuOptions && submenuOptions.expandDirection !== undefined ? submenuOptions.expandDirection : Direction.Right;\n        this.showScheduler = new RunOnceScheduler(() => {\n            if (this.mouseOver) {\n                this.cleanupExistingSubmenu(false);\n                this.createSubmenu(false);\n            }\n        }, 250);\n        this.hideScheduler = new RunOnceScheduler(() => {\n            if (this.element && (!isAncestor(getActiveElement(), this.element) && this.parentData.submenu === this.mysubmenu)) {\n                this.parentData.parent.focus(false);\n                this.cleanupExistingSubmenu(true);\n            }\n        }, 750);\n    }\n    render(container) {\n        super.render(container);\n        if (!this.element) {\n            return;\n        }\n        if (this.item) {\n            this.item.classList.add('monaco-submenu-item');\n            this.item.tabIndex = 0;\n            this.item.setAttribute('aria-haspopup', 'true');\n            this.updateAriaExpanded('false');\n            this.submenuIndicator = append(this.item, $('span.submenu-indicator' + Codicon.menuSubmenu.cssSelector));\n            this.submenuIndicator.setAttribute('aria-hidden', 'true');\n        }\n        this._register(addDisposableListener(this.element, EventType.KEY_UP, e => {\n            let event = new StandardKeyboardEvent(e);\n            if (event.equals(17 /* RightArrow */) || event.equals(3 /* Enter */)) {\n                EventHelper.stop(e, true);\n                this.createSubmenu(true);\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.KEY_DOWN, e => {\n            let event = new StandardKeyboardEvent(e);\n            if (getActiveElement() === this.item) {\n                if (event.equals(17 /* RightArrow */) || event.equals(3 /* Enter */)) {\n                    EventHelper.stop(e, true);\n                }\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.MOUSE_OVER, e => {\n            if (!this.mouseOver) {\n                this.mouseOver = true;\n                this.showScheduler.schedule();\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.MOUSE_LEAVE, e => {\n            this.mouseOver = false;\n        }));\n        this._register(addDisposableListener(this.element, EventType.FOCUS_OUT, e => {\n            if (this.element && !isAncestor(getActiveElement(), this.element)) {\n                this.hideScheduler.schedule();\n            }\n        }));\n        this._register(this.parentData.parent.onScroll(() => {\n            this.parentData.parent.focus(false);\n            this.cleanupExistingSubmenu(false);\n        }));\n    }\n    updateEnabled() {\n        // override on submenu entry\n        // native menus do not observe enablement on sumbenus\n        // we mimic that behavior\n    }\n    onClick(e) {\n        // stop clicking from trying to run an action\n        EventHelper.stop(e, true);\n        this.cleanupExistingSubmenu(false);\n        this.createSubmenu(true);\n    }\n    cleanupExistingSubmenu(force) {\n        if (this.parentData.submenu && (force || (this.parentData.submenu !== this.mysubmenu))) {\n            // disposal may throw if the submenu has already been removed\n            try {\n                this.parentData.submenu.dispose();\n            }\n            catch (_a) { }\n            this.parentData.submenu = undefined;\n            this.updateAriaExpanded('false');\n            if (this.submenuContainer) {\n                this.submenuDisposables.clear();\n                this.submenuContainer = undefined;\n            }\n        }\n    }\n    calculateSubmenuMenuLayout(windowDimensions, submenu, entry, expandDirection) {\n        const ret = { top: 0, left: 0 };\n        // Start with horizontal\n        ret.left = layout(windowDimensions.width, submenu.width, { position: expandDirection === Direction.Right ? 0 /* Before */ : 1 /* After */, offset: entry.left, size: entry.width });\n        // We don't have enough room to layout the menu fully, so we are overlapping the menu\n        if (ret.left >= entry.left && ret.left < entry.left + entry.width) {\n            if (entry.left + 10 + submenu.width <= windowDimensions.width) {\n                ret.left = entry.left + 10;\n            }\n            entry.top += 10;\n            entry.height = 0;\n        }\n        // Now that we have a horizontal position, try layout vertically\n        ret.top = layout(windowDimensions.height, submenu.height, { position: 0 /* Before */, offset: entry.top, size: 0 });\n        // We didn't have enough room below, but we did above, so we shift down to align the menu\n        if (ret.top + submenu.height === entry.top && ret.top + entry.height + submenu.height <= windowDimensions.height) {\n            ret.top += entry.height;\n        }\n        return ret;\n    }\n    createSubmenu(selectFirstItem = true) {\n        if (!this.element) {\n            return;\n        }\n        if (!this.parentData.submenu) {\n            this.updateAriaExpanded('true');\n            this.submenuContainer = append(this.element, $('div.monaco-submenu'));\n            this.submenuContainer.classList.add('menubar-menu-items-holder', 'context-view');\n            // Set the top value of the menu container before construction\n            // This allows the menu constructor to calculate the proper max height\n            const computedStyles = getComputedStyle(this.parentData.parent.domNode);\n            const paddingTop = parseFloat(computedStyles.paddingTop || '0') || 0;\n            // this.submenuContainer.style.top = `${this.element.offsetTop - this.parentData.parent.scrollOffset - paddingTop}px`;\n            this.submenuContainer.style.zIndex = '1';\n            this.submenuContainer.style.position = 'fixed';\n            this.submenuContainer.style.top = '0';\n            this.submenuContainer.style.left = '0';\n            this.parentData.submenu = new Menu(this.submenuContainer, this.submenuActions.length ? this.submenuActions : [new EmptySubmenuAction()], this.submenuOptions);\n            if (this.menuStyle) {\n                this.parentData.submenu.style(this.menuStyle);\n            }\n            // layout submenu\n            const entryBox = this.element.getBoundingClientRect();\n            const entryBoxUpdated = {\n                top: entryBox.top - paddingTop,\n                left: entryBox.left,\n                height: entryBox.height + 2 * paddingTop,\n                width: entryBox.width\n            };\n            const viewBox = this.submenuContainer.getBoundingClientRect();\n            const { top, left } = this.calculateSubmenuMenuLayout(new Dimension(window.innerWidth, window.innerHeight), Dimension.lift(viewBox), entryBoxUpdated, this.expandDirection);\n            // subtract offsets caused by transform parent\n            this.submenuContainer.style.left = `${left - viewBox.left}px`;\n            this.submenuContainer.style.top = `${top - viewBox.top}px`;\n            this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_UP, e => {\n                let event = new StandardKeyboardEvent(e);\n                if (event.equals(15 /* LeftArrow */)) {\n                    EventHelper.stop(e, true);\n                    this.parentData.parent.focus();\n                    this.cleanupExistingSubmenu(true);\n                }\n            }));\n            this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_DOWN, e => {\n                let event = new StandardKeyboardEvent(e);\n                if (event.equals(15 /* LeftArrow */)) {\n                    EventHelper.stop(e, true);\n                }\n            }));\n            this.submenuDisposables.add(this.parentData.submenu.onDidCancel(() => {\n                this.parentData.parent.focus();\n                this.cleanupExistingSubmenu(true);\n            }));\n            this.parentData.submenu.focus(selectFirstItem);\n            this.mysubmenu = this.parentData.submenu;\n        }\n        else {\n            this.parentData.submenu.focus(false);\n        }\n    }\n    updateAriaExpanded(value) {\n        var _a;\n        if (this.item) {\n            (_a = this.item) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-expanded', value);\n        }\n    }\n    applyStyle() {\n        super.applyStyle();\n        if (!this.menuStyle) {\n            return;\n        }\n        const isSelected = this.element && this.element.classList.contains('focused');\n        const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n        if (this.submenuIndicator) {\n            this.submenuIndicator.style.color = fgColor ? `${fgColor}` : '';\n        }\n        if (this.parentData.submenu) {\n            this.parentData.submenu.style(this.menuStyle);\n        }\n    }\n    dispose() {\n        super.dispose();\n        this.hideScheduler.dispose();\n        if (this.mysubmenu) {\n            this.mysubmenu.dispose();\n            this.mysubmenu = null;\n        }\n        if (this.submenuContainer) {\n            this.submenuContainer = undefined;\n        }\n    }\n}\nclass MenuSeparatorActionViewItem extends ActionViewItem {\n    style(style) {\n        if (this.label) {\n            this.label.style.borderBottomColor = style.separatorColor ? `${style.separatorColor}` : '';\n        }\n    }\n}\nexport function cleanMnemonic(label) {\n    const regex = MENU_MNEMONIC_REGEX;\n    const matches = regex.exec(label);\n    if (!matches) {\n        return label;\n    }\n    const mnemonicInText = !matches[1];\n    return label.replace(regex, mnemonicInText ? '$2$3' : '').trim();\n}\nfunction getMenuWidgetCSS(style) {\n    let result = /* css */ `\n.monaco-menu {\n\tfont-size: 13px;\n\n}\n\n${formatRule(Codicon.menuSelection)}\n${formatRule(Codicon.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\topacity: 0.4;\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid #bbb;\n\tpadding-top: 1px;\n\tmargin-left: .8em;\n\tmargin-right: .8em;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tpadding: 0.5em 0 0 0;\n\tmargin-bottom: 0.5em;\n\twidth: 100%;\n\theight: 0px !important;\n\tmargin-left: .8em !important;\n\tmargin-right: .8em !important;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tborder: thin solid transparent; /* prevents jumping behaviour on hover or focus */\n}\n\n\n/* High Contrast Theming */\n:host-context(.hc-black) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .5em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 1.8em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tpadding: 0.2em 0 0 0;\n\tmargin-bottom: 0.2em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}\n\n/* Arrows */\n.monaco-scrollable-element > .scrollbar > .scra {\n\tcursor: pointer;\n\tfont-size: 11px !important;\n}\n\n.monaco-scrollable-element > .visible {\n\topacity: 1;\n\n\t/* Background rule added for IE9 - to allow clicks on dom node */\n\tbackground:rgba(0,0,0,0);\n\n\ttransition: opacity 100ms linear;\n}\n.monaco-scrollable-element > .invisible {\n\topacity: 0;\n\tpointer-events: none;\n}\n.monaco-scrollable-element > .invisible.fade {\n\ttransition: opacity 800ms linear;\n}\n\n/* Scrollable Content Inset Shadow */\n.monaco-scrollable-element > .shadow {\n\tposition: absolute;\n\tdisplay: none;\n}\n.monaco-scrollable-element > .shadow.top {\n\tdisplay: block;\n\ttop: 0;\n\tleft: 3px;\n\theight: 3px;\n\twidth: 100%;\n}\n.monaco-scrollable-element > .shadow.left {\n\tdisplay: block;\n\ttop: 3px;\n\tleft: 0;\n\theight: 100%;\n\twidth: 3px;\n}\n.monaco-scrollable-element > .shadow.top-left-corner {\n\tdisplay: block;\n\ttop: 0;\n\tleft: 0;\n\theight: 3px;\n\twidth: 3px;\n}\n`;\n    // Scrollbars\n    const scrollbarShadowColor = style.scrollbarShadow;\n    if (scrollbarShadowColor) {\n        result += `\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 0 6px 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 0 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 6px 6px -6px inset;\n\t\t\t}\n\t\t`;\n    }\n    const scrollbarSliderBackgroundColor = style.scrollbarSliderBackground;\n    if (scrollbarSliderBackgroundColor) {\n        result += `\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t}\n\t\t`;\n    }\n    const scrollbarSliderHoverBackgroundColor = style.scrollbarSliderHoverBackground;\n    if (scrollbarSliderHoverBackgroundColor) {\n        result += `\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t}\n\t\t`;\n    }\n    const scrollbarSliderActiveBackgroundColor = style.scrollbarSliderActiveBackground;\n    if (scrollbarSliderActiveBackgroundColor) {\n        result += `\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t}\n\t\t`;\n    }\n    return result;\n}\n"]},"metadata":{},"sourceType":"module"}