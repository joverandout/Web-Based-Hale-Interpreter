{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { $, addDisposableListener, append, asCSSUrl, EventType, ModifierKeyEmitter, prepend } from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from '../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { DropdownMenuActionViewItem } from '../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\nimport { ActionRunner, Separator, SubmenuAction } from '../../../base/common/actions.js';\nimport { UILabelProvider } from '../../../base/common/keybindingLabels.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { isLinux, isWindows, OS } from '../../../base/common/platform.js';\nimport './menuEntryActionViewItem.css';\nimport { localize } from '../../../nls.js';\nimport { IMenuService, MenuItemAction, SubmenuItemAction } from '../common/actions.js';\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { INotificationService } from '../../notification/common/notification.js';\nimport { IStorageService } from '../../storage/common/storage.js';\nimport { ThemeIcon } from '../../theme/common/themeService.js';\nexport function createAndFillInActionBarActions(menu, options, target, primaryGroup, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions) {\n  const groups = menu.getActions(options);\n  const isPrimaryAction = typeof primaryGroup === 'string' ? actionGroup => actionGroup === primaryGroup : primaryGroup; // Action bars handle alternative actions on their own so the alternative actions should be ignored\n\n  fillInActions(groups, target, false, isPrimaryAction, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions);\n  return asDisposable(groups);\n}\n\nfunction asDisposable(groups) {\n  const disposables = new DisposableStore();\n\n  for (const [, actions] of groups) {\n    for (const action of actions) {\n      disposables.add(action);\n    }\n  }\n\n  return disposables;\n}\n\nfunction fillInActions(groups, target, useAlternativeActions, isPrimaryAction = actionGroup => actionGroup === 'navigation', primaryMaxCount = Number.MAX_SAFE_INTEGER, shouldInlineSubmenu = () => false, useSeparatorsInPrimaryActions = false) {\n  let primaryBucket;\n  let secondaryBucket;\n\n  if (Array.isArray(target)) {\n    primaryBucket = target;\n    secondaryBucket = target;\n  } else {\n    primaryBucket = target.primary;\n    secondaryBucket = target.secondary;\n  }\n\n  const submenuInfo = new Set();\n\n  for (const [group, actions] of groups) {\n    let target;\n\n    if (isPrimaryAction(group)) {\n      target = primaryBucket;\n\n      if (target.length > 0 && useSeparatorsInPrimaryActions) {\n        target.push(new Separator());\n      }\n    } else {\n      target = secondaryBucket;\n\n      if (target.length > 0) {\n        target.push(new Separator());\n      }\n    }\n\n    for (let action of actions) {\n      if (useAlternativeActions) {\n        action = action instanceof MenuItemAction && action.alt ? action.alt : action;\n      }\n\n      const newLen = target.push(action); // keep submenu info for later inlining\n\n      if (action instanceof SubmenuAction) {\n        submenuInfo.add({\n          group,\n          action,\n          index: newLen - 1\n        });\n      }\n    }\n  } // ask the outside if submenu should be inlined or not. only ask when\n  // there would be enough space\n\n\n  for (const {\n    group,\n    action,\n    index\n  } of submenuInfo) {\n    const target = isPrimaryAction(group) ? primaryBucket : secondaryBucket; // inlining submenus with length 0 or 1 is easy,\n    // larger submenus need to be checked with the overall limit\n\n    const submenuActions = action.actions;\n\n    if ((submenuActions.length <= 1 || target.length + submenuActions.length - 2 <= primaryMaxCount) && shouldInlineSubmenu(action, group, target.length)) {\n      target.splice(index, 1, ...submenuActions);\n    }\n  } // overflow items from the primary group into the secondary bucket\n\n\n  if (primaryBucket !== secondaryBucket && primaryBucket.length > primaryMaxCount) {\n    const overflow = primaryBucket.splice(primaryMaxCount, primaryBucket.length - primaryMaxCount);\n    secondaryBucket.unshift(...overflow, new Separator());\n  }\n}\n\nlet MenuEntryActionViewItem = class MenuEntryActionViewItem extends ActionViewItem {\n  constructor(_action, options, _keybindingService, _notificationService, _contextKeyService) {\n    super(undefined, _action, {\n      icon: !!(_action.class || _action.item.icon),\n      label: !_action.class && !_action.item.icon,\n      draggable: options === null || options === void 0 ? void 0 : options.draggable\n    });\n    this._keybindingService = _keybindingService;\n    this._notificationService = _notificationService;\n    this._contextKeyService = _contextKeyService;\n    this._wantsAltCommand = false;\n    this._itemClassDispose = this._register(new MutableDisposable());\n    this._altKey = ModifierKeyEmitter.getInstance();\n  }\n\n  get _menuItemAction() {\n    return this._action;\n  }\n\n  get _commandAction() {\n    return this._wantsAltCommand && this._menuItemAction.alt || this._menuItemAction;\n  }\n\n  onClick(event) {\n    return __awaiter(this, void 0, void 0, function* () {\n      event.preventDefault();\n      event.stopPropagation();\n\n      try {\n        yield this.actionRunner.run(this._commandAction, this._context);\n      } catch (err) {\n        this._notificationService.error(err);\n      }\n    });\n  }\n\n  render(container) {\n    super.render(container);\n    container.classList.add('menu-entry');\n\n    this._updateItemClass(this._menuItemAction.item);\n\n    let mouseOver = false;\n    let alternativeKeyDown = this._altKey.keyStatus.altKey || (isWindows || isLinux) && this._altKey.keyStatus.shiftKey;\n\n    const updateAltState = () => {\n      const wantsAltCommand = mouseOver && alternativeKeyDown;\n\n      if (wantsAltCommand !== this._wantsAltCommand) {\n        this._wantsAltCommand = wantsAltCommand;\n        this.updateLabel();\n        this.updateTooltip();\n        this.updateClass();\n      }\n    };\n\n    if (this._menuItemAction.alt) {\n      this._register(this._altKey.event(value => {\n        alternativeKeyDown = value.altKey || (isWindows || isLinux) && value.shiftKey;\n        updateAltState();\n      }));\n    }\n\n    this._register(addDisposableListener(container, 'mouseleave', _ => {\n      mouseOver = false;\n      updateAltState();\n    }));\n\n    this._register(addDisposableListener(container, 'mouseenter', _ => {\n      mouseOver = true;\n      updateAltState();\n    }));\n  }\n\n  updateLabel() {\n    if (this.options.label && this.label) {\n      this.label.textContent = this._commandAction.label;\n    }\n  }\n\n  updateTooltip() {\n    if (this.label) {\n      const keybinding = this._keybindingService.lookupKeybinding(this._commandAction.id, this._contextKeyService);\n\n      const keybindingLabel = keybinding && keybinding.getLabel();\n      const tooltip = this._commandAction.tooltip || this._commandAction.label;\n      let title = keybindingLabel ? localize('titleAndKb', \"{0} ({1})\", tooltip, keybindingLabel) : tooltip;\n\n      if (!this._wantsAltCommand && this._menuItemAction.alt) {\n        const altTooltip = this._menuItemAction.alt.tooltip || this._menuItemAction.alt.label;\n\n        const altKeybinding = this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id, this._contextKeyService);\n\n        const altKeybindingLabel = altKeybinding && altKeybinding.getLabel();\n        const altTitleSection = altKeybindingLabel ? localize('titleAndKb', \"{0} ({1})\", altTooltip, altKeybindingLabel) : altTooltip;\n        title += `\\n[${UILabelProvider.modifierLabels[OS].altKey}] ${altTitleSection}`;\n      }\n\n      this.label.title = title;\n    }\n  }\n\n  updateClass() {\n    if (this.options.icon) {\n      if (this._commandAction !== this._menuItemAction) {\n        if (this._menuItemAction.alt) {\n          this._updateItemClass(this._menuItemAction.alt.item);\n        }\n      } else if (this._menuItemAction.alt) {\n        this._updateItemClass(this._menuItemAction.item);\n      }\n    }\n  }\n\n  _updateItemClass(item) {\n    var _a;\n\n    this._itemClassDispose.value = undefined;\n    const {\n      element,\n      label\n    } = this;\n\n    if (!element || !label) {\n      return;\n    }\n\n    const icon = this._commandAction.checked && ((_a = item.toggled) === null || _a === void 0 ? void 0 : _a.icon) ? item.toggled.icon : item.icon;\n\n    if (!icon) {\n      return;\n    }\n\n    if (ThemeIcon.isThemeIcon(icon)) {\n      // theme icons\n      const iconClasses = ThemeIcon.asClassNameArray(icon);\n      label.classList.add(...iconClasses);\n      this._itemClassDispose.value = toDisposable(() => {\n        label.classList.remove(...iconClasses);\n      });\n    } else {\n      // icon path/url\n      if (icon.light) {\n        label.style.setProperty('--menu-entry-icon-light', asCSSUrl(icon.light));\n      }\n\n      if (icon.dark) {\n        label.style.setProperty('--menu-entry-icon-dark', asCSSUrl(icon.dark));\n      }\n\n      label.classList.add('icon');\n      this._itemClassDispose.value = toDisposable(() => {\n        label.classList.remove('icon');\n        label.style.removeProperty('--menu-entry-icon-light');\n        label.style.removeProperty('--menu-entry-icon-dark');\n      });\n    }\n  }\n\n};\nMenuEntryActionViewItem = __decorate([__param(2, IKeybindingService), __param(3, INotificationService), __param(4, IContextKeyService)], MenuEntryActionViewItem);\nexport { MenuEntryActionViewItem };\nlet SubmenuEntryActionViewItem = class SubmenuEntryActionViewItem extends DropdownMenuActionViewItem {\n  constructor(action, options, contextMenuService) {\n    var _a, _b;\n\n    const dropdownOptions = Object.assign({}, options !== null && options !== void 0 ? options : Object.create(null), {\n      menuAsChild: (_a = options === null || options === void 0 ? void 0 : options.menuAsChild) !== null && _a !== void 0 ? _a : false,\n      classNames: (_b = options === null || options === void 0 ? void 0 : options.classNames) !== null && _b !== void 0 ? _b : ThemeIcon.isThemeIcon(action.item.icon) ? ThemeIcon.asClassName(action.item.icon) : undefined\n    });\n    super(action, {\n      getActions: () => action.actions\n    }, contextMenuService, dropdownOptions);\n  }\n\n  render(container) {\n    super.render(container);\n\n    if (this.element) {\n      container.classList.add('menu-entry');\n      const {\n        icon\n      } = this._action.item;\n\n      if (icon && !ThemeIcon.isThemeIcon(icon)) {\n        this.element.classList.add('icon');\n\n        if (icon.light) {\n          this.element.style.setProperty('--menu-entry-icon-light', asCSSUrl(icon.light));\n        }\n\n        if (icon.dark) {\n          this.element.style.setProperty('--menu-entry-icon-dark', asCSSUrl(icon.dark));\n        }\n      }\n    }\n  }\n\n};\nSubmenuEntryActionViewItem = __decorate([__param(2, IContextMenuService)], SubmenuEntryActionViewItem);\nexport { SubmenuEntryActionViewItem };\nlet DropdownWithDefaultActionViewItem = class DropdownWithDefaultActionViewItem extends BaseActionViewItem {\n  constructor(submenuAction, options, _keybindingService, _notificationService, _contextMenuService, _menuService, _instaService, _storageService) {\n    var _a, _b, _c;\n\n    super(null, submenuAction);\n    this._keybindingService = _keybindingService;\n    this._notificationService = _notificationService;\n    this._contextMenuService = _contextMenuService;\n    this._menuService = _menuService;\n    this._instaService = _instaService;\n    this._storageService = _storageService;\n    this._container = null;\n    this._storageKey = `${submenuAction.item.submenu._debugName}_lastActionId`; // determine default action\n\n    let defaultAction;\n\n    let defaultActionId = _storageService.get(this._storageKey, 1\n    /* WORKSPACE */\n    );\n\n    if (defaultActionId) {\n      defaultAction = submenuAction.actions.find(a => defaultActionId === a.id);\n    }\n\n    if (!defaultAction) {\n      defaultAction = submenuAction.actions[0];\n    }\n\n    this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, defaultAction, undefined);\n    const dropdownOptions = Object.assign({}, options !== null && options !== void 0 ? options : Object.create(null), {\n      menuAsChild: (_a = options === null || options === void 0 ? void 0 : options.menuAsChild) !== null && _a !== void 0 ? _a : true,\n      classNames: (_b = options === null || options === void 0 ? void 0 : options.classNames) !== null && _b !== void 0 ? _b : ['codicon', 'codicon-chevron-down'],\n      actionRunner: (_c = options === null || options === void 0 ? void 0 : options.actionRunner) !== null && _c !== void 0 ? _c : new ActionRunner()\n    });\n    this._dropdown = new DropdownMenuActionViewItem(submenuAction, submenuAction.actions, this._contextMenuService, dropdownOptions);\n\n    this._dropdown.actionRunner.onDidRun(e => {\n      if (e.action instanceof MenuItemAction) {\n        this.update(e.action);\n      }\n    });\n  }\n\n  update(lastAction) {\n    this._storageService.store(this._storageKey, lastAction.id, 1\n    /* WORKSPACE */\n    , 0\n    /* USER */\n    );\n\n    this._defaultAction.dispose();\n\n    this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, lastAction, undefined);\n    this._defaultAction.actionRunner = new class extends ActionRunner {\n      runAction(action, context) {\n        return __awaiter(this, void 0, void 0, function* () {\n          yield action.run(undefined);\n        });\n      }\n\n    }();\n\n    if (this._container) {\n      this._defaultAction.render(prepend(this._container, $('.action-container')));\n    }\n  }\n\n  setActionContext(newContext) {\n    super.setActionContext(newContext);\n\n    this._defaultAction.setActionContext(newContext);\n\n    this._dropdown.setActionContext(newContext);\n  }\n\n  render(container) {\n    this._container = container;\n    super.render(this._container);\n\n    this._container.classList.add('monaco-dropdown-with-default');\n\n    const primaryContainer = $('.action-container');\n\n    this._defaultAction.render(append(this._container, primaryContainer));\n\n    this._register(addDisposableListener(primaryContainer, EventType.KEY_DOWN, e => {\n      const event = new StandardKeyboardEvent(e);\n\n      if (event.equals(17\n      /* RightArrow */\n      )) {\n        this._defaultAction.element.tabIndex = -1;\n\n        this._dropdown.focus();\n\n        event.stopPropagation();\n      }\n    }));\n\n    const dropdownContainer = $('.dropdown-action-container');\n\n    this._dropdown.render(append(this._container, dropdownContainer));\n\n    this._register(addDisposableListener(dropdownContainer, EventType.KEY_DOWN, e => {\n      var _a;\n\n      const event = new StandardKeyboardEvent(e);\n\n      if (event.equals(15\n      /* LeftArrow */\n      )) {\n        this._defaultAction.element.tabIndex = 0;\n\n        this._dropdown.setFocusable(false);\n\n        (_a = this._defaultAction.element) === null || _a === void 0 ? void 0 : _a.focus();\n        event.stopPropagation();\n      }\n    }));\n  }\n\n  focus(fromRight) {\n    if (fromRight) {\n      this._dropdown.focus();\n    } else {\n      this._defaultAction.element.tabIndex = 0;\n\n      this._defaultAction.element.focus();\n    }\n  }\n\n  blur() {\n    this._defaultAction.element.tabIndex = -1;\n\n    this._dropdown.blur();\n\n    this._container.blur();\n  }\n\n  setFocusable(focusable) {\n    if (focusable) {\n      this._defaultAction.element.tabIndex = 0;\n    } else {\n      this._defaultAction.element.tabIndex = -1;\n\n      this._dropdown.setFocusable(false);\n    }\n  }\n\n  dispose() {\n    this._defaultAction.dispose();\n\n    this._dropdown.dispose();\n\n    super.dispose();\n  }\n\n};\nDropdownWithDefaultActionViewItem = __decorate([__param(2, IKeybindingService), __param(3, INotificationService), __param(4, IContextMenuService), __param(5, IMenuService), __param(6, IInstantiationService), __param(7, IStorageService)], DropdownWithDefaultActionViewItem);\n/**\n * Creates action view items for menu actions or submenu actions.\n */\n\nexport function createActionViewItem(instaService, action, options) {\n  if (action instanceof MenuItemAction) {\n    return instaService.createInstance(MenuEntryActionViewItem, action, undefined);\n  } else if (action instanceof SubmenuItemAction) {\n    if (action.item.rememberDefaultAction) {\n      return instaService.createInstance(DropdownWithDefaultActionViewItem, action, options);\n    } else {\n      return instaService.createInstance(SubmenuEntryActionViewItem, action, options);\n    }\n  } else {\n    return undefined;\n  }\n}","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/platform/actions/browser/menuEntryActionViewItem.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","$","addDisposableListener","append","asCSSUrl","EventType","ModifierKeyEmitter","prepend","StandardKeyboardEvent","ActionViewItem","BaseActionViewItem","DropdownMenuActionViewItem","ActionRunner","Separator","SubmenuAction","UILabelProvider","DisposableStore","MutableDisposable","toDisposable","isLinux","isWindows","OS","localize","IMenuService","MenuItemAction","SubmenuItemAction","IContextKeyService","IContextMenuService","IInstantiationService","IKeybindingService","INotificationService","IStorageService","ThemeIcon","createAndFillInActionBarActions","menu","options","primaryGroup","primaryMaxCount","shouldInlineSubmenu","useSeparatorsInPrimaryActions","groups","getActions","isPrimaryAction","actionGroup","fillInActions","asDisposable","disposables","actions","action","add","useAlternativeActions","Number","MAX_SAFE_INTEGER","primaryBucket","secondaryBucket","Array","isArray","primary","secondary","submenuInfo","Set","group","push","alt","newLen","index","submenuActions","splice","overflow","unshift","MenuEntryActionViewItem","constructor","_action","_keybindingService","_notificationService","_contextKeyService","undefined","icon","class","item","label","draggable","_wantsAltCommand","_itemClassDispose","_register","_altKey","getInstance","_menuItemAction","_commandAction","onClick","event","preventDefault","stopPropagation","actionRunner","run","_context","err","error","render","container","classList","_updateItemClass","mouseOver","alternativeKeyDown","keyStatus","altKey","shiftKey","updateAltState","wantsAltCommand","updateLabel","updateTooltip","updateClass","_","textContent","keybinding","lookupKeybinding","id","keybindingLabel","getLabel","tooltip","title","altTooltip","altKeybinding","altKeybindingLabel","altTitleSection","modifierLabels","_a","element","checked","toggled","isThemeIcon","iconClasses","asClassNameArray","remove","light","style","setProperty","dark","removeProperty","SubmenuEntryActionViewItem","contextMenuService","_b","dropdownOptions","assign","create","menuAsChild","classNames","asClassName","DropdownWithDefaultActionViewItem","submenuAction","_contextMenuService","_menuService","_instaService","_storageService","_c","_container","_storageKey","submenu","_debugName","defaultAction","defaultActionId","get","find","a","_defaultAction","createInstance","_dropdown","onDidRun","update","lastAction","store","dispose","runAction","context","setActionContext","newContext","primaryContainer","KEY_DOWN","equals","tabIndex","focus","dropdownContainer","setFocusable","fromRight","blur","focusable","createActionViewItem","instaService","rememberDefaultAction"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { $, addDisposableListener, append, asCSSUrl, EventType, ModifierKeyEmitter, prepend } from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from '../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { DropdownMenuActionViewItem } from '../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\nimport { ActionRunner, Separator, SubmenuAction } from '../../../base/common/actions.js';\nimport { UILabelProvider } from '../../../base/common/keybindingLabels.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { isLinux, isWindows, OS } from '../../../base/common/platform.js';\nimport './menuEntryActionViewItem.css';\nimport { localize } from '../../../nls.js';\nimport { IMenuService, MenuItemAction, SubmenuItemAction } from '../common/actions.js';\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { INotificationService } from '../../notification/common/notification.js';\nimport { IStorageService } from '../../storage/common/storage.js';\nimport { ThemeIcon } from '../../theme/common/themeService.js';\nexport function createAndFillInActionBarActions(menu, options, target, primaryGroup, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions) {\n    const groups = menu.getActions(options);\n    const isPrimaryAction = typeof primaryGroup === 'string' ? (actionGroup) => actionGroup === primaryGroup : primaryGroup;\n    // Action bars handle alternative actions on their own so the alternative actions should be ignored\n    fillInActions(groups, target, false, isPrimaryAction, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions);\n    return asDisposable(groups);\n}\nfunction asDisposable(groups) {\n    const disposables = new DisposableStore();\n    for (const [, actions] of groups) {\n        for (const action of actions) {\n            disposables.add(action);\n        }\n    }\n    return disposables;\n}\nfunction fillInActions(groups, target, useAlternativeActions, isPrimaryAction = actionGroup => actionGroup === 'navigation', primaryMaxCount = Number.MAX_SAFE_INTEGER, shouldInlineSubmenu = () => false, useSeparatorsInPrimaryActions = false) {\n    let primaryBucket;\n    let secondaryBucket;\n    if (Array.isArray(target)) {\n        primaryBucket = target;\n        secondaryBucket = target;\n    }\n    else {\n        primaryBucket = target.primary;\n        secondaryBucket = target.secondary;\n    }\n    const submenuInfo = new Set();\n    for (const [group, actions] of groups) {\n        let target;\n        if (isPrimaryAction(group)) {\n            target = primaryBucket;\n            if (target.length > 0 && useSeparatorsInPrimaryActions) {\n                target.push(new Separator());\n            }\n        }\n        else {\n            target = secondaryBucket;\n            if (target.length > 0) {\n                target.push(new Separator());\n            }\n        }\n        for (let action of actions) {\n            if (useAlternativeActions) {\n                action = action instanceof MenuItemAction && action.alt ? action.alt : action;\n            }\n            const newLen = target.push(action);\n            // keep submenu info for later inlining\n            if (action instanceof SubmenuAction) {\n                submenuInfo.add({ group, action, index: newLen - 1 });\n            }\n        }\n    }\n    // ask the outside if submenu should be inlined or not. only ask when\n    // there would be enough space\n    for (const { group, action, index } of submenuInfo) {\n        const target = isPrimaryAction(group) ? primaryBucket : secondaryBucket;\n        // inlining submenus with length 0 or 1 is easy,\n        // larger submenus need to be checked with the overall limit\n        const submenuActions = action.actions;\n        if ((submenuActions.length <= 1 || target.length + submenuActions.length - 2 <= primaryMaxCount) && shouldInlineSubmenu(action, group, target.length)) {\n            target.splice(index, 1, ...submenuActions);\n        }\n    }\n    // overflow items from the primary group into the secondary bucket\n    if (primaryBucket !== secondaryBucket && primaryBucket.length > primaryMaxCount) {\n        const overflow = primaryBucket.splice(primaryMaxCount, primaryBucket.length - primaryMaxCount);\n        secondaryBucket.unshift(...overflow, new Separator());\n    }\n}\nlet MenuEntryActionViewItem = class MenuEntryActionViewItem extends ActionViewItem {\n    constructor(_action, options, _keybindingService, _notificationService, _contextKeyService) {\n        super(undefined, _action, { icon: !!(_action.class || _action.item.icon), label: !_action.class && !_action.item.icon, draggable: options === null || options === void 0 ? void 0 : options.draggable });\n        this._keybindingService = _keybindingService;\n        this._notificationService = _notificationService;\n        this._contextKeyService = _contextKeyService;\n        this._wantsAltCommand = false;\n        this._itemClassDispose = this._register(new MutableDisposable());\n        this._altKey = ModifierKeyEmitter.getInstance();\n    }\n    get _menuItemAction() {\n        return this._action;\n    }\n    get _commandAction() {\n        return this._wantsAltCommand && this._menuItemAction.alt || this._menuItemAction;\n    }\n    onClick(event) {\n        return __awaiter(this, void 0, void 0, function* () {\n            event.preventDefault();\n            event.stopPropagation();\n            try {\n                yield this.actionRunner.run(this._commandAction, this._context);\n            }\n            catch (err) {\n                this._notificationService.error(err);\n            }\n        });\n    }\n    render(container) {\n        super.render(container);\n        container.classList.add('menu-entry');\n        this._updateItemClass(this._menuItemAction.item);\n        let mouseOver = false;\n        let alternativeKeyDown = this._altKey.keyStatus.altKey || ((isWindows || isLinux) && this._altKey.keyStatus.shiftKey);\n        const updateAltState = () => {\n            const wantsAltCommand = mouseOver && alternativeKeyDown;\n            if (wantsAltCommand !== this._wantsAltCommand) {\n                this._wantsAltCommand = wantsAltCommand;\n                this.updateLabel();\n                this.updateTooltip();\n                this.updateClass();\n            }\n        };\n        if (this._menuItemAction.alt) {\n            this._register(this._altKey.event(value => {\n                alternativeKeyDown = value.altKey || ((isWindows || isLinux) && value.shiftKey);\n                updateAltState();\n            }));\n        }\n        this._register(addDisposableListener(container, 'mouseleave', _ => {\n            mouseOver = false;\n            updateAltState();\n        }));\n        this._register(addDisposableListener(container, 'mouseenter', _ => {\n            mouseOver = true;\n            updateAltState();\n        }));\n    }\n    updateLabel() {\n        if (this.options.label && this.label) {\n            this.label.textContent = this._commandAction.label;\n        }\n    }\n    updateTooltip() {\n        if (this.label) {\n            const keybinding = this._keybindingService.lookupKeybinding(this._commandAction.id, this._contextKeyService);\n            const keybindingLabel = keybinding && keybinding.getLabel();\n            const tooltip = this._commandAction.tooltip || this._commandAction.label;\n            let title = keybindingLabel\n                ? localize('titleAndKb', \"{0} ({1})\", tooltip, keybindingLabel)\n                : tooltip;\n            if (!this._wantsAltCommand && this._menuItemAction.alt) {\n                const altTooltip = this._menuItemAction.alt.tooltip || this._menuItemAction.alt.label;\n                const altKeybinding = this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id, this._contextKeyService);\n                const altKeybindingLabel = altKeybinding && altKeybinding.getLabel();\n                const altTitleSection = altKeybindingLabel\n                    ? localize('titleAndKb', \"{0} ({1})\", altTooltip, altKeybindingLabel)\n                    : altTooltip;\n                title += `\\n[${UILabelProvider.modifierLabels[OS].altKey}] ${altTitleSection}`;\n            }\n            this.label.title = title;\n        }\n    }\n    updateClass() {\n        if (this.options.icon) {\n            if (this._commandAction !== this._menuItemAction) {\n                if (this._menuItemAction.alt) {\n                    this._updateItemClass(this._menuItemAction.alt.item);\n                }\n            }\n            else if (this._menuItemAction.alt) {\n                this._updateItemClass(this._menuItemAction.item);\n            }\n        }\n    }\n    _updateItemClass(item) {\n        var _a;\n        this._itemClassDispose.value = undefined;\n        const { element, label } = this;\n        if (!element || !label) {\n            return;\n        }\n        const icon = this._commandAction.checked && ((_a = item.toggled) === null || _a === void 0 ? void 0 : _a.icon) ? item.toggled.icon : item.icon;\n        if (!icon) {\n            return;\n        }\n        if (ThemeIcon.isThemeIcon(icon)) {\n            // theme icons\n            const iconClasses = ThemeIcon.asClassNameArray(icon);\n            label.classList.add(...iconClasses);\n            this._itemClassDispose.value = toDisposable(() => {\n                label.classList.remove(...iconClasses);\n            });\n        }\n        else {\n            // icon path/url\n            if (icon.light) {\n                label.style.setProperty('--menu-entry-icon-light', asCSSUrl(icon.light));\n            }\n            if (icon.dark) {\n                label.style.setProperty('--menu-entry-icon-dark', asCSSUrl(icon.dark));\n            }\n            label.classList.add('icon');\n            this._itemClassDispose.value = toDisposable(() => {\n                label.classList.remove('icon');\n                label.style.removeProperty('--menu-entry-icon-light');\n                label.style.removeProperty('--menu-entry-icon-dark');\n            });\n        }\n    }\n};\nMenuEntryActionViewItem = __decorate([\n    __param(2, IKeybindingService),\n    __param(3, INotificationService),\n    __param(4, IContextKeyService)\n], MenuEntryActionViewItem);\nexport { MenuEntryActionViewItem };\nlet SubmenuEntryActionViewItem = class SubmenuEntryActionViewItem extends DropdownMenuActionViewItem {\n    constructor(action, options, contextMenuService) {\n        var _a, _b;\n        const dropdownOptions = Object.assign({}, options !== null && options !== void 0 ? options : Object.create(null), {\n            menuAsChild: (_a = options === null || options === void 0 ? void 0 : options.menuAsChild) !== null && _a !== void 0 ? _a : false,\n            classNames: (_b = options === null || options === void 0 ? void 0 : options.classNames) !== null && _b !== void 0 ? _b : (ThemeIcon.isThemeIcon(action.item.icon) ? ThemeIcon.asClassName(action.item.icon) : undefined),\n        });\n        super(action, { getActions: () => action.actions }, contextMenuService, dropdownOptions);\n    }\n    render(container) {\n        super.render(container);\n        if (this.element) {\n            container.classList.add('menu-entry');\n            const { icon } = this._action.item;\n            if (icon && !ThemeIcon.isThemeIcon(icon)) {\n                this.element.classList.add('icon');\n                if (icon.light) {\n                    this.element.style.setProperty('--menu-entry-icon-light', asCSSUrl(icon.light));\n                }\n                if (icon.dark) {\n                    this.element.style.setProperty('--menu-entry-icon-dark', asCSSUrl(icon.dark));\n                }\n            }\n        }\n    }\n};\nSubmenuEntryActionViewItem = __decorate([\n    __param(2, IContextMenuService)\n], SubmenuEntryActionViewItem);\nexport { SubmenuEntryActionViewItem };\nlet DropdownWithDefaultActionViewItem = class DropdownWithDefaultActionViewItem extends BaseActionViewItem {\n    constructor(submenuAction, options, _keybindingService, _notificationService, _contextMenuService, _menuService, _instaService, _storageService) {\n        var _a, _b, _c;\n        super(null, submenuAction);\n        this._keybindingService = _keybindingService;\n        this._notificationService = _notificationService;\n        this._contextMenuService = _contextMenuService;\n        this._menuService = _menuService;\n        this._instaService = _instaService;\n        this._storageService = _storageService;\n        this._container = null;\n        this._storageKey = `${submenuAction.item.submenu._debugName}_lastActionId`;\n        // determine default action\n        let defaultAction;\n        let defaultActionId = _storageService.get(this._storageKey, 1 /* WORKSPACE */);\n        if (defaultActionId) {\n            defaultAction = submenuAction.actions.find(a => defaultActionId === a.id);\n        }\n        if (!defaultAction) {\n            defaultAction = submenuAction.actions[0];\n        }\n        this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, defaultAction, undefined);\n        const dropdownOptions = Object.assign({}, options !== null && options !== void 0 ? options : Object.create(null), {\n            menuAsChild: (_a = options === null || options === void 0 ? void 0 : options.menuAsChild) !== null && _a !== void 0 ? _a : true,\n            classNames: (_b = options === null || options === void 0 ? void 0 : options.classNames) !== null && _b !== void 0 ? _b : ['codicon', 'codicon-chevron-down'],\n            actionRunner: (_c = options === null || options === void 0 ? void 0 : options.actionRunner) !== null && _c !== void 0 ? _c : new ActionRunner()\n        });\n        this._dropdown = new DropdownMenuActionViewItem(submenuAction, submenuAction.actions, this._contextMenuService, dropdownOptions);\n        this._dropdown.actionRunner.onDidRun((e) => {\n            if (e.action instanceof MenuItemAction) {\n                this.update(e.action);\n            }\n        });\n    }\n    update(lastAction) {\n        this._storageService.store(this._storageKey, lastAction.id, 1 /* WORKSPACE */, 0 /* USER */);\n        this._defaultAction.dispose();\n        this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, lastAction, undefined);\n        this._defaultAction.actionRunner = new class extends ActionRunner {\n            runAction(action, context) {\n                return __awaiter(this, void 0, void 0, function* () {\n                    yield action.run(undefined);\n                });\n            }\n        }();\n        if (this._container) {\n            this._defaultAction.render(prepend(this._container, $('.action-container')));\n        }\n    }\n    setActionContext(newContext) {\n        super.setActionContext(newContext);\n        this._defaultAction.setActionContext(newContext);\n        this._dropdown.setActionContext(newContext);\n    }\n    render(container) {\n        this._container = container;\n        super.render(this._container);\n        this._container.classList.add('monaco-dropdown-with-default');\n        const primaryContainer = $('.action-container');\n        this._defaultAction.render(append(this._container, primaryContainer));\n        this._register(addDisposableListener(primaryContainer, EventType.KEY_DOWN, (e) => {\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(17 /* RightArrow */)) {\n                this._defaultAction.element.tabIndex = -1;\n                this._dropdown.focus();\n                event.stopPropagation();\n            }\n        }));\n        const dropdownContainer = $('.dropdown-action-container');\n        this._dropdown.render(append(this._container, dropdownContainer));\n        this._register(addDisposableListener(dropdownContainer, EventType.KEY_DOWN, (e) => {\n            var _a;\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(15 /* LeftArrow */)) {\n                this._defaultAction.element.tabIndex = 0;\n                this._dropdown.setFocusable(false);\n                (_a = this._defaultAction.element) === null || _a === void 0 ? void 0 : _a.focus();\n                event.stopPropagation();\n            }\n        }));\n    }\n    focus(fromRight) {\n        if (fromRight) {\n            this._dropdown.focus();\n        }\n        else {\n            this._defaultAction.element.tabIndex = 0;\n            this._defaultAction.element.focus();\n        }\n    }\n    blur() {\n        this._defaultAction.element.tabIndex = -1;\n        this._dropdown.blur();\n        this._container.blur();\n    }\n    setFocusable(focusable) {\n        if (focusable) {\n            this._defaultAction.element.tabIndex = 0;\n        }\n        else {\n            this._defaultAction.element.tabIndex = -1;\n            this._dropdown.setFocusable(false);\n        }\n    }\n    dispose() {\n        this._defaultAction.dispose();\n        this._dropdown.dispose();\n        super.dispose();\n    }\n};\nDropdownWithDefaultActionViewItem = __decorate([\n    __param(2, IKeybindingService),\n    __param(3, INotificationService),\n    __param(4, IContextMenuService),\n    __param(5, IMenuService),\n    __param(6, IInstantiationService),\n    __param(7, IStorageService)\n], DropdownWithDefaultActionViewItem);\n/**\n * Creates action view items for menu actions or submenu actions.\n */\nexport function createActionViewItem(instaService, action, options) {\n    if (action instanceof MenuItemAction) {\n        return instaService.createInstance(MenuEntryActionViewItem, action, undefined);\n    }\n    else if (action instanceof SubmenuItemAction) {\n        if (action.item.rememberDefaultAction) {\n            return instaService.createInstance(DropdownWithDefaultActionViewItem, action, options);\n        }\n        else {\n            return instaService.createInstance(SubmenuEntryActionViewItem, action, options);\n        }\n    }\n    else {\n        return undefined;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}