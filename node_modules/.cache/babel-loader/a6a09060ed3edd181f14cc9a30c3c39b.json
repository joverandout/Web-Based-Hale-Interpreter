{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport './messageController.css';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet MessageController = class MessageController {\n  constructor(editor, contextKeyService) {\n    this._messageWidget = new MutableDisposable();\n    this._messageListeners = new DisposableStore();\n    this._editor = editor;\n    this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\n    this._editorListener = this._editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit());\n  }\n\n  static get(editor) {\n    return editor.getContribution(MessageController.ID);\n  }\n\n  dispose() {\n    this._editorListener.dispose();\n\n    this._messageListeners.dispose();\n\n    this._messageWidget.dispose();\n\n    this._visible.reset();\n  }\n\n  showMessage(message, position) {\n    alert(message);\n\n    this._visible.set(true);\n\n    this._messageWidget.clear();\n\n    this._messageListeners.clear();\n\n    this._messageWidget.value = new MessageWidget(this._editor, position, message); // close on blur, cursor, model change, dispose\n\n    this._messageListeners.add(this._editor.onDidBlurEditorText(() => this.closeMessage()));\n\n    this._messageListeners.add(this._editor.onDidChangeCursorPosition(() => this.closeMessage()));\n\n    this._messageListeners.add(this._editor.onDidDispose(() => this.closeMessage()));\n\n    this._messageListeners.add(this._editor.onDidChangeModel(() => this.closeMessage())); // 3sec\n\n\n    this._messageListeners.add(new TimeoutTimer(() => this.closeMessage(), 3000)); // close on mouse move\n\n\n    let bounds;\n\n    this._messageListeners.add(this._editor.onMouseMove(e => {\n      // outside the text area\n      if (!e.target.position) {\n        return;\n      }\n\n      if (!bounds) {\n        // define bounding box around position and first mouse occurance\n        bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\n      } else if (!bounds.containsPosition(e.target.position)) {\n        // check if position is still in bounds\n        this.closeMessage();\n      }\n    }));\n  }\n\n  closeMessage() {\n    this._visible.reset();\n\n    this._messageListeners.clear();\n\n    if (this._messageWidget.value) {\n      this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\n    }\n  }\n\n  _onDidAttemptReadOnlyEdit() {\n    if (this._editor.hasModel()) {\n      this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\n    }\n  }\n\n};\nMessageController.ID = 'editor.contrib.messageController';\nMessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false, nls.localize('messageVisible', 'Whether the editor is currently showing an inline message'));\nMessageController = __decorate([__param(1, IContextKeyService)], MessageController);\nexport { MessageController };\nconst MessageCommand = EditorCommand.bindToContribution(MessageController.get);\nregisterEditorCommand(new MessageCommand({\n  id: 'leaveEditorMessage',\n  precondition: MessageController.MESSAGE_VISIBLE,\n  handler: c => c.closeMessage(),\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 30,\n    primary: 9\n    /* Escape */\n\n  }\n}));\n\nclass MessageWidget {\n  constructor(editor, {\n    lineNumber,\n    column\n  }, text) {\n    // Editor.IContentWidget.allowEditorOverflow\n    this.allowEditorOverflow = true;\n    this.suppressMouseDown = false;\n    this._editor = editor;\n\n    this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0\n    /* Smooth */\n    );\n\n    this._position = {\n      lineNumber,\n      column: column - 1\n    };\n    this._domNode = document.createElement('div');\n\n    this._domNode.classList.add('monaco-editor-overlaymessage');\n\n    const anchorTop = document.createElement('div');\n    anchorTop.classList.add('anchor', 'top');\n\n    this._domNode.appendChild(anchorTop);\n\n    const message = document.createElement('div');\n    message.classList.add('message');\n    message.textContent = text;\n\n    this._domNode.appendChild(message);\n\n    const anchorBottom = document.createElement('div');\n    anchorBottom.classList.add('anchor', 'below');\n\n    this._domNode.appendChild(anchorBottom);\n\n    this._editor.addContentWidget(this);\n\n    this._domNode.classList.add('fadeIn');\n  }\n\n  static fadeOut(messageWidget) {\n    let handle;\n\n    const dispose = () => {\n      messageWidget.dispose();\n      clearTimeout(handle);\n      messageWidget.getDomNode().removeEventListener('animationend', dispose);\n    };\n\n    handle = setTimeout(dispose, 110);\n    messageWidget.getDomNode().addEventListener('animationend', dispose);\n    messageWidget.getDomNode().classList.add('fadeOut');\n    return {\n      dispose\n    };\n  }\n\n  dispose() {\n    this._editor.removeContentWidget(this);\n  }\n\n  getId() {\n    return 'messageoverlay';\n  }\n\n  getDomNode() {\n    return this._domNode;\n  }\n\n  getPosition() {\n    return {\n      position: this._position,\n      preference: [1\n      /* ABOVE */\n      , 2\n      /* BELOW */\n      ]\n    };\n  }\n\n  afterRender(position) {\n    this._domNode.classList.toggle('below', position === 2\n    /* BELOW */\n    );\n  }\n\n}\n\nregisterEditorContribution(MessageController.ID, MessageController);","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/message/browser/messageController.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","alert","TimeoutTimer","DisposableStore","MutableDisposable","EditorCommand","registerEditorCommand","registerEditorContribution","Range","nls","IContextKeyService","RawContextKey","MessageController","constructor","editor","contextKeyService","_messageWidget","_messageListeners","_editor","_visible","MESSAGE_VISIBLE","bindTo","_editorListener","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","get","getContribution","ID","dispose","reset","showMessage","message","position","set","clear","value","MessageWidget","add","onDidBlurEditorText","closeMessage","onDidChangeCursorPosition","onDidDispose","onDidChangeModel","bounds","onMouseMove","e","lineNumber","containsPosition","fadeOut","hasModel","localize","getPosition","MessageCommand","bindToContribution","id","precondition","handler","kbOpts","weight","primary","column","text","allowEditorOverflow","suppressMouseDown","revealLinesInCenterIfOutsideViewport","_position","_domNode","document","createElement","classList","anchorTop","appendChild","textContent","anchorBottom","addContentWidget","messageWidget","handle","clearTimeout","getDomNode","removeEventListener","setTimeout","addEventListener","removeContentWidget","getId","preference","afterRender","toggle"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport './messageController.css';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet MessageController = class MessageController {\n    constructor(editor, contextKeyService) {\n        this._messageWidget = new MutableDisposable();\n        this._messageListeners = new DisposableStore();\n        this._editor = editor;\n        this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\n        this._editorListener = this._editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit());\n    }\n    static get(editor) {\n        return editor.getContribution(MessageController.ID);\n    }\n    dispose() {\n        this._editorListener.dispose();\n        this._messageListeners.dispose();\n        this._messageWidget.dispose();\n        this._visible.reset();\n    }\n    showMessage(message, position) {\n        alert(message);\n        this._visible.set(true);\n        this._messageWidget.clear();\n        this._messageListeners.clear();\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\n        // close on blur, cursor, model change, dispose\n        this._messageListeners.add(this._editor.onDidBlurEditorText(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidDispose(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidChangeModel(() => this.closeMessage()));\n        // 3sec\n        this._messageListeners.add(new TimeoutTimer(() => this.closeMessage(), 3000));\n        // close on mouse move\n        let bounds;\n        this._messageListeners.add(this._editor.onMouseMove(e => {\n            // outside the text area\n            if (!e.target.position) {\n                return;\n            }\n            if (!bounds) {\n                // define bounding box around position and first mouse occurance\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\n            }\n            else if (!bounds.containsPosition(e.target.position)) {\n                // check if position is still in bounds\n                this.closeMessage();\n            }\n        }));\n    }\n    closeMessage() {\n        this._visible.reset();\n        this._messageListeners.clear();\n        if (this._messageWidget.value) {\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\n        }\n    }\n    _onDidAttemptReadOnlyEdit() {\n        if (this._editor.hasModel()) {\n            this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\n        }\n    }\n};\nMessageController.ID = 'editor.contrib.messageController';\nMessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false, nls.localize('messageVisible', 'Whether the editor is currently showing an inline message'));\nMessageController = __decorate([\n    __param(1, IContextKeyService)\n], MessageController);\nexport { MessageController };\nconst MessageCommand = EditorCommand.bindToContribution(MessageController.get);\nregisterEditorCommand(new MessageCommand({\n    id: 'leaveEditorMessage',\n    precondition: MessageController.MESSAGE_VISIBLE,\n    handler: c => c.closeMessage(),\n    kbOpts: {\n        weight: 100 /* EditorContrib */ + 30,\n        primary: 9 /* Escape */\n    }\n}));\nclass MessageWidget {\n    constructor(editor, { lineNumber, column }, text) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._editor = editor;\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* Smooth */);\n        this._position = { lineNumber, column: column - 1 };\n        this._domNode = document.createElement('div');\n        this._domNode.classList.add('monaco-editor-overlaymessage');\n        const anchorTop = document.createElement('div');\n        anchorTop.classList.add('anchor', 'top');\n        this._domNode.appendChild(anchorTop);\n        const message = document.createElement('div');\n        message.classList.add('message');\n        message.textContent = text;\n        this._domNode.appendChild(message);\n        const anchorBottom = document.createElement('div');\n        anchorBottom.classList.add('anchor', 'below');\n        this._domNode.appendChild(anchorBottom);\n        this._editor.addContentWidget(this);\n        this._domNode.classList.add('fadeIn');\n    }\n    static fadeOut(messageWidget) {\n        let handle;\n        const dispose = () => {\n            messageWidget.dispose();\n            clearTimeout(handle);\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\n        };\n        handle = setTimeout(dispose, 110);\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\n        messageWidget.getDomNode().classList.add('fadeOut');\n        return { dispose };\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return 'messageoverlay';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return { position: this._position, preference: [1 /* ABOVE */, 2 /* BELOW */] };\n    }\n    afterRender(position) {\n        this._domNode.classList.toggle('below', position === 2 /* BELOW */);\n    }\n}\nregisterEditorContribution(MessageController.ID, MessageController);\n"]},"metadata":{},"sourceType":"module"}