{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { OverviewRulerLane, MinimapPosition } from '../model.js';\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\nimport { overviewRulerWarning, overviewRulerInfo, overviewRulerError } from '../core/editorColorRegistry.js';\nimport { IModelService } from './model.js';\nimport { Range } from '../core/range.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { minimapWarning, minimapError } from '../../../platform/theme/common/colorRegistry.js';\nimport { ResourceMap } from '../../../base/common/map.js';\n\nclass MarkerDecorations extends Disposable {\n  constructor(model) {\n    super();\n    this.model = model;\n    this._markersData = new Map();\n\n    this._register(toDisposable(() => {\n      this.model.deltaDecorations([...this._markersData.keys()], []);\n\n      this._markersData.clear();\n    }));\n  }\n\n  update(markers, newDecorations) {\n    const oldIds = [...this._markersData.keys()];\n\n    this._markersData.clear();\n\n    const ids = this.model.deltaDecorations(oldIds, newDecorations);\n\n    for (let index = 0; index < ids.length; index++) {\n      this._markersData.set(ids[index], markers[index]);\n    }\n\n    return oldIds.length !== 0 || ids.length !== 0;\n  }\n\n  getMarker(decoration) {\n    return this._markersData.get(decoration.id);\n  }\n\n}\n\nlet MarkerDecorationsService = class MarkerDecorationsService extends Disposable {\n  constructor(modelService, _markerService) {\n    super();\n    this._markerService = _markerService;\n    this._onDidChangeMarker = this._register(new Emitter());\n    this._markerDecorations = new ResourceMap();\n    modelService.getModels().forEach(model => this._onModelAdded(model));\n\n    this._register(modelService.onModelAdded(this._onModelAdded, this));\n\n    this._register(modelService.onModelRemoved(this._onModelRemoved, this));\n\n    this._register(this._markerService.onMarkerChanged(this._handleMarkerChange, this));\n  }\n\n  dispose() {\n    super.dispose();\n\n    this._markerDecorations.forEach(value => value.dispose());\n\n    this._markerDecorations.clear();\n  }\n\n  getMarker(uri, decoration) {\n    const markerDecorations = this._markerDecorations.get(uri);\n\n    return markerDecorations ? markerDecorations.getMarker(decoration) || null : null;\n  }\n\n  _handleMarkerChange(changedResources) {\n    changedResources.forEach(resource => {\n      const markerDecorations = this._markerDecorations.get(resource);\n\n      if (markerDecorations) {\n        this._updateDecorations(markerDecorations);\n      }\n    });\n  }\n\n  _onModelAdded(model) {\n    const markerDecorations = new MarkerDecorations(model);\n\n    this._markerDecorations.set(model.uri, markerDecorations);\n\n    this._updateDecorations(markerDecorations);\n  }\n\n  _onModelRemoved(model) {\n    const markerDecorations = this._markerDecorations.get(model.uri);\n\n    if (markerDecorations) {\n      markerDecorations.dispose();\n\n      this._markerDecorations.delete(model.uri);\n    } // clean up markers for internal, transient models\n\n\n    if (model.uri.scheme === Schemas.inMemory || model.uri.scheme === Schemas.internal || model.uri.scheme === Schemas.vscode) {\n      if (this._markerService) {\n        this._markerService.read({\n          resource: model.uri\n        }).map(marker => marker.owner).forEach(owner => this._markerService.remove(owner, [model.uri]));\n      }\n    }\n  }\n\n  _updateDecorations(markerDecorations) {\n    // Limit to the first 500 errors/warnings\n    const markers = this._markerService.read({\n      resource: markerDecorations.model.uri,\n      take: 500\n    });\n\n    const newModelDecorations = markers.map(marker => {\n      return {\n        range: this._createDecorationRange(markerDecorations.model, marker),\n        options: this._createDecorationOption(marker)\n      };\n    });\n\n    if (markerDecorations.update(markers, newModelDecorations)) {\n      this._onDidChangeMarker.fire(markerDecorations.model);\n    }\n  }\n\n  _createDecorationRange(model, rawMarker) {\n    let ret = Range.lift(rawMarker);\n\n    if (rawMarker.severity === MarkerSeverity.Hint && !this._hasMarkerTag(rawMarker, 1\n    /* Unnecessary */\n    ) && !this._hasMarkerTag(rawMarker, 2\n    /* Deprecated */\n    )) {\n      // * never render hints on multiple lines\n      // * make enough space for three dots\n      ret = ret.setEndPosition(ret.startLineNumber, ret.startColumn + 2);\n    }\n\n    return model.validateRange(ret);\n  }\n\n  _createDecorationOption(marker) {\n    let className;\n    let color = undefined;\n    let zIndex;\n    let inlineClassName = undefined;\n    let minimap;\n\n    switch (marker.severity) {\n      case MarkerSeverity.Hint:\n        if (this._hasMarkerTag(marker, 2\n        /* Deprecated */\n        )) {\n          className = undefined;\n        } else if (this._hasMarkerTag(marker, 1\n        /* Unnecessary */\n        )) {\n          className = \"squiggly-unnecessary\"\n          /* EditorUnnecessaryDecoration */\n          ;\n        } else {\n          className = \"squiggly-hint\"\n          /* EditorHintDecoration */\n          ;\n        }\n\n        zIndex = 0;\n        break;\n\n      case MarkerSeverity.Warning:\n        className = \"squiggly-warning\"\n        /* EditorWarningDecoration */\n        ;\n        color = themeColorFromId(overviewRulerWarning);\n        zIndex = 20;\n        minimap = {\n          color: themeColorFromId(minimapWarning),\n          position: MinimapPosition.Inline\n        };\n        break;\n\n      case MarkerSeverity.Info:\n        className = \"squiggly-info\"\n        /* EditorInfoDecoration */\n        ;\n        color = themeColorFromId(overviewRulerInfo);\n        zIndex = 10;\n        break;\n\n      case MarkerSeverity.Error:\n      default:\n        className = \"squiggly-error\"\n        /* EditorErrorDecoration */\n        ;\n        color = themeColorFromId(overviewRulerError);\n        zIndex = 30;\n        minimap = {\n          color: themeColorFromId(minimapError),\n          position: MinimapPosition.Inline\n        };\n        break;\n    }\n\n    if (marker.tags) {\n      if (marker.tags.indexOf(1\n      /* Unnecessary */\n      ) !== -1) {\n        inlineClassName = \"squiggly-inline-unnecessary\"\n        /* EditorUnnecessaryInlineDecoration */\n        ;\n      }\n\n      if (marker.tags.indexOf(2\n      /* Deprecated */\n      ) !== -1) {\n        inlineClassName = \"squiggly-inline-deprecated\"\n        /* EditorDeprecatedInlineDecoration */\n        ;\n      }\n    }\n\n    return {\n      description: 'marker-decoration',\n      stickiness: 1\n      /* NeverGrowsWhenTypingAtEdges */\n      ,\n      className,\n      showIfCollapsed: true,\n      overviewRuler: {\n        color,\n        position: OverviewRulerLane.Right\n      },\n      minimap,\n      zIndex,\n      inlineClassName\n    };\n  }\n\n  _hasMarkerTag(marker, tag) {\n    if (marker.tags) {\n      return marker.tags.indexOf(tag) >= 0;\n    }\n\n    return false;\n  }\n\n};\nMarkerDecorationsService = __decorate([__param(0, IModelService), __param(1, IMarkerService)], MarkerDecorationsService);\nexport { MarkerDecorationsService };","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","IMarkerService","MarkerSeverity","Disposable","toDisposable","OverviewRulerLane","MinimapPosition","themeColorFromId","overviewRulerWarning","overviewRulerInfo","overviewRulerError","IModelService","Range","Schemas","Emitter","minimapWarning","minimapError","ResourceMap","MarkerDecorations","constructor","model","_markersData","Map","_register","deltaDecorations","keys","clear","update","markers","newDecorations","oldIds","ids","index","set","getMarker","decoration","get","id","MarkerDecorationsService","modelService","_markerService","_onDidChangeMarker","_markerDecorations","getModels","forEach","_onModelAdded","onModelAdded","onModelRemoved","_onModelRemoved","onMarkerChanged","_handleMarkerChange","dispose","value","uri","markerDecorations","changedResources","resource","_updateDecorations","delete","scheme","inMemory","internal","vscode","read","map","marker","owner","remove","take","newModelDecorations","range","_createDecorationRange","options","_createDecorationOption","fire","rawMarker","ret","lift","severity","Hint","_hasMarkerTag","setEndPosition","startLineNumber","startColumn","validateRange","className","color","undefined","zIndex","inlineClassName","minimap","Warning","position","Inline","Info","Error","tags","indexOf","description","stickiness","showIfCollapsed","overviewRuler","Right","tag"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { OverviewRulerLane, MinimapPosition } from '../model.js';\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\nimport { overviewRulerWarning, overviewRulerInfo, overviewRulerError } from '../core/editorColorRegistry.js';\nimport { IModelService } from './model.js';\nimport { Range } from '../core/range.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { minimapWarning, minimapError } from '../../../platform/theme/common/colorRegistry.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nclass MarkerDecorations extends Disposable {\n    constructor(model) {\n        super();\n        this.model = model;\n        this._markersData = new Map();\n        this._register(toDisposable(() => {\n            this.model.deltaDecorations([...this._markersData.keys()], []);\n            this._markersData.clear();\n        }));\n    }\n    update(markers, newDecorations) {\n        const oldIds = [...this._markersData.keys()];\n        this._markersData.clear();\n        const ids = this.model.deltaDecorations(oldIds, newDecorations);\n        for (let index = 0; index < ids.length; index++) {\n            this._markersData.set(ids[index], markers[index]);\n        }\n        return oldIds.length !== 0 || ids.length !== 0;\n    }\n    getMarker(decoration) {\n        return this._markersData.get(decoration.id);\n    }\n}\nlet MarkerDecorationsService = class MarkerDecorationsService extends Disposable {\n    constructor(modelService, _markerService) {\n        super();\n        this._markerService = _markerService;\n        this._onDidChangeMarker = this._register(new Emitter());\n        this._markerDecorations = new ResourceMap();\n        modelService.getModels().forEach(model => this._onModelAdded(model));\n        this._register(modelService.onModelAdded(this._onModelAdded, this));\n        this._register(modelService.onModelRemoved(this._onModelRemoved, this));\n        this._register(this._markerService.onMarkerChanged(this._handleMarkerChange, this));\n    }\n    dispose() {\n        super.dispose();\n        this._markerDecorations.forEach(value => value.dispose());\n        this._markerDecorations.clear();\n    }\n    getMarker(uri, decoration) {\n        const markerDecorations = this._markerDecorations.get(uri);\n        return markerDecorations ? (markerDecorations.getMarker(decoration) || null) : null;\n    }\n    _handleMarkerChange(changedResources) {\n        changedResources.forEach((resource) => {\n            const markerDecorations = this._markerDecorations.get(resource);\n            if (markerDecorations) {\n                this._updateDecorations(markerDecorations);\n            }\n        });\n    }\n    _onModelAdded(model) {\n        const markerDecorations = new MarkerDecorations(model);\n        this._markerDecorations.set(model.uri, markerDecorations);\n        this._updateDecorations(markerDecorations);\n    }\n    _onModelRemoved(model) {\n        const markerDecorations = this._markerDecorations.get(model.uri);\n        if (markerDecorations) {\n            markerDecorations.dispose();\n            this._markerDecorations.delete(model.uri);\n        }\n        // clean up markers for internal, transient models\n        if (model.uri.scheme === Schemas.inMemory\n            || model.uri.scheme === Schemas.internal\n            || model.uri.scheme === Schemas.vscode) {\n            if (this._markerService) {\n                this._markerService.read({ resource: model.uri }).map(marker => marker.owner).forEach(owner => this._markerService.remove(owner, [model.uri]));\n            }\n        }\n    }\n    _updateDecorations(markerDecorations) {\n        // Limit to the first 500 errors/warnings\n        const markers = this._markerService.read({ resource: markerDecorations.model.uri, take: 500 });\n        const newModelDecorations = markers.map((marker) => {\n            return {\n                range: this._createDecorationRange(markerDecorations.model, marker),\n                options: this._createDecorationOption(marker)\n            };\n        });\n        if (markerDecorations.update(markers, newModelDecorations)) {\n            this._onDidChangeMarker.fire(markerDecorations.model);\n        }\n    }\n    _createDecorationRange(model, rawMarker) {\n        let ret = Range.lift(rawMarker);\n        if (rawMarker.severity === MarkerSeverity.Hint && !this._hasMarkerTag(rawMarker, 1 /* Unnecessary */) && !this._hasMarkerTag(rawMarker, 2 /* Deprecated */)) {\n            // * never render hints on multiple lines\n            // * make enough space for three dots\n            ret = ret.setEndPosition(ret.startLineNumber, ret.startColumn + 2);\n        }\n        return model.validateRange(ret);\n    }\n    _createDecorationOption(marker) {\n        let className;\n        let color = undefined;\n        let zIndex;\n        let inlineClassName = undefined;\n        let minimap;\n        switch (marker.severity) {\n            case MarkerSeverity.Hint:\n                if (this._hasMarkerTag(marker, 2 /* Deprecated */)) {\n                    className = undefined;\n                }\n                else if (this._hasMarkerTag(marker, 1 /* Unnecessary */)) {\n                    className = \"squiggly-unnecessary\" /* EditorUnnecessaryDecoration */;\n                }\n                else {\n                    className = \"squiggly-hint\" /* EditorHintDecoration */;\n                }\n                zIndex = 0;\n                break;\n            case MarkerSeverity.Warning:\n                className = \"squiggly-warning\" /* EditorWarningDecoration */;\n                color = themeColorFromId(overviewRulerWarning);\n                zIndex = 20;\n                minimap = {\n                    color: themeColorFromId(minimapWarning),\n                    position: MinimapPosition.Inline\n                };\n                break;\n            case MarkerSeverity.Info:\n                className = \"squiggly-info\" /* EditorInfoDecoration */;\n                color = themeColorFromId(overviewRulerInfo);\n                zIndex = 10;\n                break;\n            case MarkerSeverity.Error:\n            default:\n                className = \"squiggly-error\" /* EditorErrorDecoration */;\n                color = themeColorFromId(overviewRulerError);\n                zIndex = 30;\n                minimap = {\n                    color: themeColorFromId(minimapError),\n                    position: MinimapPosition.Inline\n                };\n                break;\n        }\n        if (marker.tags) {\n            if (marker.tags.indexOf(1 /* Unnecessary */) !== -1) {\n                inlineClassName = \"squiggly-inline-unnecessary\" /* EditorUnnecessaryInlineDecoration */;\n            }\n            if (marker.tags.indexOf(2 /* Deprecated */) !== -1) {\n                inlineClassName = \"squiggly-inline-deprecated\" /* EditorDeprecatedInlineDecoration */;\n            }\n        }\n        return {\n            description: 'marker-decoration',\n            stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\n            className,\n            showIfCollapsed: true,\n            overviewRuler: {\n                color,\n                position: OverviewRulerLane.Right\n            },\n            minimap,\n            zIndex,\n            inlineClassName,\n        };\n    }\n    _hasMarkerTag(marker, tag) {\n        if (marker.tags) {\n            return marker.tags.indexOf(tag) >= 0;\n        }\n        return false;\n    }\n};\nMarkerDecorationsService = __decorate([\n    __param(0, IModelService),\n    __param(1, IMarkerService)\n], MarkerDecorationsService);\nexport { MarkerDecorationsService };\n"]},"metadata":{},"sourceType":"module"}