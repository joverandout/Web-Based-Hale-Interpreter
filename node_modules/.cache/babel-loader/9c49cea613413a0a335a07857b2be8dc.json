{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nimport { ActionRunner } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, dispose } from '../../../common/lifecycle.js';\nimport * as types from '../../../common/types.js';\nimport './actionbar.css';\nexport class ActionBar extends Disposable {\n  constructor(container, options = {}) {\n    var _a, _b, _c, _d, _e, _f;\n\n    super(); // Trigger Key Tracking\n\n    this.triggerKeyDown = false;\n    this.focusable = true;\n    this._onDidBlur = this._register(new Emitter());\n    this.onDidBlur = this._onDidBlur.event;\n    this._onDidCancel = this._register(new Emitter({\n      onFirstListenerAdd: () => this.cancelHasListener = true\n    }));\n    this.onDidCancel = this._onDidCancel.event;\n    this.cancelHasListener = false;\n    this._onDidRun = this._register(new Emitter());\n    this.onDidRun = this._onDidRun.event;\n    this._onBeforeRun = this._register(new Emitter());\n    this.onBeforeRun = this._onBeforeRun.event;\n    this.options = options;\n    this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n    this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0\n    /* HORIZONTAL */\n    ;\n    this._triggerKeys = {\n      keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n      keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3\n      /* Enter */\n      , 10\n      /* Space */\n      ]\n    };\n\n    if (this.options.actionRunner) {\n      this._actionRunner = this.options.actionRunner;\n    } else {\n      this._actionRunner = new ActionRunner();\n\n      this._register(this._actionRunner);\n    }\n\n    this._register(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n\n    this._register(this._actionRunner.onBeforeRun(e => this._onBeforeRun.fire(e)));\n\n    this._actionIds = [];\n    this.viewItems = [];\n    this.focusedItem = undefined;\n    this.domNode = document.createElement('div');\n    this.domNode.className = 'monaco-action-bar';\n\n    if (options.animated !== false) {\n      this.domNode.classList.add('animated');\n    }\n\n    let previousKeys;\n    let nextKeys;\n\n    switch (this._orientation) {\n      case 0\n      /* HORIZONTAL */\n      :\n        previousKeys = [15\n        /* LeftArrow */\n        ];\n        nextKeys = [17\n        /* RightArrow */\n        ];\n        break;\n\n      case 1\n      /* VERTICAL */\n      :\n        previousKeys = [16\n        /* UpArrow */\n        ];\n        nextKeys = [18\n        /* DownArrow */\n        ];\n        this.domNode.className += ' vertical';\n        break;\n    }\n\n    this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\n      const event = new StandardKeyboardEvent(e);\n      let eventHandled = true;\n      const focusedItem = typeof this.focusedItem === 'number' ? this.viewItems[this.focusedItem] : undefined;\n\n      if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n        eventHandled = this.focusPrevious();\n      } else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n        eventHandled = this.focusNext();\n      } else if (event.equals(9\n      /* Escape */\n      ) && this.cancelHasListener) {\n        this._onDidCancel.fire();\n      } else if (event.equals(14\n      /* Home */\n      )) {\n        eventHandled = this.focusFirst();\n      } else if (event.equals(13\n      /* End */\n      )) {\n        eventHandled = this.focusLast();\n      } else if (event.equals(2\n      /* Tab */\n      ) && focusedItem instanceof BaseActionViewItem && focusedItem.trapsArrowNavigation) {\n        eventHandled = this.focusNext();\n      } else if (this.isTriggerKeyEvent(event)) {\n        // Staying out of the else branch even if not triggered\n        if (this._triggerKeys.keyDown) {\n          this.doTrigger(event);\n        } else {\n          this.triggerKeyDown = true;\n        }\n      } else {\n        eventHandled = false;\n      }\n\n      if (eventHandled) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }));\n\n    this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\n      const event = new StandardKeyboardEvent(e); // Run action on Enter/Space\n\n      if (this.isTriggerKeyEvent(event)) {\n        if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\n          this.triggerKeyDown = false;\n          this.doTrigger(event);\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n      } // Recompute focused item\n      else if (event.equals(2\n      /* Tab */\n      ) || event.equals(1024\n      /* Shift */\n      | 2\n      /* Tab */\n      )) {\n        this.updateFocusedItem();\n      }\n    }));\n\n    this.focusTracker = this._register(DOM.trackFocus(this.domNode));\n\n    this._register(this.focusTracker.onDidBlur(() => {\n      if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\n        this._onDidBlur.fire();\n\n        this.focusedItem = undefined;\n        this.previouslyFocusedItem = undefined;\n        this.triggerKeyDown = false;\n      }\n    }));\n\n    this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\n\n    this.actionsList = document.createElement('ul');\n    this.actionsList.className = 'actions-container';\n    this.actionsList.setAttribute('role', 'toolbar');\n\n    if (this.options.ariaLabel) {\n      this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\n    }\n\n    this.domNode.appendChild(this.actionsList);\n    container.appendChild(this.domNode);\n  } // Some action bars should not be focusable at times\n  // When an action bar is not focusable make sure to make all the elements inside it not focusable\n  // When an action bar is focusable again, make sure the first item can be focused\n\n\n  setFocusable(focusable) {\n    this.focusable = focusable;\n\n    if (this.focusable) {\n      const firstEnabled = this.viewItems.find(vi => vi instanceof BaseActionViewItem && vi.isEnabled());\n\n      if (firstEnabled instanceof BaseActionViewItem) {\n        firstEnabled.setFocusable(true);\n      }\n    } else {\n      this.viewItems.forEach(vi => {\n        if (vi instanceof BaseActionViewItem) {\n          vi.setFocusable(false);\n        }\n      });\n    }\n  }\n\n  isTriggerKeyEvent(event) {\n    let ret = false;\n\n    this._triggerKeys.keys.forEach(keyCode => {\n      ret = ret || event.equals(keyCode);\n    });\n\n    return ret;\n  }\n\n  updateFocusedItem() {\n    for (let i = 0; i < this.actionsList.children.length; i++) {\n      const elem = this.actionsList.children[i];\n\n      if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n        this.focusedItem = i;\n        break;\n      }\n    }\n  }\n\n  get context() {\n    return this._context;\n  }\n\n  set context(context) {\n    this._context = context;\n    this.viewItems.forEach(i => i.setActionContext(context));\n  }\n\n  get actionRunner() {\n    return this._actionRunner;\n  }\n\n  set actionRunner(actionRunner) {\n    if (actionRunner) {\n      this._actionRunner = actionRunner;\n      this.viewItems.forEach(item => item.actionRunner = actionRunner);\n    }\n  }\n\n  getContainer() {\n    return this.domNode;\n  }\n\n  push(arg, options = {}) {\n    const actions = Array.isArray(arg) ? arg : [arg];\n    let index = types.isNumber(options.index) ? options.index : null;\n    actions.forEach(action => {\n      const actionViewItemElement = document.createElement('li');\n      actionViewItemElement.className = 'action-item';\n      actionViewItemElement.setAttribute('role', 'presentation'); // Prevent native context menu on actions\n\n      if (!this.options.allowContextMenu) {\n        this._register(DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, e => {\n          DOM.EventHelper.stop(e, true);\n        }));\n      }\n\n      let item;\n\n      if (this.options.actionViewItemProvider) {\n        item = this.options.actionViewItemProvider(action);\n      }\n\n      if (!item) {\n        item = new ActionViewItem(this.context, action, options);\n      }\n\n      item.actionRunner = this._actionRunner;\n      item.setActionContext(this.context);\n      item.render(actionViewItemElement);\n\n      if (this.focusable && item instanceof BaseActionViewItem && this.viewItems.length === 0) {\n        // We need to allow for the first enabled item to be focused on using tab navigation #106441\n        item.setFocusable(true);\n      }\n\n      if (index === null || index < 0 || index >= this.actionsList.children.length) {\n        this.actionsList.appendChild(actionViewItemElement);\n        this.viewItems.push(item);\n\n        this._actionIds.push(action.id);\n      } else {\n        this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\n        this.viewItems.splice(index, 0, item);\n\n        this._actionIds.splice(index, 0, action.id);\n\n        index++;\n      }\n    });\n\n    if (typeof this.focusedItem === 'number') {\n      // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n      this.focus(this.focusedItem);\n    }\n  }\n\n  clear() {\n    dispose(this.viewItems);\n    this.viewItems = [];\n    this._actionIds = [];\n    DOM.clearNode(this.actionsList);\n  }\n\n  length() {\n    return this.viewItems.length;\n  }\n\n  focus(arg) {\n    let selectFirst = false;\n    let index = undefined;\n\n    if (arg === undefined) {\n      selectFirst = true;\n    } else if (typeof arg === 'number') {\n      index = arg;\n    } else if (typeof arg === 'boolean') {\n      selectFirst = arg;\n    }\n\n    if (selectFirst && typeof this.focusedItem === 'undefined') {\n      const firstEnabled = this.viewItems.findIndex(item => item.isEnabled()); // Focus the first enabled item\n\n      this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n      this.updateFocus(undefined, undefined, true);\n    } else {\n      if (index !== undefined) {\n        this.focusedItem = index;\n      }\n\n      this.updateFocus(undefined, undefined, true);\n    }\n  }\n\n  focusFirst() {\n    this.focusedItem = this.length() - 1;\n    return this.focusNext(true);\n  }\n\n  focusLast() {\n    this.focusedItem = 0;\n    return this.focusPrevious(true);\n  }\n\n  focusNext(forceLoop) {\n    if (typeof this.focusedItem === 'undefined') {\n      this.focusedItem = this.viewItems.length - 1;\n    } else if (this.viewItems.length <= 1) {\n      return false;\n    }\n\n    const startIndex = this.focusedItem;\n    let item;\n\n    do {\n      if (!forceLoop && this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n        this.focusedItem = startIndex;\n        return false;\n      }\n\n      this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n      item = this.viewItems[this.focusedItem];\n    } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n\n    this.updateFocus();\n    return true;\n  }\n\n  focusPrevious(forceLoop) {\n    if (typeof this.focusedItem === 'undefined') {\n      this.focusedItem = 0;\n    } else if (this.viewItems.length <= 1) {\n      return false;\n    }\n\n    const startIndex = this.focusedItem;\n    let item;\n\n    do {\n      this.focusedItem = this.focusedItem - 1;\n\n      if (this.focusedItem < 0) {\n        if (!forceLoop && this.options.preventLoopNavigation) {\n          this.focusedItem = startIndex;\n          return false;\n        }\n\n        this.focusedItem = this.viewItems.length - 1;\n      }\n\n      item = this.viewItems[this.focusedItem];\n    } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n\n    this.updateFocus(true);\n    return true;\n  }\n\n  updateFocus(fromRight, preventScroll, forceFocus = false) {\n    var _a;\n\n    if (typeof this.focusedItem === 'undefined') {\n      this.actionsList.focus({\n        preventScroll\n      });\n    }\n\n    if (this.previouslyFocusedItem !== undefined && this.previouslyFocusedItem !== this.focusedItem) {\n      (_a = this.viewItems[this.previouslyFocusedItem]) === null || _a === void 0 ? void 0 : _a.blur();\n    }\n\n    const actionViewItem = this.focusedItem !== undefined && this.viewItems[this.focusedItem];\n\n    if (actionViewItem) {\n      let focusItem = true;\n\n      if (!types.isFunction(actionViewItem.focus)) {\n        focusItem = false;\n      }\n\n      if (this.options.focusOnlyEnabledItems && types.isFunction(actionViewItem.isEnabled) && !actionViewItem.isEnabled()) {\n        focusItem = false;\n      }\n\n      if (!focusItem) {\n        this.actionsList.focus({\n          preventScroll\n        });\n        this.previouslyFocusedItem = undefined;\n      } else if (forceFocus || this.previouslyFocusedItem !== this.focusedItem) {\n        actionViewItem.focus(fromRight);\n        this.previouslyFocusedItem = this.focusedItem;\n      }\n    }\n  }\n\n  doTrigger(event) {\n    if (typeof this.focusedItem === 'undefined') {\n      return; //nothing to focus\n    } // trigger action\n\n\n    const actionViewItem = this.viewItems[this.focusedItem];\n\n    if (actionViewItem instanceof BaseActionViewItem) {\n      const context = actionViewItem._context === null || actionViewItem._context === undefined ? event : actionViewItem._context;\n      this.run(actionViewItem._action, context);\n    }\n  }\n\n  run(action, context) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this._actionRunner.run(action, context);\n    });\n  }\n\n  dispose() {\n    dispose(this.viewItems);\n    this.viewItems = [];\n    this._actionIds = [];\n    this.getContainer().remove();\n    super.dispose();\n  }\n\n}","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","DOM","StandardKeyboardEvent","ActionViewItem","BaseActionViewItem","ActionRunner","Emitter","Disposable","dispose","types","ActionBar","constructor","container","options","_a","_b","_c","_d","_e","_f","triggerKeyDown","focusable","_onDidBlur","_register","onDidBlur","event","_onDidCancel","onFirstListenerAdd","cancelHasListener","onDidCancel","_onDidRun","onDidRun","_onBeforeRun","onBeforeRun","_context","context","_orientation","orientation","_triggerKeys","keyDown","triggerKeys","keys","actionRunner","_actionRunner","fire","_actionIds","viewItems","focusedItem","undefined","domNode","document","createElement","className","animated","classList","add","previousKeys","nextKeys","addDisposableListener","EventType","KEY_DOWN","eventHandled","equals","focusPrevious","focusNext","focusFirst","focusLast","trapsArrowNavigation","isTriggerKeyEvent","doTrigger","preventDefault","stopPropagation","KEY_UP","updateFocusedItem","focusTracker","trackFocus","getActiveElement","isAncestor","previouslyFocusedItem","onDidFocus","actionsList","setAttribute","ariaLabel","appendChild","setFocusable","firstEnabled","find","vi","isEnabled","forEach","ret","keyCode","i","children","length","elem","setActionContext","item","getContainer","push","arg","actions","Array","isArray","index","isNumber","action","actionViewItemElement","allowContextMenu","CONTEXT_MENU","EventHelper","stop","actionViewItemProvider","render","id","insertBefore","splice","focus","clear","clearNode","selectFirst","findIndex","updateFocus","forceLoop","startIndex","preventLoopNavigation","focusOnlyEnabledItems","fromRight","preventScroll","forceFocus","blur","actionViewItem","focusItem","isFunction","run","_action","remove"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nimport { ActionRunner } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, dispose } from '../../../common/lifecycle.js';\nimport * as types from '../../../common/types.js';\nimport './actionbar.css';\nexport class ActionBar extends Disposable {\n    constructor(container, options = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        super();\n        // Trigger Key Tracking\n        this.triggerKeyDown = false;\n        this.focusable = true;\n        this._onDidBlur = this._register(new Emitter());\n        this.onDidBlur = this._onDidBlur.event;\n        this._onDidCancel = this._register(new Emitter({ onFirstListenerAdd: () => this.cancelHasListener = true }));\n        this.onDidCancel = this._onDidCancel.event;\n        this.cancelHasListener = false;\n        this._onDidRun = this._register(new Emitter());\n        this.onDidRun = this._onDidRun.event;\n        this._onBeforeRun = this._register(new Emitter());\n        this.onBeforeRun = this._onBeforeRun.event;\n        this.options = options;\n        this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n        this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0 /* HORIZONTAL */;\n        this._triggerKeys = {\n            keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n            keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3 /* Enter */, 10 /* Space */]\n        };\n        if (this.options.actionRunner) {\n            this._actionRunner = this.options.actionRunner;\n        }\n        else {\n            this._actionRunner = new ActionRunner();\n            this._register(this._actionRunner);\n        }\n        this._register(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n        this._register(this._actionRunner.onBeforeRun(e => this._onBeforeRun.fire(e)));\n        this._actionIds = [];\n        this.viewItems = [];\n        this.focusedItem = undefined;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'monaco-action-bar';\n        if (options.animated !== false) {\n            this.domNode.classList.add('animated');\n        }\n        let previousKeys;\n        let nextKeys;\n        switch (this._orientation) {\n            case 0 /* HORIZONTAL */:\n                previousKeys = [15 /* LeftArrow */];\n                nextKeys = [17 /* RightArrow */];\n                break;\n            case 1 /* VERTICAL */:\n                previousKeys = [16 /* UpArrow */];\n                nextKeys = [18 /* DownArrow */];\n                this.domNode.className += ' vertical';\n                break;\n        }\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\n            const event = new StandardKeyboardEvent(e);\n            let eventHandled = true;\n            const focusedItem = typeof this.focusedItem === 'number' ? this.viewItems[this.focusedItem] : undefined;\n            if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n                eventHandled = this.focusPrevious();\n            }\n            else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n                eventHandled = this.focusNext();\n            }\n            else if (event.equals(9 /* Escape */) && this.cancelHasListener) {\n                this._onDidCancel.fire();\n            }\n            else if (event.equals(14 /* Home */)) {\n                eventHandled = this.focusFirst();\n            }\n            else if (event.equals(13 /* End */)) {\n                eventHandled = this.focusLast();\n            }\n            else if (event.equals(2 /* Tab */) && focusedItem instanceof BaseActionViewItem && focusedItem.trapsArrowNavigation) {\n                eventHandled = this.focusNext();\n            }\n            else if (this.isTriggerKeyEvent(event)) {\n                // Staying out of the else branch even if not triggered\n                if (this._triggerKeys.keyDown) {\n                    this.doTrigger(event);\n                }\n                else {\n                    this.triggerKeyDown = true;\n                }\n            }\n            else {\n                eventHandled = false;\n            }\n            if (eventHandled) {\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        }));\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            // Run action on Enter/Space\n            if (this.isTriggerKeyEvent(event)) {\n                if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\n                    this.triggerKeyDown = false;\n                    this.doTrigger(event);\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            // Recompute focused item\n            else if (event.equals(2 /* Tab */) || event.equals(1024 /* Shift */ | 2 /* Tab */)) {\n                this.updateFocusedItem();\n            }\n        }));\n        this.focusTracker = this._register(DOM.trackFocus(this.domNode));\n        this._register(this.focusTracker.onDidBlur(() => {\n            if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\n                this._onDidBlur.fire();\n                this.focusedItem = undefined;\n                this.previouslyFocusedItem = undefined;\n                this.triggerKeyDown = false;\n            }\n        }));\n        this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\n        this.actionsList = document.createElement('ul');\n        this.actionsList.className = 'actions-container';\n        this.actionsList.setAttribute('role', 'toolbar');\n        if (this.options.ariaLabel) {\n            this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\n        }\n        this.domNode.appendChild(this.actionsList);\n        container.appendChild(this.domNode);\n    }\n    // Some action bars should not be focusable at times\n    // When an action bar is not focusable make sure to make all the elements inside it not focusable\n    // When an action bar is focusable again, make sure the first item can be focused\n    setFocusable(focusable) {\n        this.focusable = focusable;\n        if (this.focusable) {\n            const firstEnabled = this.viewItems.find(vi => vi instanceof BaseActionViewItem && vi.isEnabled());\n            if (firstEnabled instanceof BaseActionViewItem) {\n                firstEnabled.setFocusable(true);\n            }\n        }\n        else {\n            this.viewItems.forEach(vi => {\n                if (vi instanceof BaseActionViewItem) {\n                    vi.setFocusable(false);\n                }\n            });\n        }\n    }\n    isTriggerKeyEvent(event) {\n        let ret = false;\n        this._triggerKeys.keys.forEach(keyCode => {\n            ret = ret || event.equals(keyCode);\n        });\n        return ret;\n    }\n    updateFocusedItem() {\n        for (let i = 0; i < this.actionsList.children.length; i++) {\n            const elem = this.actionsList.children[i];\n            if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n                this.focusedItem = i;\n                break;\n            }\n        }\n    }\n    get context() {\n        return this._context;\n    }\n    set context(context) {\n        this._context = context;\n        this.viewItems.forEach(i => i.setActionContext(context));\n    }\n    get actionRunner() {\n        return this._actionRunner;\n    }\n    set actionRunner(actionRunner) {\n        if (actionRunner) {\n            this._actionRunner = actionRunner;\n            this.viewItems.forEach(item => item.actionRunner = actionRunner);\n        }\n    }\n    getContainer() {\n        return this.domNode;\n    }\n    push(arg, options = {}) {\n        const actions = Array.isArray(arg) ? arg : [arg];\n        let index = types.isNumber(options.index) ? options.index : null;\n        actions.forEach((action) => {\n            const actionViewItemElement = document.createElement('li');\n            actionViewItemElement.className = 'action-item';\n            actionViewItemElement.setAttribute('role', 'presentation');\n            // Prevent native context menu on actions\n            if (!this.options.allowContextMenu) {\n                this._register(DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, (e) => {\n                    DOM.EventHelper.stop(e, true);\n                }));\n            }\n            let item;\n            if (this.options.actionViewItemProvider) {\n                item = this.options.actionViewItemProvider(action);\n            }\n            if (!item) {\n                item = new ActionViewItem(this.context, action, options);\n            }\n            item.actionRunner = this._actionRunner;\n            item.setActionContext(this.context);\n            item.render(actionViewItemElement);\n            if (this.focusable && item instanceof BaseActionViewItem && this.viewItems.length === 0) {\n                // We need to allow for the first enabled item to be focused on using tab navigation #106441\n                item.setFocusable(true);\n            }\n            if (index === null || index < 0 || index >= this.actionsList.children.length) {\n                this.actionsList.appendChild(actionViewItemElement);\n                this.viewItems.push(item);\n                this._actionIds.push(action.id);\n            }\n            else {\n                this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\n                this.viewItems.splice(index, 0, item);\n                this._actionIds.splice(index, 0, action.id);\n                index++;\n            }\n        });\n        if (typeof this.focusedItem === 'number') {\n            // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n            this.focus(this.focusedItem);\n        }\n    }\n    clear() {\n        dispose(this.viewItems);\n        this.viewItems = [];\n        this._actionIds = [];\n        DOM.clearNode(this.actionsList);\n    }\n    length() {\n        return this.viewItems.length;\n    }\n    focus(arg) {\n        let selectFirst = false;\n        let index = undefined;\n        if (arg === undefined) {\n            selectFirst = true;\n        }\n        else if (typeof arg === 'number') {\n            index = arg;\n        }\n        else if (typeof arg === 'boolean') {\n            selectFirst = arg;\n        }\n        if (selectFirst && typeof this.focusedItem === 'undefined') {\n            const firstEnabled = this.viewItems.findIndex(item => item.isEnabled());\n            // Focus the first enabled item\n            this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n            this.updateFocus(undefined, undefined, true);\n        }\n        else {\n            if (index !== undefined) {\n                this.focusedItem = index;\n            }\n            this.updateFocus(undefined, undefined, true);\n        }\n    }\n    focusFirst() {\n        this.focusedItem = this.length() - 1;\n        return this.focusNext(true);\n    }\n    focusLast() {\n        this.focusedItem = 0;\n        return this.focusPrevious(true);\n    }\n    focusNext(forceLoop) {\n        if (typeof this.focusedItem === 'undefined') {\n            this.focusedItem = this.viewItems.length - 1;\n        }\n        else if (this.viewItems.length <= 1) {\n            return false;\n        }\n        const startIndex = this.focusedItem;\n        let item;\n        do {\n            if (!forceLoop && this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n                this.focusedItem = startIndex;\n                return false;\n            }\n            this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n            item = this.viewItems[this.focusedItem];\n        } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n        this.updateFocus();\n        return true;\n    }\n    focusPrevious(forceLoop) {\n        if (typeof this.focusedItem === 'undefined') {\n            this.focusedItem = 0;\n        }\n        else if (this.viewItems.length <= 1) {\n            return false;\n        }\n        const startIndex = this.focusedItem;\n        let item;\n        do {\n            this.focusedItem = this.focusedItem - 1;\n            if (this.focusedItem < 0) {\n                if (!forceLoop && this.options.preventLoopNavigation) {\n                    this.focusedItem = startIndex;\n                    return false;\n                }\n                this.focusedItem = this.viewItems.length - 1;\n            }\n            item = this.viewItems[this.focusedItem];\n        } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n        this.updateFocus(true);\n        return true;\n    }\n    updateFocus(fromRight, preventScroll, forceFocus = false) {\n        var _a;\n        if (typeof this.focusedItem === 'undefined') {\n            this.actionsList.focus({ preventScroll });\n        }\n        if (this.previouslyFocusedItem !== undefined && this.previouslyFocusedItem !== this.focusedItem) {\n            (_a = this.viewItems[this.previouslyFocusedItem]) === null || _a === void 0 ? void 0 : _a.blur();\n        }\n        const actionViewItem = this.focusedItem !== undefined && this.viewItems[this.focusedItem];\n        if (actionViewItem) {\n            let focusItem = true;\n            if (!types.isFunction(actionViewItem.focus)) {\n                focusItem = false;\n            }\n            if (this.options.focusOnlyEnabledItems && types.isFunction(actionViewItem.isEnabled) && !actionViewItem.isEnabled()) {\n                focusItem = false;\n            }\n            if (!focusItem) {\n                this.actionsList.focus({ preventScroll });\n                this.previouslyFocusedItem = undefined;\n            }\n            else if (forceFocus || this.previouslyFocusedItem !== this.focusedItem) {\n                actionViewItem.focus(fromRight);\n                this.previouslyFocusedItem = this.focusedItem;\n            }\n        }\n    }\n    doTrigger(event) {\n        if (typeof this.focusedItem === 'undefined') {\n            return; //nothing to focus\n        }\n        // trigger action\n        const actionViewItem = this.viewItems[this.focusedItem];\n        if (actionViewItem instanceof BaseActionViewItem) {\n            const context = (actionViewItem._context === null || actionViewItem._context === undefined) ? event : actionViewItem._context;\n            this.run(actionViewItem._action, context);\n        }\n    }\n    run(action, context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._actionRunner.run(action, context);\n        });\n    }\n    dispose() {\n        dispose(this.viewItems);\n        this.viewItems = [];\n        this._actionIds = [];\n        this.getContainer().remove();\n        super.dispose();\n    }\n}\n"]},"metadata":{},"sourceType":"module"}