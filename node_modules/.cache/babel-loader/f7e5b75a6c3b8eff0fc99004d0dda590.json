{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar _a, _b, _c, _d, _e, _f, _g, _h;\n\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n  submenu: MenuId.EditorContextPeek,\n  title: nls.localize('peek.submenu', \"Peek\"),\n  group: 'navigation',\n  order: 100\n});\n\nconst _goToActionIds = new Set();\n\nfunction registerGoToAction(ctor) {\n  const result = new ctor();\n  registerInstantiatedEditorAction(result);\n\n  _goToActionIds.add(result.id);\n\n  return result;\n}\n\nexport class SymbolNavigationAnchor {\n  constructor(model, position) {\n    this.model = model;\n    this.position = position;\n  }\n\n  static is(thing) {\n    if (!thing || typeof thing !== 'object') {\n      return false;\n    }\n\n    if (thing instanceof SymbolNavigationAnchor) {\n      return true;\n    }\n\n    if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n      return true;\n    }\n\n    return false;\n  }\n\n}\nexport class SymbolNavigationAction extends EditorAction {\n  constructor(configuration, opts) {\n    super(opts);\n    this.configuration = configuration;\n  }\n\n  run(accessor, editor, arg) {\n    if (!editor.hasModel()) {\n      return Promise.resolve(undefined);\n    }\n\n    const notificationService = accessor.get(INotificationService);\n    const editorService = accessor.get(ICodeEditorService);\n    const progressService = accessor.get(IEditorProgressService);\n    const symbolNavService = accessor.get(ISymbolNavigationService);\n    const model = editor.getModel();\n    const position = editor.getPosition();\n    const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n    const cts = new EditorStateCancellationTokenSource(editor, 1\n    /* Value */\n    | 4\n    /* Position */\n    );\n    const promise = raceCancellation(this._getLocationModel(anchor.model, anchor.position, cts.token), cts.token).then(references => __awaiter(this, void 0, void 0, function* () {\n      var _a;\n\n      if (!references || cts.token.isCancellationRequested) {\n        return;\n      }\n\n      alert(references.ariaMessage);\n      let altAction;\n\n      if (references.referenceAt(model.uri, position)) {\n        const altActionId = this._getAlternativeCommand(editor);\n\n        if (altActionId !== this.id && _goToActionIds.has(altActionId)) {\n          altAction = editor.getAction(altActionId);\n        }\n      }\n\n      const referenceCount = references.references.length;\n\n      if (referenceCount === 0) {\n        // no result -> show message\n        if (!this.configuration.muteMessage) {\n          const info = model.getWordAtPosition(position);\n          (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n        }\n      } else if (referenceCount === 1 && altAction) {\n        // already at the only result, run alternative\n        altAction.run();\n      } else {\n        // normal results handling\n        return this._onResult(editorService, symbolNavService, editor, references);\n      }\n    }), err => {\n      // report an error\n      notificationService.error(err);\n    }).finally(() => {\n      cts.dispose();\n    });\n    progressService.showWhile(promise, 250);\n    return promise;\n  }\n\n  _onResult(editorService, symbolNavService, editor, model) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const gotoLocation = this._getGoToPreference(editor);\n\n      if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || gotoLocation === 'peek' && model.references.length > 1)) {\n        this._openInPeek(editor, model);\n      } else {\n        const next = model.firstReference();\n        const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n        const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n\n        if (peek && targetEditor) {\n          this._openInPeek(targetEditor, model);\n        } else {\n          model.dispose();\n        } // keep remaining locations around when using\n        // 'goto'-mode\n\n\n        if (gotoLocation === 'goto') {\n          symbolNavService.put(next);\n        }\n      }\n    });\n  }\n\n  _openReference(editor, editorService, reference, sideBySide, highlight) {\n    return __awaiter(this, void 0, void 0, function* () {\n      // range is the target-selection-range when we have one\n      // and the fallback is the 'full' range\n      let range = undefined;\n\n      if (isLocationLink(reference)) {\n        range = reference.targetSelectionRange;\n      }\n\n      if (!range) {\n        range = reference.range;\n      }\n\n      if (!range) {\n        return undefined;\n      }\n\n      const targetEditor = yield editorService.openCodeEditor({\n        resource: reference.uri,\n        options: {\n          selection: Range.collapseToStart(range),\n          selectionRevealType: 3\n          /* NearTopIfOutsideViewport */\n\n        }\n      }, editor, sideBySide);\n\n      if (!targetEditor) {\n        return undefined;\n      }\n\n      if (highlight) {\n        const modelNow = targetEditor.getModel();\n        const ids = targetEditor.deltaDecorations([], [{\n          range,\n          options: {\n            description: 'symbol-navigate-action-highlight',\n            className: 'symbolHighlight'\n          }\n        }]);\n        setTimeout(() => {\n          if (targetEditor.getModel() === modelNow) {\n            targetEditor.deltaDecorations(ids, []);\n          }\n        }, 350);\n      }\n\n      return targetEditor;\n    });\n  }\n\n  _openInPeek(target, model) {\n    const controller = ReferencesController.get(target);\n\n    if (controller && target.hasModel()) {\n      controller.toggleWidget(target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n    } else {\n      model.dispose();\n    }\n  }\n\n} //#region --- DEFINITION\n\nexport class DefinitionAction extends SymbolNavigationAction {\n  _getLocationModel(model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(yield getDefinitionsAtPosition(model, position, token), nls.localize('def.title', 'Definitions'));\n    });\n  }\n\n  _getNoResultFoundMessage(info) {\n    return info && info.word ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word) : nls.localize('generic.noResults', \"No definition found\");\n  }\n\n  _getAlternativeCommand(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).alternativeDefinitionCommand;\n  }\n\n  _getGoToPreference(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).multipleDefinitions;\n  }\n\n}\nconst goToDefinitionKb = isWeb && !isStandalone ? 2048\n/* CtrlCmd */\n| 70\n/* F12 */\n: 70\n/* F12 */\n;\nregisterGoToAction((_a = class GoToDefinitionAction extends DefinitionAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: false,\n      muteMessage: false\n    }, {\n      id: GoToDefinitionAction.id,\n      label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n      alias: 'Go to Definition',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: goToDefinitionKb,\n        weight: 100\n        /* EditorContrib */\n\n      },\n      contextMenuOpts: {\n        group: 'navigation',\n        order: 1.1\n      }\n    });\n    CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n  }\n\n}, _a.id = 'editor.action.revealDefinition', _a));\nregisterGoToAction((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n  constructor() {\n    super({\n      openToSide: true,\n      openInPeek: false,\n      muteMessage: false\n    }, {\n      id: OpenDefinitionToSideAction.id,\n      label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n      alias: 'Open Definition to the Side',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: KeyChord(2048\n        /* CtrlCmd */\n        | 41\n        /* KeyK */\n        , goToDefinitionKb),\n        weight: 100\n        /* EditorContrib */\n\n      }\n    });\n    CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n  }\n\n}, _b.id = 'editor.action.revealDefinitionAside', _b));\nregisterGoToAction((_c = class PeekDefinitionAction extends DefinitionAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: true,\n      muteMessage: false\n    }, {\n      id: PeekDefinitionAction.id,\n      label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n      alias: 'Peek Definition',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 512\n        /* Alt */\n        | 70\n        /* F12 */\n        ,\n        linux: {\n          primary: 2048\n          /* CtrlCmd */\n          | 1024\n          /* Shift */\n          | 68\n          /* F10 */\n\n        },\n        weight: 100\n        /* EditorContrib */\n\n      },\n      contextMenuOpts: {\n        menuId: MenuId.EditorContextPeek,\n        group: 'peek',\n        order: 2\n      }\n    });\n    CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n  }\n\n}, _c.id = 'editor.action.peekDefinition', _c)); //#endregion\n//#region --- DECLARATION\n\nclass DeclarationAction extends SymbolNavigationAction {\n  _getLocationModel(model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(yield getDeclarationsAtPosition(model, position, token), nls.localize('decl.title', 'Declarations'));\n    });\n  }\n\n  _getNoResultFoundMessage(info) {\n    return info && info.word ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word) : nls.localize('decl.generic.noResults', \"No declaration found\");\n  }\n\n  _getAlternativeCommand(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).alternativeDeclarationCommand;\n  }\n\n  _getGoToPreference(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).multipleDeclarations;\n  }\n\n}\n\nregisterGoToAction((_d = class GoToDeclarationAction extends DeclarationAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: false,\n      muteMessage: false\n    }, {\n      id: GoToDeclarationAction.id,\n      label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n      alias: 'Go to Declaration',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      contextMenuOpts: {\n        group: 'navigation',\n        order: 1.3\n      }\n    });\n  }\n\n  _getNoResultFoundMessage(info) {\n    return info && info.word ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word) : nls.localize('decl.generic.noResults', \"No declaration found\");\n  }\n\n}, _d.id = 'editor.action.revealDeclaration', _d));\nregisterGoToAction(class PeekDeclarationAction extends DeclarationAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: true,\n      muteMessage: false\n    }, {\n      id: 'editor.action.peekDeclaration',\n      label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n      alias: 'Peek Declaration',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      contextMenuOpts: {\n        menuId: MenuId.EditorContextPeek,\n        group: 'peek',\n        order: 3\n      }\n    });\n  }\n\n}); //#endregion\n//#region --- TYPE DEFINITION\n\nclass TypeDefinitionAction extends SymbolNavigationAction {\n  _getLocationModel(model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(yield getTypeDefinitionsAtPosition(model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n    });\n  }\n\n  _getNoResultFoundMessage(info) {\n    return info && info.word ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word) : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n  }\n\n  _getAlternativeCommand(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).alternativeTypeDefinitionCommand;\n  }\n\n  _getGoToPreference(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).multipleTypeDefinitions;\n  }\n\n}\n\nregisterGoToAction((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: false,\n      muteMessage: false\n    }, {\n      id: GoToTypeDefinitionAction.ID,\n      label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n      alias: 'Go to Type Definition',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 0,\n        weight: 100\n        /* EditorContrib */\n\n      },\n      contextMenuOpts: {\n        group: 'navigation',\n        order: 1.4\n      }\n    });\n  }\n\n}, _e.ID = 'editor.action.goToTypeDefinition', _e));\nregisterGoToAction((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: true,\n      muteMessage: false\n    }, {\n      id: PeekTypeDefinitionAction.ID,\n      label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n      alias: 'Peek Type Definition',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      contextMenuOpts: {\n        menuId: MenuId.EditorContextPeek,\n        group: 'peek',\n        order: 4\n      }\n    });\n  }\n\n}, _f.ID = 'editor.action.peekTypeDefinition', _f)); //#endregion\n//#region --- IMPLEMENTATION\n\nclass ImplementationAction extends SymbolNavigationAction {\n  _getLocationModel(model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(yield getImplementationsAtPosition(model, position, token), nls.localize('impl.title', 'Implementations'));\n    });\n  }\n\n  _getNoResultFoundMessage(info) {\n    return info && info.word ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word) : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n  }\n\n  _getAlternativeCommand(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).alternativeImplementationCommand;\n  }\n\n  _getGoToPreference(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).multipleImplementations;\n  }\n\n}\n\nregisterGoToAction((_g = class GoToImplementationAction extends ImplementationAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: false,\n      muteMessage: false\n    }, {\n      id: GoToImplementationAction.ID,\n      label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n      alias: 'Go to Implementations',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2048\n        /* CtrlCmd */\n        | 70\n        /* F12 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      },\n      contextMenuOpts: {\n        group: 'navigation',\n        order: 1.45\n      }\n    });\n  }\n\n}, _g.ID = 'editor.action.goToImplementation', _g));\nregisterGoToAction((_h = class PeekImplementationAction extends ImplementationAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: true,\n      muteMessage: false\n    }, {\n      id: PeekImplementationAction.ID,\n      label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n      alias: 'Peek Implementations',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2048\n        /* CtrlCmd */\n        | 1024\n        /* Shift */\n        | 70\n        /* F12 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      },\n      contextMenuOpts: {\n        menuId: MenuId.EditorContextPeek,\n        group: 'peek',\n        order: 5\n      }\n    });\n  }\n\n}, _h.ID = 'editor.action.peekImplementation', _h)); //#endregion\n//#region --- REFERENCES\n\nclass ReferencesAction extends SymbolNavigationAction {\n  _getNoResultFoundMessage(info) {\n    return info ? nls.localize('references.no', \"No references found for '{0}'\", info.word) : nls.localize('references.noGeneric', \"No references found\");\n  }\n\n  _getAlternativeCommand(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).alternativeReferenceCommand;\n  }\n\n  _getGoToPreference(editor) {\n    return editor.getOption(51\n    /* gotoLocation */\n    ).multipleReferences;\n  }\n\n}\n\nregisterGoToAction(class GoToReferencesAction extends ReferencesAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: false,\n      muteMessage: false\n    }, {\n      id: 'editor.action.goToReferences',\n      label: nls.localize('goToReferences.label', \"Go to References\"),\n      alias: 'Go to References',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024\n        /* Shift */\n        | 70\n        /* F12 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      },\n      contextMenuOpts: {\n        group: 'navigation',\n        order: 1.45\n      }\n    });\n  }\n\n  _getLocationModel(model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(yield getReferencesAtPosition(model, position, true, token), nls.localize('ref.title', 'References'));\n    });\n  }\n\n});\nregisterGoToAction(class PeekReferencesAction extends ReferencesAction {\n  constructor() {\n    super({\n      openToSide: false,\n      openInPeek: true,\n      muteMessage: false\n    }, {\n      id: 'editor.action.referenceSearch.trigger',\n      label: nls.localize('references.action.label', \"Peek References\"),\n      alias: 'Peek References',\n      precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n      contextMenuOpts: {\n        menuId: MenuId.EditorContextPeek,\n        group: 'peek',\n        order: 6\n      }\n    });\n  }\n\n  _getLocationModel(model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(yield getReferencesAtPosition(model, position, false, token), nls.localize('ref.title', 'References'));\n    });\n  }\n\n}); //#endregion\n//#region --- GENERIC goto symbols command\n\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n  constructor(config, _references, _gotoMultipleBehaviour) {\n    super(config, {\n      id: 'editor.action.goToLocation',\n      label: nls.localize('label.generic', \"Go to Any Symbol\"),\n      alias: 'Go to Any Symbol',\n      precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated())\n    });\n    this._references = _references;\n    this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n  }\n\n  _getLocationModel(_model, _position, _token) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n    });\n  }\n\n  _getNoResultFoundMessage(info) {\n    return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n  }\n\n  _getGoToPreference(editor) {\n    var _a;\n\n    return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(51\n    /* gotoLocation */\n    ).multipleReferences;\n  }\n\n  _getAlternativeCommand() {\n    return '';\n  }\n\n}\n\nCommandsRegistry.registerCommand({\n  id: 'editor.action.goToLocations',\n  description: {\n    description: 'Go to locations from a position in a file',\n    args: [{\n      name: 'uri',\n      description: 'The text document in which to start',\n      constraint: URI\n    }, {\n      name: 'position',\n      description: 'The position at which to start',\n      constraint: corePosition.Position.isIPosition\n    }, {\n      name: 'locations',\n      description: 'An array of locations.',\n      constraint: Array\n    }, {\n      name: 'multiple',\n      description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto'\n    }, {\n      name: 'noResultsMessage',\n      description: 'Human readable message that shows when locations is empty.'\n    }]\n  },\n  handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n    assertType(URI.isUri(resource));\n    assertType(corePosition.Position.isIPosition(position));\n    assertType(Array.isArray(references));\n    assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n    assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n    const editorService = accessor.get(ICodeEditorService);\n    const editor = yield editorService.openCodeEditor({\n      resource\n    }, editorService.getFocusedCodeEditor());\n\n    if (isCodeEditor(editor)) {\n      editor.setPosition(position);\n      editor.revealPositionInCenterIfOutsideViewport(position, 0\n      /* Smooth */\n      );\n      return editor.invokeWithinContext(accessor => {\n        const command = new class extends GenericGoToLocationAction {\n          _getNoResultFoundMessage(info) {\n            return noResultsMessage || super._getNoResultFoundMessage(info);\n          }\n\n        }({\n          muteMessage: !Boolean(noResultsMessage),\n          openInPeek: Boolean(openInPeek),\n          openToSide: false\n        }, references, multiple);\n        accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n      });\n    }\n  })\n});\nCommandsRegistry.registerCommand({\n  id: 'editor.action.peekLocations',\n  description: {\n    description: 'Peek locations from a position in a file',\n    args: [{\n      name: 'uri',\n      description: 'The text document in which to start',\n      constraint: URI\n    }, {\n      name: 'position',\n      description: 'The position at which to start',\n      constraint: corePosition.Position.isIPosition\n    }, {\n      name: 'locations',\n      description: 'An array of locations.',\n      constraint: Array\n    }, {\n      name: 'multiple',\n      description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto'\n    }]\n  },\n  handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n    accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n  })\n}); //#endregion\n//#region --- REFERENCE search special commands\n\nCommandsRegistry.registerCommand({\n  id: 'editor.action.findReferences',\n  handler: (accessor, resource, position) => {\n    assertType(URI.isUri(resource));\n    assertType(corePosition.Position.isIPosition(position));\n    const codeEditorService = accessor.get(ICodeEditorService);\n    return codeEditorService.openCodeEditor({\n      resource\n    }, codeEditorService.getFocusedCodeEditor()).then(control => {\n      if (!isCodeEditor(control) || !control.hasModel()) {\n        return undefined;\n      }\n\n      const controller = ReferencesController.get(control);\n\n      if (!controller) {\n        return undefined;\n      }\n\n      const references = createCancelablePromise(token => getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n      const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n      return Promise.resolve(controller.toggleWidget(range, references, false));\n    });\n  }\n}); // use NEW command\n\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations'); //#endregion\n// -- unconditionally register goto-action\n\nMenuRegistry.appendMenuItems([{\n  id: MenuId.MenubarGoMenu,\n  item: {\n    command: {\n      id: 'editor.action.revealDefinition',\n      title: nls.localize({\n        key: 'miGotoDefinition',\n        comment: ['&& denotes a mnemonic']\n      }, \"Go to &&Definition\")\n    },\n    group: '4_symbol_nav',\n    order: 2\n  }\n}, {\n  id: MenuId.MenubarGoMenu,\n  item: {\n    command: {\n      id: 'editor.action.revealDeclaration',\n      title: nls.localize({\n        key: 'miGotoDeclaration',\n        comment: ['&& denotes a mnemonic']\n      }, \"Go to &&Declaration\")\n    },\n    group: '4_symbol_nav',\n    order: 3\n  }\n}, {\n  id: MenuId.MenubarGoMenu,\n  item: {\n    command: {\n      id: 'editor.action.goToTypeDefinition',\n      title: nls.localize({\n        key: 'miGotoTypeDefinition',\n        comment: ['&& denotes a mnemonic']\n      }, \"Go to &&Type Definition\")\n    },\n    group: '4_symbol_nav',\n    order: 3\n  }\n}, {\n  id: MenuId.MenubarGoMenu,\n  item: {\n    command: {\n      id: 'editor.action.goToImplementation',\n      title: nls.localize({\n        key: 'miGotoImplementation',\n        comment: ['&& denotes a mnemonic']\n      }, \"Go to &&Implementations\")\n    },\n    group: '4_symbol_nav',\n    order: 4\n  }\n}, {\n  id: MenuId.MenubarGoMenu,\n  item: {\n    command: {\n      id: 'editor.action.goToReferences',\n      title: nls.localize({\n        key: 'miGotoReference',\n        comment: ['&& denotes a mnemonic']\n      }, \"Go to &&References\")\n    },\n    group: '4_symbol_nav',\n    order: 5\n  }\n}]);","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","_a","_b","_c","_d","_e","_f","_g","_h","isStandalone","alert","createCancelablePromise","raceCancellation","KeyChord","isWeb","assertType","URI","EditorStateCancellationTokenSource","isCodeEditor","EditorAction","registerInstantiatedEditorAction","ICodeEditorService","EmbeddedCodeEditorWidget","corePosition","Range","EditorContextKeys","isLocationLink","ReferencesController","ReferencesModel","ISymbolNavigationService","MessageController","PeekContext","nls","MenuId","MenuRegistry","CommandsRegistry","ICommandService","ContextKeyExpr","IInstantiationService","INotificationService","IEditorProgressService","getDeclarationsAtPosition","getDefinitionsAtPosition","getImplementationsAtPosition","getReferencesAtPosition","getTypeDefinitionsAtPosition","appendMenuItem","EditorContext","submenu","EditorContextPeek","title","localize","group","order","_goToActionIds","Set","registerGoToAction","ctor","add","id","SymbolNavigationAnchor","constructor","model","position","is","thing","Position","isIPosition","SymbolNavigationAction","configuration","opts","run","accessor","editor","arg","hasModel","undefined","notificationService","get","editorService","progressService","symbolNavService","getModel","getPosition","anchor","cts","promise","_getLocationModel","token","references","isCancellationRequested","ariaMessage","altAction","referenceAt","uri","altActionId","_getAlternativeCommand","has","getAction","referenceCount","length","muteMessage","info","getWordAtPosition","showMessage","_getNoResultFoundMessage","_onResult","err","error","finally","dispose","showWhile","gotoLocation","_getGoToPreference","openInPeek","_openInPeek","firstReference","peek","targetEditor","_openReference","openToSide","put","reference","sideBySide","highlight","range","targetSelectionRange","openCodeEditor","resource","options","selection","collapseToStart","selectionRevealType","modelNow","ids","deltaDecorations","description","className","setTimeout","target","controller","toggleWidget","getSelection","_","DefinitionAction","word","getOption","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","GoToDefinitionAction","label","alias","precondition","and","hasDefinitionProvider","isInWalkThroughSnippet","toNegated","kbOpts","kbExpr","editorTextFocus","primary","weight","contextMenuOpts","registerCommandAlias","OpenDefinitionToSideAction","PeekDefinitionAction","notInPeekEditor","linux","menuId","DeclarationAction","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","hasDeclarationProvider","PeekDeclarationAction","TypeDefinitionAction","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","ID","hasTypeDefinitionProvider","PeekTypeDefinitionAction","ImplementationAction","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","hasImplementationProvider","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","GoToReferencesAction","hasReferenceProvider","PeekReferencesAction","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_model","_position","_token","registerCommand","args","name","constraint","Array","handler","multiple","noResultsMessage","isUri","isArray","getFocusedCodeEditor","setPosition","revealPositionInCenterIfOutsideViewport","invokeWithinContext","command","Boolean","invokeFunction","bind","executeCommand","codeEditorService","control","lift","lineNumber","column","appendMenuItems","MenubarGoMenu","item","key","comment"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nconst _goToActionIds = new Set();\nfunction registerGoToAction(ctor) {\n    const result = new ctor();\n    registerInstantiatedEditorAction(result);\n    _goToActionIds.add(result.id);\n    return result;\n}\nexport class SymbolNavigationAnchor {\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction {\n    constructor(configuration, opts) {\n        super(opts);\n        this.configuration = configuration;\n    }\n    run(accessor, editor, arg) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* Value */ | 4 /* Position */);\n        const promise = raceCancellation(this._getLocationModel(anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (altActionId !== this.id && _goToActionIds.has(altActionId)) {\n                    altAction = editor.getAction(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                altAction.run();\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* NearTopIfOutsideViewport */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const ids = targetEditor.deltaDecorations([], [{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        targetEditor.deltaDecorations(ids, []);\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleDefinitions;\n    }\n}\nconst goToDefinitionKb = isWeb && !isStandalone\n    ? 2048 /* CtrlCmd */ | 70 /* F12 */\n    : 70 /* F12 */;\nregisterGoToAction((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDefinitionAction.id,\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                alias: 'Go to Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: goToDefinitionKb,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.1\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterGoToAction((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: OpenDefinitionToSideAction.id,\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                alias: 'Open Definition to the Side',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KeyK */, goToDefinitionKb),\n                    weight: 100 /* EditorContrib */\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterGoToAction((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekDefinitionAction.id,\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                alias: 'Peek Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* Alt */ | 70 /* F12 */,\n                    linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 68 /* F10 */ },\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleDeclarations;\n    }\n}\nregisterGoToAction((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDeclarationAction.id,\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                alias: 'Go to Declaration',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.3\n                },\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterGoToAction(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n            alias: 'Peek Declaration',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterGoToAction((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToTypeDefinitionAction.ID,\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                alias: 'Go to Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.4\n                }\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterGoToAction((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekTypeDefinitionAction.ID,\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                alias: 'Peek Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleImplementations;\n    }\n}\nregisterGoToAction((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToImplementationAction.ID,\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                alias: 'Go to Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* CtrlCmd */ | 70 /* F12 */,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.45\n                }\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterGoToAction((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekImplementationAction.ID,\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                alias: 'Peek Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 70 /* F12 */,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleReferences;\n    }\n}\nregisterGoToAction(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            label: nls.localize('goToReferences.label', \"Go to References\"),\n            alias: 'Go to References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* Shift */ | 70 /* F12 */,\n                weight: 100 /* EditorContrib */\n            },\n            contextMenuOpts: {\n                group: 'navigation',\n                order: 1.45\n            }\n        });\n    }\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterGoToAction(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            label: nls.localize('references.action.label', \"Peek References\"),\n            alias: 'Peek References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            label: nls.localize('label.generic', \"Go to Any Symbol\"),\n            alias: 'Go to Any Symbol',\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(_model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _a;\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(51 /* gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n// -- unconditionally register goto-action\nMenuRegistry.appendMenuItems([\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDefinition',\n                title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 2,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDeclaration',\n                title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToTypeDefinition',\n                title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToImplementation',\n                title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n            },\n            group: '4_symbol_nav',\n            order: 4,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToReferences',\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            group: '4_symbol_nav',\n            order: 5,\n        },\n    },\n]);\n"]},"metadata":{},"sourceType":"module"}