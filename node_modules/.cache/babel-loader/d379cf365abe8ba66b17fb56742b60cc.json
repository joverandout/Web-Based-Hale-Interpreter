{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport * as browser from '../../../base/browser/browser.js';\nimport * as arrays from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as objects from '../../../base/common/objects.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { ElementSizeObserver } from './elementSizeObserver.js';\nimport { FontMeasurements } from './fontMeasurements.js';\nimport { migrateOptions } from './migrateOptions.js';\nimport { TabFocus } from './tabFocus.js';\nimport { ComputeOptionsMemory, ConfigurationChangedEvent, editorOptionsRegistry } from '../../common/config/editorOptions.js';\nimport { EditorZoom } from '../../common/config/editorZoom.js';\nimport { BareFontInfo } from '../../common/config/fontInfo.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nlet EditorConfiguration = class EditorConfiguration extends Disposable {\n  constructor(isSimpleWidget, options, container, _accessibilityService) {\n    super();\n    this._accessibilityService = _accessibilityService;\n    this._onDidChange = this._register(new Emitter());\n    this.onDidChange = this._onDidChange.event;\n    this._onDidChangeFast = this._register(new Emitter());\n    this.onDidChangeFast = this._onDidChangeFast.event;\n    this._isDominatedByLongLines = false;\n    this._viewLineCount = 1;\n    this._lineNumbersDigitCount = 1;\n    this._reservedHeight = 0;\n    this._computeOptionsMemory = new ComputeOptionsMemory();\n    this.isSimpleWidget = isSimpleWidget;\n    this._containerObserver = this._register(new ElementSizeObserver(container, options.dimension));\n    this._rawOptions = deepCloneAndMigrateOptions(options);\n    this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n    this.options = this._computeOptions();\n\n    if (this.options.get(10\n    /* automaticLayout */\n    )) {\n      this._containerObserver.startObserving();\n    }\n\n    this._register(EditorZoom.onDidChangeZoomLevel(() => this._recomputeOptions()));\n\n    this._register(TabFocus.onDidChangeTabFocus(() => this._recomputeOptions()));\n\n    this._register(this._containerObserver.onDidChange(() => this._recomputeOptions()));\n\n    this._register(FontMeasurements.onDidChange(() => this._recomputeOptions()));\n\n    this._register(browser.PixelRatio.onDidChange(() => this._recomputeOptions()));\n\n    this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(() => this._recomputeOptions()));\n  }\n\n  _recomputeOptions() {\n    const newOptions = this._computeOptions();\n\n    const changeEvent = EditorOptionsUtil.checkEquals(this.options, newOptions);\n\n    if (changeEvent === null) {\n      // nothing changed!\n      return;\n    }\n\n    this.options = newOptions;\n\n    this._onDidChangeFast.fire(changeEvent);\n\n    this._onDidChange.fire(changeEvent);\n  }\n\n  _computeOptions() {\n    const partialEnv = this._readEnvConfiguration();\n\n    const bareFontInfo = BareFontInfo.createFromValidatedSettings(this._validatedOptions, partialEnv.pixelRatio, this.isSimpleWidget);\n\n    const fontInfo = this._readFontInfo(bareFontInfo);\n\n    const env = {\n      memory: this._computeOptionsMemory,\n      outerWidth: partialEnv.outerWidth,\n      outerHeight: partialEnv.outerHeight - this._reservedHeight,\n      fontInfo: fontInfo,\n      extraEditorClassName: partialEnv.extraEditorClassName,\n      isDominatedByLongLines: this._isDominatedByLongLines,\n      viewLineCount: this._viewLineCount,\n      lineNumbersDigitCount: this._lineNumbersDigitCount,\n      emptySelectionClipboard: partialEnv.emptySelectionClipboard,\n      pixelRatio: partialEnv.pixelRatio,\n      tabFocusMode: TabFocus.getTabFocusMode(),\n      accessibilitySupport: partialEnv.accessibilitySupport\n    };\n    return EditorOptionsUtil.computeOptions(this._validatedOptions, env);\n  }\n\n  _readEnvConfiguration() {\n    return {\n      extraEditorClassName: getExtraEditorClassName(),\n      outerWidth: this._containerObserver.getWidth(),\n      outerHeight: this._containerObserver.getHeight(),\n      emptySelectionClipboard: browser.isWebKit || browser.isFirefox,\n      pixelRatio: browser.PixelRatio.value,\n      accessibilitySupport: this._accessibilityService.isScreenReaderOptimized() ? 2\n      /* Enabled */\n      : this._accessibilityService.getAccessibilitySupport()\n    };\n  }\n\n  _readFontInfo(bareFontInfo) {\n    return FontMeasurements.readFontInfo(bareFontInfo);\n  }\n\n  getRawOptions() {\n    return this._rawOptions;\n  }\n\n  updateOptions(_newOptions) {\n    const newOptions = deepCloneAndMigrateOptions(_newOptions);\n    const didChange = EditorOptionsUtil.applyUpdate(this._rawOptions, newOptions);\n\n    if (!didChange) {\n      return;\n    }\n\n    this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n\n    this._recomputeOptions();\n  }\n\n  observeContainer(dimension) {\n    this._containerObserver.observe(dimension);\n  }\n\n  setIsDominatedByLongLines(isDominatedByLongLines) {\n    if (this._isDominatedByLongLines === isDominatedByLongLines) {\n      return;\n    }\n\n    this._isDominatedByLongLines = isDominatedByLongLines;\n\n    this._recomputeOptions();\n  }\n\n  setModelLineCount(modelLineCount) {\n    const lineNumbersDigitCount = digitCount(modelLineCount);\n\n    if (this._lineNumbersDigitCount === lineNumbersDigitCount) {\n      return;\n    }\n\n    this._lineNumbersDigitCount = lineNumbersDigitCount;\n\n    this._recomputeOptions();\n  }\n\n  setViewLineCount(viewLineCount) {\n    if (this._viewLineCount === viewLineCount) {\n      return;\n    }\n\n    this._viewLineCount = viewLineCount;\n\n    this._recomputeOptions();\n  }\n\n  setReservedHeight(reservedHeight) {\n    if (this._reservedHeight === reservedHeight) {\n      return;\n    }\n\n    this._reservedHeight = reservedHeight;\n\n    this._recomputeOptions();\n  }\n\n};\nEditorConfiguration = __decorate([__param(3, IAccessibilityService)], EditorConfiguration);\nexport { EditorConfiguration };\n\nfunction digitCount(n) {\n  let r = 0;\n\n  while (n) {\n    n = Math.floor(n / 10);\n    r++;\n  }\n\n  return r ? r : 1;\n}\n\nfunction getExtraEditorClassName() {\n  let extra = '';\n\n  if (!browser.isSafari && !browser.isWebkitWebView) {\n    // Use user-select: none in all browsers except Safari and native macOS WebView\n    extra += 'no-user-select ';\n  }\n\n  if (browser.isSafari) {\n    // See https://github.com/microsoft/vscode/issues/108822\n    extra += 'no-minimap-shadow ';\n  }\n\n  if (platform.isMacintosh) {\n    extra += 'mac ';\n  }\n\n  return extra;\n}\n\nclass ValidatedEditorOptions {\n  constructor() {\n    this._values = [];\n  }\n\n  _read(option) {\n    return this._values[option];\n  }\n\n  get(id) {\n    return this._values[id];\n  }\n\n  _write(option, value) {\n    this._values[option] = value;\n  }\n\n}\n\nexport class ComputedEditorOptions {\n  constructor() {\n    this._values = [];\n  }\n\n  _read(id) {\n    if (id >= this._values.length) {\n      throw new Error('Cannot read uninitialized value');\n    }\n\n    return this._values[id];\n  }\n\n  get(id) {\n    return this._read(id);\n  }\n\n  _write(id, value) {\n    this._values[id] = value;\n  }\n\n}\n\nclass EditorOptionsUtil {\n  static validateOptions(options) {\n    const result = new ValidatedEditorOptions();\n\n    for (const editorOption of editorOptionsRegistry) {\n      const value = editorOption.name === '_never_' ? undefined : options[editorOption.name];\n\n      result._write(editorOption.id, editorOption.validate(value));\n    }\n\n    return result;\n  }\n\n  static computeOptions(options, env) {\n    const result = new ComputedEditorOptions();\n\n    for (const editorOption of editorOptionsRegistry) {\n      result._write(editorOption.id, editorOption.compute(env, result, options._read(editorOption.id)));\n    }\n\n    return result;\n  }\n\n  static _deepEquals(a, b) {\n    if (typeof a !== 'object' || typeof b !== 'object' || !a || !b) {\n      return a === b;\n    }\n\n    if (Array.isArray(a) || Array.isArray(b)) {\n      return Array.isArray(a) && Array.isArray(b) ? arrays.equals(a, b) : false;\n    }\n\n    if (Object.keys(a).length !== Object.keys(b).length) {\n      return false;\n    }\n\n    for (const key in a) {\n      if (!EditorOptionsUtil._deepEquals(a[key], b[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  static checkEquals(a, b) {\n    const result = [];\n    let somethingChanged = false;\n\n    for (const editorOption of editorOptionsRegistry) {\n      const changed = !EditorOptionsUtil._deepEquals(a._read(editorOption.id), b._read(editorOption.id));\n      result[editorOption.id] = changed;\n\n      if (changed) {\n        somethingChanged = true;\n      }\n    }\n\n    return somethingChanged ? new ConfigurationChangedEvent(result) : null;\n  }\n  /**\n   * Returns true if something changed.\n   * Modifies `options`.\n  */\n\n\n  static applyUpdate(options, update) {\n    let changed = false;\n\n    for (const editorOption of editorOptionsRegistry) {\n      if (update.hasOwnProperty(editorOption.name)) {\n        const result = editorOption.applyUpdate(options[editorOption.name], update[editorOption.name]);\n        options[editorOption.name] = result.newValue;\n        changed = changed || result.didChange;\n      }\n    }\n\n    return changed;\n  }\n\n}\n\nfunction deepCloneAndMigrateOptions(_options) {\n  const options = objects.deepClone(_options);\n  migrateOptions(options);\n  return options;\n}","map":{"version":3,"sources":["/home/joe/DISSY/flask_test_1/react-flask-app/node_modules/monaco-editor/esm/vs/editor/browser/config/editorConfiguration.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","browser","arrays","Emitter","Disposable","objects","platform","ElementSizeObserver","FontMeasurements","migrateOptions","TabFocus","ComputeOptionsMemory","ConfigurationChangedEvent","editorOptionsRegistry","EditorZoom","BareFontInfo","IAccessibilityService","EditorConfiguration","constructor","isSimpleWidget","options","container","_accessibilityService","_onDidChange","_register","onDidChange","event","_onDidChangeFast","onDidChangeFast","_isDominatedByLongLines","_viewLineCount","_lineNumbersDigitCount","_reservedHeight","_computeOptionsMemory","_containerObserver","dimension","_rawOptions","deepCloneAndMigrateOptions","_validatedOptions","EditorOptionsUtil","validateOptions","_computeOptions","get","startObserving","onDidChangeZoomLevel","_recomputeOptions","onDidChangeTabFocus","PixelRatio","onDidChangeScreenReaderOptimized","newOptions","changeEvent","checkEquals","fire","partialEnv","_readEnvConfiguration","bareFontInfo","createFromValidatedSettings","pixelRatio","fontInfo","_readFontInfo","env","memory","outerWidth","outerHeight","extraEditorClassName","isDominatedByLongLines","viewLineCount","lineNumbersDigitCount","emptySelectionClipboard","tabFocusMode","getTabFocusMode","accessibilitySupport","computeOptions","getExtraEditorClassName","getWidth","getHeight","isWebKit","isFirefox","value","isScreenReaderOptimized","getAccessibilitySupport","readFontInfo","getRawOptions","updateOptions","_newOptions","didChange","applyUpdate","observeContainer","observe","setIsDominatedByLongLines","setModelLineCount","modelLineCount","digitCount","setViewLineCount","setReservedHeight","reservedHeight","n","Math","floor","extra","isSafari","isWebkitWebView","isMacintosh","ValidatedEditorOptions","_values","_read","option","id","_write","ComputedEditorOptions","Error","result","editorOption","name","undefined","validate","compute","_deepEquals","a","b","Array","isArray","equals","keys","somethingChanged","changed","update","hasOwnProperty","newValue","_options","deepClone"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as browser from '../../../base/browser/browser.js';\nimport * as arrays from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as objects from '../../../base/common/objects.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { ElementSizeObserver } from './elementSizeObserver.js';\nimport { FontMeasurements } from './fontMeasurements.js';\nimport { migrateOptions } from './migrateOptions.js';\nimport { TabFocus } from './tabFocus.js';\nimport { ComputeOptionsMemory, ConfigurationChangedEvent, editorOptionsRegistry } from '../../common/config/editorOptions.js';\nimport { EditorZoom } from '../../common/config/editorZoom.js';\nimport { BareFontInfo } from '../../common/config/fontInfo.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nlet EditorConfiguration = class EditorConfiguration extends Disposable {\n    constructor(isSimpleWidget, options, container, _accessibilityService) {\n        super();\n        this._accessibilityService = _accessibilityService;\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._onDidChangeFast = this._register(new Emitter());\n        this.onDidChangeFast = this._onDidChangeFast.event;\n        this._isDominatedByLongLines = false;\n        this._viewLineCount = 1;\n        this._lineNumbersDigitCount = 1;\n        this._reservedHeight = 0;\n        this._computeOptionsMemory = new ComputeOptionsMemory();\n        this.isSimpleWidget = isSimpleWidget;\n        this._containerObserver = this._register(new ElementSizeObserver(container, options.dimension));\n        this._rawOptions = deepCloneAndMigrateOptions(options);\n        this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n        this.options = this._computeOptions();\n        if (this.options.get(10 /* automaticLayout */)) {\n            this._containerObserver.startObserving();\n        }\n        this._register(EditorZoom.onDidChangeZoomLevel(() => this._recomputeOptions()));\n        this._register(TabFocus.onDidChangeTabFocus(() => this._recomputeOptions()));\n        this._register(this._containerObserver.onDidChange(() => this._recomputeOptions()));\n        this._register(FontMeasurements.onDidChange(() => this._recomputeOptions()));\n        this._register(browser.PixelRatio.onDidChange(() => this._recomputeOptions()));\n        this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(() => this._recomputeOptions()));\n    }\n    _recomputeOptions() {\n        const newOptions = this._computeOptions();\n        const changeEvent = EditorOptionsUtil.checkEquals(this.options, newOptions);\n        if (changeEvent === null) {\n            // nothing changed!\n            return;\n        }\n        this.options = newOptions;\n        this._onDidChangeFast.fire(changeEvent);\n        this._onDidChange.fire(changeEvent);\n    }\n    _computeOptions() {\n        const partialEnv = this._readEnvConfiguration();\n        const bareFontInfo = BareFontInfo.createFromValidatedSettings(this._validatedOptions, partialEnv.pixelRatio, this.isSimpleWidget);\n        const fontInfo = this._readFontInfo(bareFontInfo);\n        const env = {\n            memory: this._computeOptionsMemory,\n            outerWidth: partialEnv.outerWidth,\n            outerHeight: partialEnv.outerHeight - this._reservedHeight,\n            fontInfo: fontInfo,\n            extraEditorClassName: partialEnv.extraEditorClassName,\n            isDominatedByLongLines: this._isDominatedByLongLines,\n            viewLineCount: this._viewLineCount,\n            lineNumbersDigitCount: this._lineNumbersDigitCount,\n            emptySelectionClipboard: partialEnv.emptySelectionClipboard,\n            pixelRatio: partialEnv.pixelRatio,\n            tabFocusMode: TabFocus.getTabFocusMode(),\n            accessibilitySupport: partialEnv.accessibilitySupport\n        };\n        return EditorOptionsUtil.computeOptions(this._validatedOptions, env);\n    }\n    _readEnvConfiguration() {\n        return {\n            extraEditorClassName: getExtraEditorClassName(),\n            outerWidth: this._containerObserver.getWidth(),\n            outerHeight: this._containerObserver.getHeight(),\n            emptySelectionClipboard: browser.isWebKit || browser.isFirefox,\n            pixelRatio: browser.PixelRatio.value,\n            accessibilitySupport: (this._accessibilityService.isScreenReaderOptimized()\n                ? 2 /* Enabled */\n                : this._accessibilityService.getAccessibilitySupport())\n        };\n    }\n    _readFontInfo(bareFontInfo) {\n        return FontMeasurements.readFontInfo(bareFontInfo);\n    }\n    getRawOptions() {\n        return this._rawOptions;\n    }\n    updateOptions(_newOptions) {\n        const newOptions = deepCloneAndMigrateOptions(_newOptions);\n        const didChange = EditorOptionsUtil.applyUpdate(this._rawOptions, newOptions);\n        if (!didChange) {\n            return;\n        }\n        this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n        this._recomputeOptions();\n    }\n    observeContainer(dimension) {\n        this._containerObserver.observe(dimension);\n    }\n    setIsDominatedByLongLines(isDominatedByLongLines) {\n        if (this._isDominatedByLongLines === isDominatedByLongLines) {\n            return;\n        }\n        this._isDominatedByLongLines = isDominatedByLongLines;\n        this._recomputeOptions();\n    }\n    setModelLineCount(modelLineCount) {\n        const lineNumbersDigitCount = digitCount(modelLineCount);\n        if (this._lineNumbersDigitCount === lineNumbersDigitCount) {\n            return;\n        }\n        this._lineNumbersDigitCount = lineNumbersDigitCount;\n        this._recomputeOptions();\n    }\n    setViewLineCount(viewLineCount) {\n        if (this._viewLineCount === viewLineCount) {\n            return;\n        }\n        this._viewLineCount = viewLineCount;\n        this._recomputeOptions();\n    }\n    setReservedHeight(reservedHeight) {\n        if (this._reservedHeight === reservedHeight) {\n            return;\n        }\n        this._reservedHeight = reservedHeight;\n        this._recomputeOptions();\n    }\n};\nEditorConfiguration = __decorate([\n    __param(3, IAccessibilityService)\n], EditorConfiguration);\nexport { EditorConfiguration };\nfunction digitCount(n) {\n    let r = 0;\n    while (n) {\n        n = Math.floor(n / 10);\n        r++;\n    }\n    return r ? r : 1;\n}\nfunction getExtraEditorClassName() {\n    let extra = '';\n    if (!browser.isSafari && !browser.isWebkitWebView) {\n        // Use user-select: none in all browsers except Safari and native macOS WebView\n        extra += 'no-user-select ';\n    }\n    if (browser.isSafari) {\n        // See https://github.com/microsoft/vscode/issues/108822\n        extra += 'no-minimap-shadow ';\n    }\n    if (platform.isMacintosh) {\n        extra += 'mac ';\n    }\n    return extra;\n}\nclass ValidatedEditorOptions {\n    constructor() {\n        this._values = [];\n    }\n    _read(option) {\n        return this._values[option];\n    }\n    get(id) {\n        return this._values[id];\n    }\n    _write(option, value) {\n        this._values[option] = value;\n    }\n}\nexport class ComputedEditorOptions {\n    constructor() {\n        this._values = [];\n    }\n    _read(id) {\n        if (id >= this._values.length) {\n            throw new Error('Cannot read uninitialized value');\n        }\n        return this._values[id];\n    }\n    get(id) {\n        return this._read(id);\n    }\n    _write(id, value) {\n        this._values[id] = value;\n    }\n}\nclass EditorOptionsUtil {\n    static validateOptions(options) {\n        const result = new ValidatedEditorOptions();\n        for (const editorOption of editorOptionsRegistry) {\n            const value = (editorOption.name === '_never_' ? undefined : options[editorOption.name]);\n            result._write(editorOption.id, editorOption.validate(value));\n        }\n        return result;\n    }\n    static computeOptions(options, env) {\n        const result = new ComputedEditorOptions();\n        for (const editorOption of editorOptionsRegistry) {\n            result._write(editorOption.id, editorOption.compute(env, result, options._read(editorOption.id)));\n        }\n        return result;\n    }\n    static _deepEquals(a, b) {\n        if (typeof a !== 'object' || typeof b !== 'object' || !a || !b) {\n            return a === b;\n        }\n        if (Array.isArray(a) || Array.isArray(b)) {\n            return (Array.isArray(a) && Array.isArray(b) ? arrays.equals(a, b) : false);\n        }\n        if (Object.keys(a).length !== Object.keys(b).length) {\n            return false;\n        }\n        for (const key in a) {\n            if (!EditorOptionsUtil._deepEquals(a[key], b[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    static checkEquals(a, b) {\n        const result = [];\n        let somethingChanged = false;\n        for (const editorOption of editorOptionsRegistry) {\n            const changed = !EditorOptionsUtil._deepEquals(a._read(editorOption.id), b._read(editorOption.id));\n            result[editorOption.id] = changed;\n            if (changed) {\n                somethingChanged = true;\n            }\n        }\n        return (somethingChanged ? new ConfigurationChangedEvent(result) : null);\n    }\n    /**\n     * Returns true if something changed.\n     * Modifies `options`.\n    */\n    static applyUpdate(options, update) {\n        let changed = false;\n        for (const editorOption of editorOptionsRegistry) {\n            if (update.hasOwnProperty(editorOption.name)) {\n                const result = editorOption.applyUpdate(options[editorOption.name], update[editorOption.name]);\n                options[editorOption.name] = result.newValue;\n                changed = changed || result.didChange;\n            }\n        }\n        return changed;\n    }\n}\nfunction deepCloneAndMigrateOptions(_options) {\n    const options = objects.deepClone(_options);\n    migrateOptions(options);\n    return options;\n}\n"]},"metadata":{},"sourceType":"module"}